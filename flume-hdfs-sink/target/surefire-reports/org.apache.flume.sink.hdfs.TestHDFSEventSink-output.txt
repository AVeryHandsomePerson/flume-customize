2017-09-08 13:44:58,411 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.setUp(TestHDFSEventSink.java:104)] Starting...
2017-09-08 13:44:58,790 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.doTestTextBatchAppend(TestHDFSEventSink.java:137)] Starting...
2017-09-08 13:44:58,858 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.register(MonitoredCounterGroup.java:119)] Monitored counter group for type: SINK, name: HDFSEventSink-0b55a93f-2bab-4a97-a45e-8c0768685d5c: Successfully registered new MBean.
2017-09-08 13:44:58,858 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.start(MonitoredCounterGroup.java:95)] Component type: SINK, name: HDFSEventSink-0b55a93f-2bab-4a97-a45e-8c0768685d5c started
2017-09-08 13:44:58,868 (main) [INFO - org.apache.flume.sink.hdfs.HDFSDataStream.configure(HDFSDataStream.java:57)] Serializer = TEXT, UseRawLocalFileSystem = false
2017-09-08 13:44:58,883 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:231)] Creating file:///tmp/flume-test.1504849498414.1/singleTextBucket/FlumeData.1504849498866.tmp
2017-09-08 13:44:58,968 (hdfs-HDFSEventSink-0b55a93f-2bab-4a97-a45e-8c0768685d5c-call-runner-0) [INFO - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetNumCurrentReplicas(AbstractHDFSWriter.java:189)] FileSystem's output stream doesn't support getNumCurrentReplicas; --HDFS-826 not available; fsOut=org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer; err=java.lang.NoSuchMethodException: org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer.getNumCurrentReplicas()
2017-09-08 13:44:58,970 (hdfs-HDFSEventSink-0b55a93f-2bab-4a97-a45e-8c0768685d5c-call-runner-0) [DEBUG - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetDefaultReplication(AbstractHDFSWriter.java:228)] Using FileSystem.getDefaultReplication(Path) from HADOOP-8014
2017-09-08 13:44:58,972 (main) [WARN - org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:182)] isFileClosed is not available in the version of HDFS being used. Flume will not attempt to close files if the close fails on the first attempt
java.lang.NoSuchMethodException: org.apache.hadoop.fs.LocalFileSystem.isFileClosed(org.apache.hadoop.fs.Path)
	at java.lang.Class.getMethod(Class.java:1786)
	at org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:179)
	at org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:263)
	at org.apache.flume.sink.hdfs.BucketWriter.append(BucketWriter.java:504)
	at org.apache.flume.sink.hdfs.HDFSEventSink.process(HDFSEventSink.java:406)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.doTestTextBatchAppend(TestHDFSEventSink.java:196)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.testTextBatchAppend(TestHDFSEventSink.java:127)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:252)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:141)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:189)
	at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:165)
	at org.apache.maven.surefire.booter.ProviderFactory.invokeProvider(ProviderFactory.java:85)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:115)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:75)
2017-09-08 13:44:58,979 (main) [DEBUG - org.apache.flume.sink.hdfs.BucketWriter.shouldRotate(BucketWriter.java:581)] rolling: rollCount: 10, events: 10
2017-09-08 13:44:58,979 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.close(BucketWriter.java:357)] Closing file:///tmp/flume-test.1504849498414.1/singleTextBucket/FlumeData.1504849498866.tmp
2017-09-08 13:44:58,981 (hdfs-HDFSEventSink-0b55a93f-2bab-4a97-a45e-8c0768685d5c-call-runner-7) [INFO - org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:618)] Renaming file:/tmp/flume-test.1504849498414.1/singleTextBucket/FlumeData.1504849498866.tmp to file:/tmp/flume-test.1504849498414.1/singleTextBucket/FlumeData.1504849498866
2017-09-08 13:44:58,999 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:231)] Creating file:///tmp/flume-test.1504849498414.1/singleTextBucket/FlumeData.1504849498867.tmp
2017-09-08 13:44:59,015 (hdfs-HDFSEventSink-0b55a93f-2bab-4a97-a45e-8c0768685d5c-call-runner-8) [INFO - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetNumCurrentReplicas(AbstractHDFSWriter.java:189)] FileSystem's output stream doesn't support getNumCurrentReplicas; --HDFS-826 not available; fsOut=org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer; err=java.lang.NoSuchMethodException: org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer.getNumCurrentReplicas()
2017-09-08 13:44:59,015 (hdfs-HDFSEventSink-0b55a93f-2bab-4a97-a45e-8c0768685d5c-call-runner-8) [DEBUG - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetDefaultReplication(AbstractHDFSWriter.java:228)] Using FileSystem.getDefaultReplication(Path) from HADOOP-8014
2017-09-08 13:44:59,015 (main) [WARN - org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:182)] isFileClosed is not available in the version of HDFS being used. Flume will not attempt to close files if the close fails on the first attempt
java.lang.NoSuchMethodException: org.apache.hadoop.fs.LocalFileSystem.isFileClosed(org.apache.hadoop.fs.Path)
	at java.lang.Class.getMethod(Class.java:1786)
	at org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:179)
	at org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:263)
	at org.apache.flume.sink.hdfs.BucketWriter.append(BucketWriter.java:530)
	at org.apache.flume.sink.hdfs.HDFSEventSink.process(HDFSEventSink.java:406)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.doTestTextBatchAppend(TestHDFSEventSink.java:196)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.testTextBatchAppend(TestHDFSEventSink.java:127)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:252)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:141)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:189)
	at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:165)
	at org.apache.maven.surefire.booter.ProviderFactory.invokeProvider(ProviderFactory.java:85)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:115)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:75)
2017-09-08 13:44:59,018 (main) [DEBUG - org.apache.flume.sink.hdfs.BucketWriter.shouldRotate(BucketWriter.java:581)] rolling: rollCount: 10, events: 10
2017-09-08 13:44:59,019 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.close(BucketWriter.java:357)] Closing file:///tmp/flume-test.1504849498414.1/singleTextBucket/FlumeData.1504849498867.tmp
2017-09-08 13:44:59,020 (hdfs-HDFSEventSink-0b55a93f-2bab-4a97-a45e-8c0768685d5c-call-runner-5) [INFO - org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:618)] Renaming file:/tmp/flume-test.1504849498414.1/singleTextBucket/FlumeData.1504849498867.tmp to file:/tmp/flume-test.1504849498414.1/singleTextBucket/FlumeData.1504849498867
2017-09-08 13:44:59,033 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:231)] Creating file:///tmp/flume-test.1504849498414.1/singleTextBucket/FlumeData.1504849498868.tmp
2017-09-08 13:44:59,047 (hdfs-HDFSEventSink-0b55a93f-2bab-4a97-a45e-8c0768685d5c-call-runner-6) [INFO - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetNumCurrentReplicas(AbstractHDFSWriter.java:189)] FileSystem's output stream doesn't support getNumCurrentReplicas; --HDFS-826 not available; fsOut=org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer; err=java.lang.NoSuchMethodException: org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer.getNumCurrentReplicas()
2017-09-08 13:44:59,047 (hdfs-HDFSEventSink-0b55a93f-2bab-4a97-a45e-8c0768685d5c-call-runner-6) [DEBUG - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetDefaultReplication(AbstractHDFSWriter.java:228)] Using FileSystem.getDefaultReplication(Path) from HADOOP-8014
2017-09-08 13:44:59,047 (main) [WARN - org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:182)] isFileClosed is not available in the version of HDFS being used. Flume will not attempt to close files if the close fails on the first attempt
java.lang.NoSuchMethodException: org.apache.hadoop.fs.LocalFileSystem.isFileClosed(org.apache.hadoop.fs.Path)
	at java.lang.Class.getMethod(Class.java:1786)
	at org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:179)
	at org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:263)
	at org.apache.flume.sink.hdfs.BucketWriter.append(BucketWriter.java:530)
	at org.apache.flume.sink.hdfs.HDFSEventSink.process(HDFSEventSink.java:406)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.doTestTextBatchAppend(TestHDFSEventSink.java:196)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.testTextBatchAppend(TestHDFSEventSink.java:127)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:252)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:141)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:189)
	at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:165)
	at org.apache.maven.surefire.booter.ProviderFactory.invokeProvider(ProviderFactory.java:85)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:115)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:75)
2017-09-08 13:44:59,050 (main) [DEBUG - org.apache.flume.sink.hdfs.BucketWriter.shouldRotate(BucketWriter.java:581)] rolling: rollCount: 10, events: 10
2017-09-08 13:44:59,051 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.close(BucketWriter.java:357)] Closing file:///tmp/flume-test.1504849498414.1/singleTextBucket/FlumeData.1504849498868.tmp
2017-09-08 13:44:59,052 (hdfs-HDFSEventSink-0b55a93f-2bab-4a97-a45e-8c0768685d5c-call-runner-3) [INFO - org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:618)] Renaming file:/tmp/flume-test.1504849498414.1/singleTextBucket/FlumeData.1504849498868.tmp to file:/tmp/flume-test.1504849498414.1/singleTextBucket/FlumeData.1504849498868
2017-09-08 13:44:59,065 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:231)] Creating file:///tmp/flume-test.1504849498414.1/singleTextBucket/FlumeData.1504849498869.tmp
2017-09-08 13:44:59,081 (hdfs-HDFSEventSink-0b55a93f-2bab-4a97-a45e-8c0768685d5c-call-runner-4) [INFO - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetNumCurrentReplicas(AbstractHDFSWriter.java:189)] FileSystem's output stream doesn't support getNumCurrentReplicas; --HDFS-826 not available; fsOut=org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer; err=java.lang.NoSuchMethodException: org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer.getNumCurrentReplicas()
2017-09-08 13:44:59,081 (hdfs-HDFSEventSink-0b55a93f-2bab-4a97-a45e-8c0768685d5c-call-runner-4) [DEBUG - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetDefaultReplication(AbstractHDFSWriter.java:228)] Using FileSystem.getDefaultReplication(Path) from HADOOP-8014
2017-09-08 13:44:59,081 (main) [WARN - org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:182)] isFileClosed is not available in the version of HDFS being used. Flume will not attempt to close files if the close fails on the first attempt
java.lang.NoSuchMethodException: org.apache.hadoop.fs.LocalFileSystem.isFileClosed(org.apache.hadoop.fs.Path)
	at java.lang.Class.getMethod(Class.java:1786)
	at org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:179)
	at org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:263)
	at org.apache.flume.sink.hdfs.BucketWriter.append(BucketWriter.java:530)
	at org.apache.flume.sink.hdfs.HDFSEventSink.process(HDFSEventSink.java:406)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.doTestTextBatchAppend(TestHDFSEventSink.java:196)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.testTextBatchAppend(TestHDFSEventSink.java:127)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:252)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:141)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:189)
	at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:165)
	at org.apache.maven.surefire.booter.ProviderFactory.invokeProvider(ProviderFactory.java:85)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:115)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:75)
2017-09-08 13:44:59,084 (main) [DEBUG - org.apache.flume.sink.hdfs.BucketWriter.shouldRotate(BucketWriter.java:581)] rolling: rollCount: 10, events: 10
2017-09-08 13:44:59,085 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.close(BucketWriter.java:357)] Closing file:///tmp/flume-test.1504849498414.1/singleTextBucket/FlumeData.1504849498869.tmp
2017-09-08 13:44:59,086 (hdfs-HDFSEventSink-0b55a93f-2bab-4a97-a45e-8c0768685d5c-call-runner-1) [INFO - org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:618)] Renaming file:/tmp/flume-test.1504849498414.1/singleTextBucket/FlumeData.1504849498869.tmp to file:/tmp/flume-test.1504849498414.1/singleTextBucket/FlumeData.1504849498869
2017-09-08 13:44:59,098 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:231)] Creating file:///tmp/flume-test.1504849498414.1/singleTextBucket/FlumeData.1504849498870.tmp
2017-09-08 13:44:59,109 (hdfs-HDFSEventSink-0b55a93f-2bab-4a97-a45e-8c0768685d5c-call-runner-2) [INFO - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetNumCurrentReplicas(AbstractHDFSWriter.java:189)] FileSystem's output stream doesn't support getNumCurrentReplicas; --HDFS-826 not available; fsOut=org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer; err=java.lang.NoSuchMethodException: org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer.getNumCurrentReplicas()
2017-09-08 13:44:59,109 (hdfs-HDFSEventSink-0b55a93f-2bab-4a97-a45e-8c0768685d5c-call-runner-2) [DEBUG - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetDefaultReplication(AbstractHDFSWriter.java:228)] Using FileSystem.getDefaultReplication(Path) from HADOOP-8014
2017-09-08 13:44:59,109 (main) [WARN - org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:182)] isFileClosed is not available in the version of HDFS being used. Flume will not attempt to close files if the close fails on the first attempt
java.lang.NoSuchMethodException: org.apache.hadoop.fs.LocalFileSystem.isFileClosed(org.apache.hadoop.fs.Path)
	at java.lang.Class.getMethod(Class.java:1786)
	at org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:179)
	at org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:263)
	at org.apache.flume.sink.hdfs.BucketWriter.append(BucketWriter.java:530)
	at org.apache.flume.sink.hdfs.HDFSEventSink.process(HDFSEventSink.java:406)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.doTestTextBatchAppend(TestHDFSEventSink.java:196)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.testTextBatchAppend(TestHDFSEventSink.java:127)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:252)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:141)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:189)
	at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:165)
	at org.apache.maven.surefire.booter.ProviderFactory.invokeProvider(ProviderFactory.java:85)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:115)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:75)
2017-09-08 13:44:59,112 (main) [DEBUG - org.apache.flume.sink.hdfs.BucketWriter.shouldRotate(BucketWriter.java:581)] rolling: rollCount: 10, events: 10
2017-09-08 13:44:59,112 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.close(BucketWriter.java:357)] Closing file:///tmp/flume-test.1504849498414.1/singleTextBucket/FlumeData.1504849498870.tmp
2017-09-08 13:44:59,113 (hdfs-HDFSEventSink-0b55a93f-2bab-4a97-a45e-8c0768685d5c-call-runner-9) [INFO - org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:618)] Renaming file:/tmp/flume-test.1504849498414.1/singleTextBucket/FlumeData.1504849498870.tmp to file:/tmp/flume-test.1504849498414.1/singleTextBucket/FlumeData.1504849498870
2017-09-08 13:44:59,125 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:231)] Creating file:///tmp/flume-test.1504849498414.1/singleTextBucket/FlumeData.1504849498871.tmp
2017-09-08 13:44:59,138 (hdfs-HDFSEventSink-0b55a93f-2bab-4a97-a45e-8c0768685d5c-call-runner-0) [INFO - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetNumCurrentReplicas(AbstractHDFSWriter.java:189)] FileSystem's output stream doesn't support getNumCurrentReplicas; --HDFS-826 not available; fsOut=org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer; err=java.lang.NoSuchMethodException: org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer.getNumCurrentReplicas()
2017-09-08 13:44:59,138 (hdfs-HDFSEventSink-0b55a93f-2bab-4a97-a45e-8c0768685d5c-call-runner-0) [DEBUG - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetDefaultReplication(AbstractHDFSWriter.java:228)] Using FileSystem.getDefaultReplication(Path) from HADOOP-8014
2017-09-08 13:44:59,138 (main) [WARN - org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:182)] isFileClosed is not available in the version of HDFS being used. Flume will not attempt to close files if the close fails on the first attempt
java.lang.NoSuchMethodException: org.apache.hadoop.fs.LocalFileSystem.isFileClosed(org.apache.hadoop.fs.Path)
	at java.lang.Class.getMethod(Class.java:1786)
	at org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:179)
	at org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:263)
	at org.apache.flume.sink.hdfs.BucketWriter.append(BucketWriter.java:530)
	at org.apache.flume.sink.hdfs.HDFSEventSink.process(HDFSEventSink.java:406)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.doTestTextBatchAppend(TestHDFSEventSink.java:196)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.testTextBatchAppend(TestHDFSEventSink.java:127)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:252)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:141)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:189)
	at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:165)
	at org.apache.maven.surefire.booter.ProviderFactory.invokeProvider(ProviderFactory.java:85)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:115)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:75)
2017-09-08 13:44:59,140 (main) [DEBUG - org.apache.flume.sink.hdfs.BucketWriter.shouldRotate(BucketWriter.java:581)] rolling: rollCount: 10, events: 10
2017-09-08 13:44:59,140 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.close(BucketWriter.java:357)] Closing file:///tmp/flume-test.1504849498414.1/singleTextBucket/FlumeData.1504849498871.tmp
2017-09-08 13:44:59,141 (hdfs-HDFSEventSink-0b55a93f-2bab-4a97-a45e-8c0768685d5c-call-runner-7) [INFO - org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:618)] Renaming file:/tmp/flume-test.1504849498414.1/singleTextBucket/FlumeData.1504849498871.tmp to file:/tmp/flume-test.1504849498414.1/singleTextBucket/FlumeData.1504849498871
2017-09-08 13:44:59,153 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:231)] Creating file:///tmp/flume-test.1504849498414.1/singleTextBucket/FlumeData.1504849498872.tmp
2017-09-08 13:44:59,166 (hdfs-HDFSEventSink-0b55a93f-2bab-4a97-a45e-8c0768685d5c-call-runner-8) [INFO - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetNumCurrentReplicas(AbstractHDFSWriter.java:189)] FileSystem's output stream doesn't support getNumCurrentReplicas; --HDFS-826 not available; fsOut=org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer; err=java.lang.NoSuchMethodException: org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer.getNumCurrentReplicas()
2017-09-08 13:44:59,166 (hdfs-HDFSEventSink-0b55a93f-2bab-4a97-a45e-8c0768685d5c-call-runner-8) [DEBUG - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetDefaultReplication(AbstractHDFSWriter.java:228)] Using FileSystem.getDefaultReplication(Path) from HADOOP-8014
2017-09-08 13:44:59,167 (main) [WARN - org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:182)] isFileClosed is not available in the version of HDFS being used. Flume will not attempt to close files if the close fails on the first attempt
java.lang.NoSuchMethodException: org.apache.hadoop.fs.LocalFileSystem.isFileClosed(org.apache.hadoop.fs.Path)
	at java.lang.Class.getMethod(Class.java:1786)
	at org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:179)
	at org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:263)
	at org.apache.flume.sink.hdfs.BucketWriter.append(BucketWriter.java:530)
	at org.apache.flume.sink.hdfs.HDFSEventSink.process(HDFSEventSink.java:406)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.doTestTextBatchAppend(TestHDFSEventSink.java:196)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.testTextBatchAppend(TestHDFSEventSink.java:127)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:252)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:141)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:189)
	at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:165)
	at org.apache.maven.surefire.booter.ProviderFactory.invokeProvider(ProviderFactory.java:85)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:115)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:75)
2017-09-08 13:44:59,169 (main) [DEBUG - org.apache.flume.sink.hdfs.BucketWriter.shouldRotate(BucketWriter.java:581)] rolling: rollCount: 10, events: 10
2017-09-08 13:44:59,170 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.close(BucketWriter.java:357)] Closing file:///tmp/flume-test.1504849498414.1/singleTextBucket/FlumeData.1504849498872.tmp
2017-09-08 13:44:59,171 (hdfs-HDFSEventSink-0b55a93f-2bab-4a97-a45e-8c0768685d5c-call-runner-5) [INFO - org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:618)] Renaming file:/tmp/flume-test.1504849498414.1/singleTextBucket/FlumeData.1504849498872.tmp to file:/tmp/flume-test.1504849498414.1/singleTextBucket/FlumeData.1504849498872
2017-09-08 13:44:59,186 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:231)] Creating file:///tmp/flume-test.1504849498414.1/singleTextBucket/FlumeData.1504849498873.tmp
2017-09-08 13:44:59,198 (hdfs-HDFSEventSink-0b55a93f-2bab-4a97-a45e-8c0768685d5c-call-runner-6) [INFO - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetNumCurrentReplicas(AbstractHDFSWriter.java:189)] FileSystem's output stream doesn't support getNumCurrentReplicas; --HDFS-826 not available; fsOut=org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer; err=java.lang.NoSuchMethodException: org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer.getNumCurrentReplicas()
2017-09-08 13:44:59,198 (hdfs-HDFSEventSink-0b55a93f-2bab-4a97-a45e-8c0768685d5c-call-runner-6) [DEBUG - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetDefaultReplication(AbstractHDFSWriter.java:228)] Using FileSystem.getDefaultReplication(Path) from HADOOP-8014
2017-09-08 13:44:59,199 (main) [WARN - org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:182)] isFileClosed is not available in the version of HDFS being used. Flume will not attempt to close files if the close fails on the first attempt
java.lang.NoSuchMethodException: org.apache.hadoop.fs.LocalFileSystem.isFileClosed(org.apache.hadoop.fs.Path)
	at java.lang.Class.getMethod(Class.java:1786)
	at org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:179)
	at org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:263)
	at org.apache.flume.sink.hdfs.BucketWriter.append(BucketWriter.java:530)
	at org.apache.flume.sink.hdfs.HDFSEventSink.process(HDFSEventSink.java:406)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.doTestTextBatchAppend(TestHDFSEventSink.java:196)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.testTextBatchAppend(TestHDFSEventSink.java:127)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:252)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:141)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:189)
	at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:165)
	at org.apache.maven.surefire.booter.ProviderFactory.invokeProvider(ProviderFactory.java:85)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:115)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:75)
2017-09-08 13:44:59,202 (main) [DEBUG - org.apache.flume.sink.hdfs.BucketWriter.shouldRotate(BucketWriter.java:581)] rolling: rollCount: 10, events: 10
2017-09-08 13:44:59,202 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.close(BucketWriter.java:357)] Closing file:///tmp/flume-test.1504849498414.1/singleTextBucket/FlumeData.1504849498873.tmp
2017-09-08 13:44:59,203 (hdfs-HDFSEventSink-0b55a93f-2bab-4a97-a45e-8c0768685d5c-call-runner-3) [INFO - org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:618)] Renaming file:/tmp/flume-test.1504849498414.1/singleTextBucket/FlumeData.1504849498873.tmp to file:/tmp/flume-test.1504849498414.1/singleTextBucket/FlumeData.1504849498873
2017-09-08 13:44:59,216 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:231)] Creating file:///tmp/flume-test.1504849498414.1/singleTextBucket/FlumeData.1504849498874.tmp
2017-09-08 13:44:59,228 (hdfs-HDFSEventSink-0b55a93f-2bab-4a97-a45e-8c0768685d5c-call-runner-4) [INFO - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetNumCurrentReplicas(AbstractHDFSWriter.java:189)] FileSystem's output stream doesn't support getNumCurrentReplicas; --HDFS-826 not available; fsOut=org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer; err=java.lang.NoSuchMethodException: org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer.getNumCurrentReplicas()
2017-09-08 13:44:59,228 (hdfs-HDFSEventSink-0b55a93f-2bab-4a97-a45e-8c0768685d5c-call-runner-4) [DEBUG - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetDefaultReplication(AbstractHDFSWriter.java:228)] Using FileSystem.getDefaultReplication(Path) from HADOOP-8014
2017-09-08 13:44:59,228 (main) [WARN - org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:182)] isFileClosed is not available in the version of HDFS being used. Flume will not attempt to close files if the close fails on the first attempt
java.lang.NoSuchMethodException: org.apache.hadoop.fs.LocalFileSystem.isFileClosed(org.apache.hadoop.fs.Path)
	at java.lang.Class.getMethod(Class.java:1786)
	at org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:179)
	at org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:263)
	at org.apache.flume.sink.hdfs.BucketWriter.append(BucketWriter.java:530)
	at org.apache.flume.sink.hdfs.HDFSEventSink.process(HDFSEventSink.java:406)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.doTestTextBatchAppend(TestHDFSEventSink.java:196)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.testTextBatchAppend(TestHDFSEventSink.java:127)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:252)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:141)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:189)
	at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:165)
	at org.apache.maven.surefire.booter.ProviderFactory.invokeProvider(ProviderFactory.java:85)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:115)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:75)
2017-09-08 13:44:59,231 (main) [DEBUG - org.apache.flume.sink.hdfs.BucketWriter.shouldRotate(BucketWriter.java:581)] rolling: rollCount: 10, events: 10
2017-09-08 13:44:59,231 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.close(BucketWriter.java:357)] Closing file:///tmp/flume-test.1504849498414.1/singleTextBucket/FlumeData.1504849498874.tmp
2017-09-08 13:44:59,232 (hdfs-HDFSEventSink-0b55a93f-2bab-4a97-a45e-8c0768685d5c-call-runner-1) [INFO - org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:618)] Renaming file:/tmp/flume-test.1504849498414.1/singleTextBucket/FlumeData.1504849498874.tmp to file:/tmp/flume-test.1504849498414.1/singleTextBucket/FlumeData.1504849498874
2017-09-08 13:44:59,250 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:231)] Creating file:///tmp/flume-test.1504849498414.1/singleTextBucket/FlumeData.1504849498875.tmp
2017-09-08 13:44:59,262 (hdfs-HDFSEventSink-0b55a93f-2bab-4a97-a45e-8c0768685d5c-call-runner-2) [INFO - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetNumCurrentReplicas(AbstractHDFSWriter.java:189)] FileSystem's output stream doesn't support getNumCurrentReplicas; --HDFS-826 not available; fsOut=org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer; err=java.lang.NoSuchMethodException: org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer.getNumCurrentReplicas()
2017-09-08 13:44:59,262 (hdfs-HDFSEventSink-0b55a93f-2bab-4a97-a45e-8c0768685d5c-call-runner-2) [DEBUG - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetDefaultReplication(AbstractHDFSWriter.java:228)] Using FileSystem.getDefaultReplication(Path) from HADOOP-8014
2017-09-08 13:44:59,262 (main) [WARN - org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:182)] isFileClosed is not available in the version of HDFS being used. Flume will not attempt to close files if the close fails on the first attempt
java.lang.NoSuchMethodException: org.apache.hadoop.fs.LocalFileSystem.isFileClosed(org.apache.hadoop.fs.Path)
	at java.lang.Class.getMethod(Class.java:1786)
	at org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:179)
	at org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:263)
	at org.apache.flume.sink.hdfs.BucketWriter.append(BucketWriter.java:530)
	at org.apache.flume.sink.hdfs.HDFSEventSink.process(HDFSEventSink.java:406)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.doTestTextBatchAppend(TestHDFSEventSink.java:196)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.testTextBatchAppend(TestHDFSEventSink.java:127)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:252)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:141)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:189)
	at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:165)
	at org.apache.maven.surefire.booter.ProviderFactory.invokeProvider(ProviderFactory.java:85)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:115)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:75)
2017-09-08 13:44:59,264 (main) [INFO - org.apache.flume.sink.hdfs.HDFSEventSink.stop(HDFSEventSink.java:480)] Closing file:///tmp/flume-test.1504849498414.1/singleTextBucket\FlumeData
2017-09-08 13:44:59,264 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.close(BucketWriter.java:357)] Closing file:///tmp/flume-test.1504849498414.1/singleTextBucket/FlumeData.1504849498875.tmp
2017-09-08 13:44:59,266 (hdfs-HDFSEventSink-0b55a93f-2bab-4a97-a45e-8c0768685d5c-call-runner-9) [INFO - org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:618)] Renaming file:/tmp/flume-test.1504849498414.1/singleTextBucket/FlumeData.1504849498875.tmp to file:/tmp/flume-test.1504849498414.1/singleTextBucket/FlumeData.1504849498875
2017-09-08 13:44:59,268 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:149)] Component type: SINK, name: HDFSEventSink-0b55a93f-2bab-4a97-a45e-8c0768685d5c stopped
2017-09-08 13:44:59,268 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:155)] Shutdown Metric for type: SINK, name: HDFSEventSink-0b55a93f-2bab-4a97-a45e-8c0768685d5c. sink.start.time == 1504849498858
2017-09-08 13:44:59,269 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:161)] Shutdown Metric for type: SINK, name: HDFSEventSink-0b55a93f-2bab-4a97-a45e-8c0768685d5c. sink.stop.time == 1504849499268
2017-09-08 13:44:59,269 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-0b55a93f-2bab-4a97-a45e-8c0768685d5c. sink.batch.complete == 50
2017-09-08 13:44:59,269 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-0b55a93f-2bab-4a97-a45e-8c0768685d5c. sink.batch.empty == 0
2017-09-08 13:44:59,269 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-0b55a93f-2bab-4a97-a45e-8c0768685d5c. sink.batch.underflow == 0
2017-09-08 13:44:59,270 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-0b55a93f-2bab-4a97-a45e-8c0768685d5c. sink.connection.closed.count == 10
2017-09-08 13:44:59,270 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-0b55a93f-2bab-4a97-a45e-8c0768685d5c. sink.connection.creation.count == 10
2017-09-08 13:44:59,270 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-0b55a93f-2bab-4a97-a45e-8c0768685d5c. sink.connection.failed.count == 0
2017-09-08 13:44:59,270 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-0b55a93f-2bab-4a97-a45e-8c0768685d5c. sink.event.drain.attempt == 100
2017-09-08 13:44:59,270 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-0b55a93f-2bab-4a97-a45e-8c0768685d5c. sink.event.drain.sucess == 100
2017-09-08 13:44:59,312 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.setUp(TestHDFSEventSink.java:104)] Starting...
2017-09-08 13:44:59,325 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.doTestTextBatchAppend(TestHDFSEventSink.java:137)] Starting...
2017-09-08 13:44:59,338 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.register(MonitoredCounterGroup.java:119)] Monitored counter group for type: SINK, name: HDFSEventSink-18c4fd4c-9ad3-4872-8726-72481f1ae2f0: Successfully registered new MBean.
2017-09-08 13:44:59,338 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.start(MonitoredCounterGroup.java:95)] Component type: SINK, name: HDFSEventSink-18c4fd4c-9ad3-4872-8726-72481f1ae2f0 started
2017-09-08 13:44:59,339 (main) [INFO - org.apache.flume.sink.hdfs.HDFSDataStream.configure(HDFSDataStream.java:57)] Serializer = TEXT, UseRawLocalFileSystem = true
2017-09-08 13:44:59,350 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:231)] Creating file:///tmp/flume-test.1504849499312.1/singleTextBucket/FlumeData.1504849499340.tmp
2017-09-08 13:44:59,364 (hdfs-HDFSEventSink-18c4fd4c-9ad3-4872-8726-72481f1ae2f0-call-runner-0) [INFO - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetNumCurrentReplicas(AbstractHDFSWriter.java:189)] FileSystem's output stream doesn't support getNumCurrentReplicas; --HDFS-826 not available; fsOut=java.io.BufferedOutputStream; err=java.lang.NoSuchMethodException: java.io.BufferedOutputStream.getNumCurrentReplicas()
2017-09-08 13:44:59,364 (hdfs-HDFSEventSink-18c4fd4c-9ad3-4872-8726-72481f1ae2f0-call-runner-0) [DEBUG - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetDefaultReplication(AbstractHDFSWriter.java:228)] Using FileSystem.getDefaultReplication(Path) from HADOOP-8014
2017-09-08 13:44:59,364 (main) [WARN - org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:182)] isFileClosed is not available in the version of HDFS being used. Flume will not attempt to close files if the close fails on the first attempt
java.lang.NoSuchMethodException: org.apache.hadoop.fs.LocalFileSystem.isFileClosed(org.apache.hadoop.fs.Path)
	at java.lang.Class.getMethod(Class.java:1786)
	at org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:179)
	at org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:263)
	at org.apache.flume.sink.hdfs.BucketWriter.append(BucketWriter.java:504)
	at org.apache.flume.sink.hdfs.HDFSEventSink.process(HDFSEventSink.java:406)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.doTestTextBatchAppend(TestHDFSEventSink.java:196)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.testTextBatchAppendRawFS(TestHDFSEventSink.java:132)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:252)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:141)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:189)
	at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:165)
	at org.apache.maven.surefire.booter.ProviderFactory.invokeProvider(ProviderFactory.java:85)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:115)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:75)
2017-09-08 13:44:59,369 (main) [DEBUG - org.apache.flume.sink.hdfs.BucketWriter.shouldRotate(BucketWriter.java:581)] rolling: rollCount: 10, events: 10
2017-09-08 13:44:59,369 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.close(BucketWriter.java:357)] Closing file:///tmp/flume-test.1504849499312.1/singleTextBucket/FlumeData.1504849499340.tmp
2017-09-08 13:44:59,370 (hdfs-HDFSEventSink-18c4fd4c-9ad3-4872-8726-72481f1ae2f0-call-runner-7) [INFO - org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:618)] Renaming file:/tmp/flume-test.1504849499312.1/singleTextBucket/FlumeData.1504849499340.tmp to file:/tmp/flume-test.1504849499312.1/singleTextBucket/FlumeData.1504849499340
2017-09-08 13:44:59,381 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:231)] Creating file:///tmp/flume-test.1504849499312.1/singleTextBucket/FlumeData.1504849499341.tmp
2017-09-08 13:44:59,393 (hdfs-HDFSEventSink-18c4fd4c-9ad3-4872-8726-72481f1ae2f0-call-runner-8) [INFO - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetNumCurrentReplicas(AbstractHDFSWriter.java:189)] FileSystem's output stream doesn't support getNumCurrentReplicas; --HDFS-826 not available; fsOut=java.io.BufferedOutputStream; err=java.lang.NoSuchMethodException: java.io.BufferedOutputStream.getNumCurrentReplicas()
2017-09-08 13:44:59,393 (hdfs-HDFSEventSink-18c4fd4c-9ad3-4872-8726-72481f1ae2f0-call-runner-8) [DEBUG - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetDefaultReplication(AbstractHDFSWriter.java:228)] Using FileSystem.getDefaultReplication(Path) from HADOOP-8014
2017-09-08 13:44:59,393 (main) [WARN - org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:182)] isFileClosed is not available in the version of HDFS being used. Flume will not attempt to close files if the close fails on the first attempt
java.lang.NoSuchMethodException: org.apache.hadoop.fs.LocalFileSystem.isFileClosed(org.apache.hadoop.fs.Path)
	at java.lang.Class.getMethod(Class.java:1786)
	at org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:179)
	at org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:263)
	at org.apache.flume.sink.hdfs.BucketWriter.append(BucketWriter.java:530)
	at org.apache.flume.sink.hdfs.HDFSEventSink.process(HDFSEventSink.java:406)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.doTestTextBatchAppend(TestHDFSEventSink.java:196)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.testTextBatchAppendRawFS(TestHDFSEventSink.java:132)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:252)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:141)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:189)
	at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:165)
	at org.apache.maven.surefire.booter.ProviderFactory.invokeProvider(ProviderFactory.java:85)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:115)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:75)
2017-09-08 13:44:59,395 (main) [DEBUG - org.apache.flume.sink.hdfs.BucketWriter.shouldRotate(BucketWriter.java:581)] rolling: rollCount: 10, events: 10
2017-09-08 13:44:59,395 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.close(BucketWriter.java:357)] Closing file:///tmp/flume-test.1504849499312.1/singleTextBucket/FlumeData.1504849499341.tmp
2017-09-08 13:44:59,396 (hdfs-HDFSEventSink-18c4fd4c-9ad3-4872-8726-72481f1ae2f0-call-runner-5) [INFO - org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:618)] Renaming file:/tmp/flume-test.1504849499312.1/singleTextBucket/FlumeData.1504849499341.tmp to file:/tmp/flume-test.1504849499312.1/singleTextBucket/FlumeData.1504849499341
2017-09-08 13:44:59,412 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:231)] Creating file:///tmp/flume-test.1504849499312.1/singleTextBucket/FlumeData.1504849499342.tmp
2017-09-08 13:44:59,422 (hdfs-HDFSEventSink-18c4fd4c-9ad3-4872-8726-72481f1ae2f0-call-runner-6) [INFO - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetNumCurrentReplicas(AbstractHDFSWriter.java:189)] FileSystem's output stream doesn't support getNumCurrentReplicas; --HDFS-826 not available; fsOut=java.io.BufferedOutputStream; err=java.lang.NoSuchMethodException: java.io.BufferedOutputStream.getNumCurrentReplicas()
2017-09-08 13:44:59,423 (hdfs-HDFSEventSink-18c4fd4c-9ad3-4872-8726-72481f1ae2f0-call-runner-6) [DEBUG - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetDefaultReplication(AbstractHDFSWriter.java:228)] Using FileSystem.getDefaultReplication(Path) from HADOOP-8014
2017-09-08 13:44:59,423 (main) [WARN - org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:182)] isFileClosed is not available in the version of HDFS being used. Flume will not attempt to close files if the close fails on the first attempt
java.lang.NoSuchMethodException: org.apache.hadoop.fs.LocalFileSystem.isFileClosed(org.apache.hadoop.fs.Path)
	at java.lang.Class.getMethod(Class.java:1786)
	at org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:179)
	at org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:263)
	at org.apache.flume.sink.hdfs.BucketWriter.append(BucketWriter.java:530)
	at org.apache.flume.sink.hdfs.HDFSEventSink.process(HDFSEventSink.java:406)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.doTestTextBatchAppend(TestHDFSEventSink.java:196)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.testTextBatchAppendRawFS(TestHDFSEventSink.java:132)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:252)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:141)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:189)
	at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:165)
	at org.apache.maven.surefire.booter.ProviderFactory.invokeProvider(ProviderFactory.java:85)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:115)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:75)
2017-09-08 13:44:59,425 (main) [DEBUG - org.apache.flume.sink.hdfs.BucketWriter.shouldRotate(BucketWriter.java:581)] rolling: rollCount: 10, events: 10
2017-09-08 13:44:59,425 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.close(BucketWriter.java:357)] Closing file:///tmp/flume-test.1504849499312.1/singleTextBucket/FlumeData.1504849499342.tmp
2017-09-08 13:44:59,426 (hdfs-HDFSEventSink-18c4fd4c-9ad3-4872-8726-72481f1ae2f0-call-runner-3) [INFO - org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:618)] Renaming file:/tmp/flume-test.1504849499312.1/singleTextBucket/FlumeData.1504849499342.tmp to file:/tmp/flume-test.1504849499312.1/singleTextBucket/FlumeData.1504849499342
2017-09-08 13:44:59,439 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:231)] Creating file:///tmp/flume-test.1504849499312.1/singleTextBucket/FlumeData.1504849499343.tmp
2017-09-08 13:44:59,452 (hdfs-HDFSEventSink-18c4fd4c-9ad3-4872-8726-72481f1ae2f0-call-runner-4) [INFO - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetNumCurrentReplicas(AbstractHDFSWriter.java:189)] FileSystem's output stream doesn't support getNumCurrentReplicas; --HDFS-826 not available; fsOut=java.io.BufferedOutputStream; err=java.lang.NoSuchMethodException: java.io.BufferedOutputStream.getNumCurrentReplicas()
2017-09-08 13:44:59,452 (hdfs-HDFSEventSink-18c4fd4c-9ad3-4872-8726-72481f1ae2f0-call-runner-4) [DEBUG - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetDefaultReplication(AbstractHDFSWriter.java:228)] Using FileSystem.getDefaultReplication(Path) from HADOOP-8014
2017-09-08 13:44:59,452 (main) [WARN - org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:182)] isFileClosed is not available in the version of HDFS being used. Flume will not attempt to close files if the close fails on the first attempt
java.lang.NoSuchMethodException: org.apache.hadoop.fs.LocalFileSystem.isFileClosed(org.apache.hadoop.fs.Path)
	at java.lang.Class.getMethod(Class.java:1786)
	at org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:179)
	at org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:263)
	at org.apache.flume.sink.hdfs.BucketWriter.append(BucketWriter.java:530)
	at org.apache.flume.sink.hdfs.HDFSEventSink.process(HDFSEventSink.java:406)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.doTestTextBatchAppend(TestHDFSEventSink.java:196)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.testTextBatchAppendRawFS(TestHDFSEventSink.java:132)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:252)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:141)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:189)
	at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:165)
	at org.apache.maven.surefire.booter.ProviderFactory.invokeProvider(ProviderFactory.java:85)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:115)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:75)
2017-09-08 13:44:59,454 (main) [DEBUG - org.apache.flume.sink.hdfs.BucketWriter.shouldRotate(BucketWriter.java:581)] rolling: rollCount: 10, events: 10
2017-09-08 13:44:59,454 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.close(BucketWriter.java:357)] Closing file:///tmp/flume-test.1504849499312.1/singleTextBucket/FlumeData.1504849499343.tmp
2017-09-08 13:44:59,455 (hdfs-HDFSEventSink-18c4fd4c-9ad3-4872-8726-72481f1ae2f0-call-runner-1) [INFO - org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:618)] Renaming file:/tmp/flume-test.1504849499312.1/singleTextBucket/FlumeData.1504849499343.tmp to file:/tmp/flume-test.1504849499312.1/singleTextBucket/FlumeData.1504849499343
2017-09-08 13:44:59,470 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:231)] Creating file:///tmp/flume-test.1504849499312.1/singleTextBucket/FlumeData.1504849499344.tmp
2017-09-08 13:44:59,483 (hdfs-HDFSEventSink-18c4fd4c-9ad3-4872-8726-72481f1ae2f0-call-runner-2) [INFO - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetNumCurrentReplicas(AbstractHDFSWriter.java:189)] FileSystem's output stream doesn't support getNumCurrentReplicas; --HDFS-826 not available; fsOut=java.io.BufferedOutputStream; err=java.lang.NoSuchMethodException: java.io.BufferedOutputStream.getNumCurrentReplicas()
2017-09-08 13:44:59,483 (hdfs-HDFSEventSink-18c4fd4c-9ad3-4872-8726-72481f1ae2f0-call-runner-2) [DEBUG - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetDefaultReplication(AbstractHDFSWriter.java:228)] Using FileSystem.getDefaultReplication(Path) from HADOOP-8014
2017-09-08 13:44:59,483 (main) [WARN - org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:182)] isFileClosed is not available in the version of HDFS being used. Flume will not attempt to close files if the close fails on the first attempt
java.lang.NoSuchMethodException: org.apache.hadoop.fs.LocalFileSystem.isFileClosed(org.apache.hadoop.fs.Path)
	at java.lang.Class.getMethod(Class.java:1786)
	at org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:179)
	at org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:263)
	at org.apache.flume.sink.hdfs.BucketWriter.append(BucketWriter.java:530)
	at org.apache.flume.sink.hdfs.HDFSEventSink.process(HDFSEventSink.java:406)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.doTestTextBatchAppend(TestHDFSEventSink.java:196)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.testTextBatchAppendRawFS(TestHDFSEventSink.java:132)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:252)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:141)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:189)
	at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:165)
	at org.apache.maven.surefire.booter.ProviderFactory.invokeProvider(ProviderFactory.java:85)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:115)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:75)
2017-09-08 13:44:59,485 (main) [DEBUG - org.apache.flume.sink.hdfs.BucketWriter.shouldRotate(BucketWriter.java:581)] rolling: rollCount: 10, events: 10
2017-09-08 13:44:59,486 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.close(BucketWriter.java:357)] Closing file:///tmp/flume-test.1504849499312.1/singleTextBucket/FlumeData.1504849499344.tmp
2017-09-08 13:44:59,486 (hdfs-HDFSEventSink-18c4fd4c-9ad3-4872-8726-72481f1ae2f0-call-runner-0) [INFO - org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:618)] Renaming file:/tmp/flume-test.1504849499312.1/singleTextBucket/FlumeData.1504849499344.tmp to file:/tmp/flume-test.1504849499312.1/singleTextBucket/FlumeData.1504849499344
2017-09-08 13:44:59,500 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:231)] Creating file:///tmp/flume-test.1504849499312.1/singleTextBucket/FlumeData.1504849499345.tmp
2017-09-08 13:44:59,516 (hdfs-HDFSEventSink-18c4fd4c-9ad3-4872-8726-72481f1ae2f0-call-runner-8) [INFO - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetNumCurrentReplicas(AbstractHDFSWriter.java:189)] FileSystem's output stream doesn't support getNumCurrentReplicas; --HDFS-826 not available; fsOut=java.io.BufferedOutputStream; err=java.lang.NoSuchMethodException: java.io.BufferedOutputStream.getNumCurrentReplicas()
2017-09-08 13:44:59,516 (hdfs-HDFSEventSink-18c4fd4c-9ad3-4872-8726-72481f1ae2f0-call-runner-8) [DEBUG - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetDefaultReplication(AbstractHDFSWriter.java:228)] Using FileSystem.getDefaultReplication(Path) from HADOOP-8014
2017-09-08 13:44:59,516 (main) [WARN - org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:182)] isFileClosed is not available in the version of HDFS being used. Flume will not attempt to close files if the close fails on the first attempt
java.lang.NoSuchMethodException: org.apache.hadoop.fs.LocalFileSystem.isFileClosed(org.apache.hadoop.fs.Path)
	at java.lang.Class.getMethod(Class.java:1786)
	at org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:179)
	at org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:263)
	at org.apache.flume.sink.hdfs.BucketWriter.append(BucketWriter.java:530)
	at org.apache.flume.sink.hdfs.HDFSEventSink.process(HDFSEventSink.java:406)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.doTestTextBatchAppend(TestHDFSEventSink.java:196)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.testTextBatchAppendRawFS(TestHDFSEventSink.java:132)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:252)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:141)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:189)
	at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:165)
	at org.apache.maven.surefire.booter.ProviderFactory.invokeProvider(ProviderFactory.java:85)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:115)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:75)
2017-09-08 13:44:59,519 (main) [DEBUG - org.apache.flume.sink.hdfs.BucketWriter.shouldRotate(BucketWriter.java:581)] rolling: rollCount: 10, events: 10
2017-09-08 13:44:59,519 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.close(BucketWriter.java:357)] Closing file:///tmp/flume-test.1504849499312.1/singleTextBucket/FlumeData.1504849499345.tmp
2017-09-08 13:44:59,520 (hdfs-HDFSEventSink-18c4fd4c-9ad3-4872-8726-72481f1ae2f0-call-runner-7) [INFO - org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:618)] Renaming file:/tmp/flume-test.1504849499312.1/singleTextBucket/FlumeData.1504849499345.tmp to file:/tmp/flume-test.1504849499312.1/singleTextBucket/FlumeData.1504849499345
2017-09-08 13:44:59,542 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:231)] Creating file:///tmp/flume-test.1504849499312.1/singleTextBucket/FlumeData.1504849499346.tmp
2017-09-08 13:44:59,556 (hdfs-HDFSEventSink-18c4fd4c-9ad3-4872-8726-72481f1ae2f0-call-runner-9) [INFO - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetNumCurrentReplicas(AbstractHDFSWriter.java:189)] FileSystem's output stream doesn't support getNumCurrentReplicas; --HDFS-826 not available; fsOut=java.io.BufferedOutputStream; err=java.lang.NoSuchMethodException: java.io.BufferedOutputStream.getNumCurrentReplicas()
2017-09-08 13:44:59,557 (hdfs-HDFSEventSink-18c4fd4c-9ad3-4872-8726-72481f1ae2f0-call-runner-9) [DEBUG - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetDefaultReplication(AbstractHDFSWriter.java:228)] Using FileSystem.getDefaultReplication(Path) from HADOOP-8014
2017-09-08 13:44:59,557 (main) [WARN - org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:182)] isFileClosed is not available in the version of HDFS being used. Flume will not attempt to close files if the close fails on the first attempt
java.lang.NoSuchMethodException: org.apache.hadoop.fs.LocalFileSystem.isFileClosed(org.apache.hadoop.fs.Path)
	at java.lang.Class.getMethod(Class.java:1786)
	at org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:179)
	at org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:263)
	at org.apache.flume.sink.hdfs.BucketWriter.append(BucketWriter.java:530)
	at org.apache.flume.sink.hdfs.HDFSEventSink.process(HDFSEventSink.java:406)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.doTestTextBatchAppend(TestHDFSEventSink.java:196)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.testTextBatchAppendRawFS(TestHDFSEventSink.java:132)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:252)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:141)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:189)
	at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:165)
	at org.apache.maven.surefire.booter.ProviderFactory.invokeProvider(ProviderFactory.java:85)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:115)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:75)
2017-09-08 13:44:59,559 (main) [DEBUG - org.apache.flume.sink.hdfs.BucketWriter.shouldRotate(BucketWriter.java:581)] rolling: rollCount: 10, events: 10
2017-09-08 13:44:59,559 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.close(BucketWriter.java:357)] Closing file:///tmp/flume-test.1504849499312.1/singleTextBucket/FlumeData.1504849499346.tmp
2017-09-08 13:44:59,560 (hdfs-HDFSEventSink-18c4fd4c-9ad3-4872-8726-72481f1ae2f0-call-runner-5) [INFO - org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:618)] Renaming file:/tmp/flume-test.1504849499312.1/singleTextBucket/FlumeData.1504849499346.tmp to file:/tmp/flume-test.1504849499312.1/singleTextBucket/FlumeData.1504849499346
2017-09-08 13:44:59,578 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:231)] Creating file:///tmp/flume-test.1504849499312.1/singleTextBucket/FlumeData.1504849499347.tmp
2017-09-08 13:44:59,596 (hdfs-HDFSEventSink-18c4fd4c-9ad3-4872-8726-72481f1ae2f0-call-runner-6) [INFO - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetNumCurrentReplicas(AbstractHDFSWriter.java:189)] FileSystem's output stream doesn't support getNumCurrentReplicas; --HDFS-826 not available; fsOut=java.io.BufferedOutputStream; err=java.lang.NoSuchMethodException: java.io.BufferedOutputStream.getNumCurrentReplicas()
2017-09-08 13:44:59,596 (hdfs-HDFSEventSink-18c4fd4c-9ad3-4872-8726-72481f1ae2f0-call-runner-6) [DEBUG - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetDefaultReplication(AbstractHDFSWriter.java:228)] Using FileSystem.getDefaultReplication(Path) from HADOOP-8014
2017-09-08 13:44:59,596 (main) [WARN - org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:182)] isFileClosed is not available in the version of HDFS being used. Flume will not attempt to close files if the close fails on the first attempt
java.lang.NoSuchMethodException: org.apache.hadoop.fs.LocalFileSystem.isFileClosed(org.apache.hadoop.fs.Path)
	at java.lang.Class.getMethod(Class.java:1786)
	at org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:179)
	at org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:263)
	at org.apache.flume.sink.hdfs.BucketWriter.append(BucketWriter.java:530)
	at org.apache.flume.sink.hdfs.HDFSEventSink.process(HDFSEventSink.java:406)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.doTestTextBatchAppend(TestHDFSEventSink.java:196)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.testTextBatchAppendRawFS(TestHDFSEventSink.java:132)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:252)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:141)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:189)
	at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:165)
	at org.apache.maven.surefire.booter.ProviderFactory.invokeProvider(ProviderFactory.java:85)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:115)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:75)
2017-09-08 13:44:59,598 (main) [DEBUG - org.apache.flume.sink.hdfs.BucketWriter.shouldRotate(BucketWriter.java:581)] rolling: rollCount: 10, events: 10
2017-09-08 13:44:59,598 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.close(BucketWriter.java:357)] Closing file:///tmp/flume-test.1504849499312.1/singleTextBucket/FlumeData.1504849499347.tmp
2017-09-08 13:44:59,599 (hdfs-HDFSEventSink-18c4fd4c-9ad3-4872-8726-72481f1ae2f0-call-runner-3) [INFO - org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:618)] Renaming file:/tmp/flume-test.1504849499312.1/singleTextBucket/FlumeData.1504849499347.tmp to file:/tmp/flume-test.1504849499312.1/singleTextBucket/FlumeData.1504849499347
2017-09-08 13:44:59,611 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:231)] Creating file:///tmp/flume-test.1504849499312.1/singleTextBucket/FlumeData.1504849499348.tmp
2017-09-08 13:44:59,623 (hdfs-HDFSEventSink-18c4fd4c-9ad3-4872-8726-72481f1ae2f0-call-runner-4) [INFO - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetNumCurrentReplicas(AbstractHDFSWriter.java:189)] FileSystem's output stream doesn't support getNumCurrentReplicas; --HDFS-826 not available; fsOut=java.io.BufferedOutputStream; err=java.lang.NoSuchMethodException: java.io.BufferedOutputStream.getNumCurrentReplicas()
2017-09-08 13:44:59,623 (hdfs-HDFSEventSink-18c4fd4c-9ad3-4872-8726-72481f1ae2f0-call-runner-4) [DEBUG - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetDefaultReplication(AbstractHDFSWriter.java:228)] Using FileSystem.getDefaultReplication(Path) from HADOOP-8014
2017-09-08 13:44:59,623 (main) [WARN - org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:182)] isFileClosed is not available in the version of HDFS being used. Flume will not attempt to close files if the close fails on the first attempt
java.lang.NoSuchMethodException: org.apache.hadoop.fs.LocalFileSystem.isFileClosed(org.apache.hadoop.fs.Path)
	at java.lang.Class.getMethod(Class.java:1786)
	at org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:179)
	at org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:263)
	at org.apache.flume.sink.hdfs.BucketWriter.append(BucketWriter.java:530)
	at org.apache.flume.sink.hdfs.HDFSEventSink.process(HDFSEventSink.java:406)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.doTestTextBatchAppend(TestHDFSEventSink.java:196)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.testTextBatchAppendRawFS(TestHDFSEventSink.java:132)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:252)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:141)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:189)
	at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:165)
	at org.apache.maven.surefire.booter.ProviderFactory.invokeProvider(ProviderFactory.java:85)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:115)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:75)
2017-09-08 13:44:59,626 (main) [DEBUG - org.apache.flume.sink.hdfs.BucketWriter.shouldRotate(BucketWriter.java:581)] rolling: rollCount: 10, events: 10
2017-09-08 13:44:59,626 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.close(BucketWriter.java:357)] Closing file:///tmp/flume-test.1504849499312.1/singleTextBucket/FlumeData.1504849499348.tmp
2017-09-08 13:44:59,627 (hdfs-HDFSEventSink-18c4fd4c-9ad3-4872-8726-72481f1ae2f0-call-runner-1) [INFO - org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:618)] Renaming file:/tmp/flume-test.1504849499312.1/singleTextBucket/FlumeData.1504849499348.tmp to file:/tmp/flume-test.1504849499312.1/singleTextBucket/FlumeData.1504849499348
2017-09-08 13:44:59,639 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:231)] Creating file:///tmp/flume-test.1504849499312.1/singleTextBucket/FlumeData.1504849499349.tmp
2017-09-08 13:44:59,650 (hdfs-HDFSEventSink-18c4fd4c-9ad3-4872-8726-72481f1ae2f0-call-runner-2) [INFO - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetNumCurrentReplicas(AbstractHDFSWriter.java:189)] FileSystem's output stream doesn't support getNumCurrentReplicas; --HDFS-826 not available; fsOut=java.io.BufferedOutputStream; err=java.lang.NoSuchMethodException: java.io.BufferedOutputStream.getNumCurrentReplicas()
2017-09-08 13:44:59,650 (hdfs-HDFSEventSink-18c4fd4c-9ad3-4872-8726-72481f1ae2f0-call-runner-2) [DEBUG - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetDefaultReplication(AbstractHDFSWriter.java:228)] Using FileSystem.getDefaultReplication(Path) from HADOOP-8014
2017-09-08 13:44:59,650 (main) [WARN - org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:182)] isFileClosed is not available in the version of HDFS being used. Flume will not attempt to close files if the close fails on the first attempt
java.lang.NoSuchMethodException: org.apache.hadoop.fs.LocalFileSystem.isFileClosed(org.apache.hadoop.fs.Path)
	at java.lang.Class.getMethod(Class.java:1786)
	at org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:179)
	at org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:263)
	at org.apache.flume.sink.hdfs.BucketWriter.append(BucketWriter.java:530)
	at org.apache.flume.sink.hdfs.HDFSEventSink.process(HDFSEventSink.java:406)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.doTestTextBatchAppend(TestHDFSEventSink.java:196)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.testTextBatchAppendRawFS(TestHDFSEventSink.java:132)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:252)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:141)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:189)
	at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:165)
	at org.apache.maven.surefire.booter.ProviderFactory.invokeProvider(ProviderFactory.java:85)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:115)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:75)
2017-09-08 13:44:59,652 (main) [INFO - org.apache.flume.sink.hdfs.HDFSEventSink.stop(HDFSEventSink.java:480)] Closing file:///tmp/flume-test.1504849499312.1/singleTextBucket\FlumeData
2017-09-08 13:44:59,652 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.close(BucketWriter.java:357)] Closing file:///tmp/flume-test.1504849499312.1/singleTextBucket/FlumeData.1504849499349.tmp
2017-09-08 13:44:59,653 (hdfs-HDFSEventSink-18c4fd4c-9ad3-4872-8726-72481f1ae2f0-call-runner-0) [INFO - org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:618)] Renaming file:/tmp/flume-test.1504849499312.1/singleTextBucket/FlumeData.1504849499349.tmp to file:/tmp/flume-test.1504849499312.1/singleTextBucket/FlumeData.1504849499349
2017-09-08 13:44:59,654 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:149)] Component type: SINK, name: HDFSEventSink-18c4fd4c-9ad3-4872-8726-72481f1ae2f0 stopped
2017-09-08 13:44:59,654 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:155)] Shutdown Metric for type: SINK, name: HDFSEventSink-18c4fd4c-9ad3-4872-8726-72481f1ae2f0. sink.start.time == 1504849499338
2017-09-08 13:44:59,654 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:161)] Shutdown Metric for type: SINK, name: HDFSEventSink-18c4fd4c-9ad3-4872-8726-72481f1ae2f0. sink.stop.time == 1504849499654
2017-09-08 13:44:59,654 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-18c4fd4c-9ad3-4872-8726-72481f1ae2f0. sink.batch.complete == 50
2017-09-08 13:44:59,654 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-18c4fd4c-9ad3-4872-8726-72481f1ae2f0. sink.batch.empty == 0
2017-09-08 13:44:59,655 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-18c4fd4c-9ad3-4872-8726-72481f1ae2f0. sink.batch.underflow == 0
2017-09-08 13:44:59,655 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-18c4fd4c-9ad3-4872-8726-72481f1ae2f0. sink.connection.closed.count == 10
2017-09-08 13:44:59,655 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-18c4fd4c-9ad3-4872-8726-72481f1ae2f0. sink.connection.creation.count == 10
2017-09-08 13:44:59,655 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-18c4fd4c-9ad3-4872-8726-72481f1ae2f0. sink.connection.failed.count == 0
2017-09-08 13:44:59,655 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-18c4fd4c-9ad3-4872-8726-72481f1ae2f0. sink.event.drain.attempt == 100
2017-09-08 13:44:59,655 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-18c4fd4c-9ad3-4872-8726-72481f1ae2f0. sink.event.drain.sucess == 100
2017-09-08 13:44:59,677 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.setUp(TestHDFSEventSink.java:104)] Starting...
2017-09-08 13:44:59,687 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.testKerbFileAccess(TestHDFSEventSink.java:252)] Starting testKerbFileAccess() ...
2017-09-08 13:44:59,707 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.setUp(TestHDFSEventSink.java:104)] Starting...
2017-09-08 13:44:59,717 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.testSimpleAppendLocalTime(TestHDFSEventSink.java:532)] Starting...
2017-09-08 13:44:59,726 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.register(MonitoredCounterGroup.java:119)] Monitored counter group for type: SINK, name: HDFSEventSink-2487afda-e12d-4078-87fd-65375302274b: Successfully registered new MBean.
2017-09-08 13:44:59,726 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.start(MonitoredCounterGroup.java:95)] Component type: SINK, name: HDFSEventSink-2487afda-e12d-4078-87fd-65375302274b started
2017-09-08 13:44:59,729 (main) [INFO - org.apache.flume.sink.hdfs.HDFSSequenceFile.configure(HDFSSequenceFile.java:63)] writeFormat = Writable, UseRawLocalFileSystem = false
2017-09-08 13:44:59,739 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:231)] Creating file:///tmp/flume-test.1504849499707.1/singleBucket/1504849499/FlumeData.1504849499728.tmp
2017-09-08 13:44:59,764 (hdfs-HDFSEventSink-2487afda-e12d-4078-87fd-65375302274b-call-runner-0) [INFO - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetNumCurrentReplicas(AbstractHDFSWriter.java:189)] FileSystem's output stream doesn't support getNumCurrentReplicas; --HDFS-826 not available; fsOut=org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer; err=java.lang.NoSuchMethodException: org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer.getNumCurrentReplicas()
2017-09-08 13:44:59,764 (hdfs-HDFSEventSink-2487afda-e12d-4078-87fd-65375302274b-call-runner-0) [DEBUG - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetDefaultReplication(AbstractHDFSWriter.java:228)] Using FileSystem.getDefaultReplication(Path) from HADOOP-8014
2017-09-08 13:44:59,764 (main) [WARN - org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:182)] isFileClosed is not available in the version of HDFS being used. Flume will not attempt to close files if the close fails on the first attempt
java.lang.NoSuchMethodException: org.apache.hadoop.fs.LocalFileSystem.isFileClosed(org.apache.hadoop.fs.Path)
	at java.lang.Class.getMethod(Class.java:1786)
	at org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:179)
	at org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:263)
	at org.apache.flume.sink.hdfs.BucketWriter.append(BucketWriter.java:504)
	at org.apache.flume.sink.hdfs.HDFSEventSink.process(HDFSEventSink.java:406)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.testSimpleAppendLocalTime(TestHDFSEventSink.java:591)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:252)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:141)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:189)
	at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:165)
	at org.apache.maven.surefire.booter.ProviderFactory.invokeProvider(ProviderFactory.java:85)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:115)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:75)
2017-09-08 13:44:59,769 (main) [DEBUG - org.apache.flume.sink.hdfs.BucketWriter.shouldRotate(BucketWriter.java:581)] rolling: rollCount: 5, events: 5
2017-09-08 13:44:59,769 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.close(BucketWriter.java:357)] Closing file:///tmp/flume-test.1504849499707.1/singleBucket/1504849499/FlumeData.1504849499728.tmp
2017-09-08 13:44:59,796 (hdfs-HDFSEventSink-2487afda-e12d-4078-87fd-65375302274b-call-runner-0) [INFO - org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:618)] Renaming file:/tmp/flume-test.1504849499707.1/singleBucket/1504849499/FlumeData.1504849499728.tmp to file:/tmp/flume-test.1504849499707.1/singleBucket/1504849499/FlumeData.1504849499728
2017-09-08 13:44:59,808 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:231)] Creating file:///tmp/flume-test.1504849499707.1/singleBucket/1504849499/FlumeData.1504849499729.tmp
2017-09-08 13:44:59,819 (hdfs-HDFSEventSink-2487afda-e12d-4078-87fd-65375302274b-call-runner-1) [INFO - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetNumCurrentReplicas(AbstractHDFSWriter.java:189)] FileSystem's output stream doesn't support getNumCurrentReplicas; --HDFS-826 not available; fsOut=org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer; err=java.lang.NoSuchMethodException: org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer.getNumCurrentReplicas()
2017-09-08 13:44:59,820 (hdfs-HDFSEventSink-2487afda-e12d-4078-87fd-65375302274b-call-runner-1) [DEBUG - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetDefaultReplication(AbstractHDFSWriter.java:228)] Using FileSystem.getDefaultReplication(Path) from HADOOP-8014
2017-09-08 13:44:59,820 (main) [WARN - org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:182)] isFileClosed is not available in the version of HDFS being used. Flume will not attempt to close files if the close fails on the first attempt
java.lang.NoSuchMethodException: org.apache.hadoop.fs.LocalFileSystem.isFileClosed(org.apache.hadoop.fs.Path)
	at java.lang.Class.getMethod(Class.java:1786)
	at org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:179)
	at org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:263)
	at org.apache.flume.sink.hdfs.BucketWriter.append(BucketWriter.java:530)
	at org.apache.flume.sink.hdfs.HDFSEventSink.process(HDFSEventSink.java:406)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.testSimpleAppendLocalTime(TestHDFSEventSink.java:591)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:252)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:141)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:189)
	at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:165)
	at org.apache.maven.surefire.booter.ProviderFactory.invokeProvider(ProviderFactory.java:85)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:115)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:75)
2017-09-08 13:44:59,820 (main) [INFO - org.apache.flume.sink.hdfs.HDFSEventSink.stop(HDFSEventSink.java:480)] Closing file:///tmp/flume-test.1504849499707.1/singleBucket/1504849499\FlumeData
2017-09-08 13:44:59,821 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.close(BucketWriter.java:357)] Closing file:///tmp/flume-test.1504849499707.1/singleBucket/1504849499/FlumeData.1504849499729.tmp
2017-09-08 13:44:59,821 (hdfs-HDFSEventSink-2487afda-e12d-4078-87fd-65375302274b-call-runner-5) [INFO - org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:618)] Renaming file:/tmp/flume-test.1504849499707.1/singleBucket/1504849499/FlumeData.1504849499729.tmp to file:/tmp/flume-test.1504849499707.1/singleBucket/1504849499/FlumeData.1504849499729
2017-09-08 13:44:59,823 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:149)] Component type: SINK, name: HDFSEventSink-2487afda-e12d-4078-87fd-65375302274b stopped
2017-09-08 13:44:59,824 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:155)] Shutdown Metric for type: SINK, name: HDFSEventSink-2487afda-e12d-4078-87fd-65375302274b. sink.start.time == 1504849499726
2017-09-08 13:44:59,824 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:161)] Shutdown Metric for type: SINK, name: HDFSEventSink-2487afda-e12d-4078-87fd-65375302274b. sink.stop.time == 1504849499823
2017-09-08 13:44:59,824 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-2487afda-e12d-4078-87fd-65375302274b. sink.batch.complete == 3
2017-09-08 13:44:59,824 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-2487afda-e12d-4078-87fd-65375302274b. sink.batch.empty == 0
2017-09-08 13:44:59,824 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-2487afda-e12d-4078-87fd-65375302274b. sink.batch.underflow == 0
2017-09-08 13:44:59,824 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-2487afda-e12d-4078-87fd-65375302274b. sink.connection.closed.count == 2
2017-09-08 13:44:59,824 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-2487afda-e12d-4078-87fd-65375302274b. sink.connection.creation.count == 2
2017-09-08 13:44:59,825 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-2487afda-e12d-4078-87fd-65375302274b. sink.connection.failed.count == 0
2017-09-08 13:44:59,825 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-2487afda-e12d-4078-87fd-65375302274b. sink.event.drain.attempt == 6
2017-09-08 13:44:59,825 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-2487afda-e12d-4078-87fd-65375302274b. sink.event.drain.sucess == 6
2017-09-08 13:44:59,836 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.verifyOutputSequenceFiles(TestHDFSEventSink.java:777)] Found event body: Test.1.1
2017-09-08 13:44:59,836 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.verifyOutputSequenceFiles(TestHDFSEventSink.java:777)] Found event body: Test.1.2
2017-09-08 13:44:59,836 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.verifyOutputSequenceFiles(TestHDFSEventSink.java:777)] Found event body: Test.2.1
2017-09-08 13:44:59,836 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.verifyOutputSequenceFiles(TestHDFSEventSink.java:777)] Found event body: Test.2.2
2017-09-08 13:44:59,836 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.verifyOutputSequenceFiles(TestHDFSEventSink.java:777)] Found event body: Test.3.1
2017-09-08 13:44:59,838 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.verifyOutputSequenceFiles(TestHDFSEventSink.java:777)] Found event body: Test.3.2
2017-09-08 13:44:59,853 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.setUp(TestHDFSEventSink.java:104)] Starting...
2017-09-08 13:44:59,863 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.testBadSimpleAppend(TestHDFSEventSink.java:676)] Starting...
2017-09-08 13:44:59,871 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.register(MonitoredCounterGroup.java:119)] Monitored counter group for type: SINK, name: null: Successfully registered new MBean.
2017-09-08 13:44:59,871 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.start(MonitoredCounterGroup.java:95)] Component type: SINK, name: null started
2017-09-08 13:44:59,872 (main) [INFO - org.apache.flume.sink.hdfs.HDFSSequenceFile.configure(HDFSSequenceFile.java:63)] writeFormat = Writable, UseRawLocalFileSystem = false
2017-09-08 13:44:59,880 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:231)] Creating file:///tmp/flume-test.1504849499853.1/singleBucket/FlumeData.1504849499873.tmp
2017-09-08 13:44:59,891 (hdfs-null-call-runner-0) [INFO - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetNumCurrentReplicas(AbstractHDFSWriter.java:189)] FileSystem's output stream doesn't support getNumCurrentReplicas; --HDFS-826 not available; fsOut=org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer; err=java.lang.NoSuchMethodException: org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer.getNumCurrentReplicas()
2017-09-08 13:44:59,892 (hdfs-null-call-runner-0) [DEBUG - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetDefaultReplication(AbstractHDFSWriter.java:228)] Using FileSystem.getDefaultReplication(Path) from HADOOP-8014
2017-09-08 13:44:59,892 (main) [WARN - org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:182)] isFileClosed is not available in the version of HDFS being used. Flume will not attempt to close files if the close fails on the first attempt
java.lang.NoSuchMethodException: org.apache.hadoop.fs.LocalFileSystem.isFileClosed(org.apache.hadoop.fs.Path)
	at java.lang.Class.getMethod(Class.java:1786)
	at org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:179)
	at org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:263)
	at org.apache.flume.sink.hdfs.BucketWriter.append(BucketWriter.java:504)
	at org.apache.flume.sink.hdfs.HDFSEventSink.process(HDFSEventSink.java:406)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.testBadSimpleAppend(TestHDFSEventSink.java:739)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:252)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:141)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:189)
	at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:165)
	at org.apache.maven.surefire.booter.ProviderFactory.invokeProvider(ProviderFactory.java:85)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:115)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:75)
2017-09-08 13:44:59,893 (main) [WARN - org.apache.flume.sink.hdfs.BucketWriter.append(BucketWriter.java:545)] Caught IOException writing to HDFSWriter (Injected fault). Closing file (file:///tmp/flume-test.1504849499853.1/singleBucket/FlumeData.1504849499873.tmp) and rethrowing exception.
2017-09-08 13:44:59,893 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.close(BucketWriter.java:357)] Closing file:///tmp/flume-test.1504849499853.1/singleBucket/FlumeData.1504849499873.tmp
2017-09-08 13:44:59,895 (hdfs-null-call-runner-5) [INFO - org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:618)] Renaming file:/tmp/flume-test.1504849499853.1/singleBucket/FlumeData.1504849499873.tmp to file:/tmp/flume-test.1504849499853.1/singleBucket/FlumeData.1504849499873
2017-09-08 13:44:59,897 (main) [INFO - org.apache.flume.sink.hdfs.HDFSEventSink$1.run(HDFSEventSink.java:382)] Writer callback called.
2017-09-08 13:44:59,897 (main) [WARN - org.apache.flume.sink.hdfs.HDFSEventSink.process(HDFSEventSink.java:443)] HDFS IO error
java.io.IOException: Injected fault
	at org.apache.flume.sink.hdfs.HDFSTestSeqWriter.append(HDFSTestSeqWriter.java:54)
	at org.apache.flume.sink.hdfs.BucketWriter$7.call(BucketWriter.java:540)
	at org.apache.flume.sink.hdfs.BucketWriter$7.call(BucketWriter.java:537)
	at org.apache.flume.sink.hdfs.BucketWriter$9$1.run(BucketWriter.java:668)
	at org.apache.flume.auth.SimpleAuthenticator.execute(SimpleAuthenticator.java:50)
	at org.apache.flume.sink.hdfs.BucketWriter$9.call(BucketWriter.java:665)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
2017-09-08 13:44:59,897 (main) [INFO - org.apache.flume.sink.hdfs.TestHDFSEventSink.testBadSimpleAppend(TestHDFSEventSink.java:739)] Process events: BACKOFF
2017-09-08 13:44:59,898 (main) [INFO - org.apache.flume.sink.hdfs.HDFSSequenceFile.configure(HDFSSequenceFile.java:63)] writeFormat = Writable, UseRawLocalFileSystem = false
2017-09-08 13:44:59,912 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:231)] Creating file:///tmp/flume-test.1504849499853.1/singleBucket/FlumeData.1504849499899.tmp
2017-09-08 13:44:59,925 (hdfs-null-call-runner-6) [INFO - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetNumCurrentReplicas(AbstractHDFSWriter.java:189)] FileSystem's output stream doesn't support getNumCurrentReplicas; --HDFS-826 not available; fsOut=org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer; err=java.lang.NoSuchMethodException: org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer.getNumCurrentReplicas()
2017-09-08 13:44:59,926 (hdfs-null-call-runner-6) [DEBUG - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetDefaultReplication(AbstractHDFSWriter.java:228)] Using FileSystem.getDefaultReplication(Path) from HADOOP-8014
2017-09-08 13:44:59,926 (main) [WARN - org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:182)] isFileClosed is not available in the version of HDFS being used. Flume will not attempt to close files if the close fails on the first attempt
java.lang.NoSuchMethodException: org.apache.hadoop.fs.LocalFileSystem.isFileClosed(org.apache.hadoop.fs.Path)
	at java.lang.Class.getMethod(Class.java:1786)
	at org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:179)
	at org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:263)
	at org.apache.flume.sink.hdfs.BucketWriter.append(BucketWriter.java:504)
	at org.apache.flume.sink.hdfs.HDFSEventSink.process(HDFSEventSink.java:406)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.testBadSimpleAppend(TestHDFSEventSink.java:739)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:252)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:141)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:189)
	at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:165)
	at org.apache.maven.surefire.booter.ProviderFactory.invokeProvider(ProviderFactory.java:85)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:115)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:75)
2017-09-08 13:44:59,927 (main) [INFO - org.apache.flume.sink.hdfs.TestHDFSEventSink.testBadSimpleAppend(TestHDFSEventSink.java:739)] Process events: READY
2017-09-08 13:44:59,928 (main) [INFO - org.apache.flume.sink.hdfs.TestHDFSEventSink.testBadSimpleAppend(TestHDFSEventSink.java:739)] Process events: READY
2017-09-08 13:44:59,928 (main) [DEBUG - org.apache.flume.sink.hdfs.BucketWriter.shouldRotate(BucketWriter.java:581)] rolling: rollCount: 5, events: 5
2017-09-08 13:44:59,928 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.close(BucketWriter.java:357)] Closing file:///tmp/flume-test.1504849499853.1/singleBucket/FlumeData.1504849499899.tmp
2017-09-08 13:44:59,929 (hdfs-null-call-runner-6) [INFO - org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:618)] Renaming file:/tmp/flume-test.1504849499853.1/singleBucket/FlumeData.1504849499899.tmp to file:/tmp/flume-test.1504849499853.1/singleBucket/FlumeData.1504849499899
2017-09-08 13:44:59,941 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:231)] Creating file:///tmp/flume-test.1504849499853.1/singleBucket/FlumeData.1504849499900.tmp
2017-09-08 13:44:59,951 (hdfs-null-call-runner-7) [INFO - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetNumCurrentReplicas(AbstractHDFSWriter.java:189)] FileSystem's output stream doesn't support getNumCurrentReplicas; --HDFS-826 not available; fsOut=org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer; err=java.lang.NoSuchMethodException: org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer.getNumCurrentReplicas()
2017-09-08 13:44:59,951 (hdfs-null-call-runner-7) [DEBUG - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetDefaultReplication(AbstractHDFSWriter.java:228)] Using FileSystem.getDefaultReplication(Path) from HADOOP-8014
2017-09-08 13:44:59,951 (main) [WARN - org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:182)] isFileClosed is not available in the version of HDFS being used. Flume will not attempt to close files if the close fails on the first attempt
java.lang.NoSuchMethodException: org.apache.hadoop.fs.LocalFileSystem.isFileClosed(org.apache.hadoop.fs.Path)
	at java.lang.Class.getMethod(Class.java:1786)
	at org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:179)
	at org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:263)
	at org.apache.flume.sink.hdfs.BucketWriter.append(BucketWriter.java:530)
	at org.apache.flume.sink.hdfs.HDFSEventSink.process(HDFSEventSink.java:406)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.testBadSimpleAppend(TestHDFSEventSink.java:741)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:252)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:141)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:189)
	at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:165)
	at org.apache.maven.surefire.booter.ProviderFactory.invokeProvider(ProviderFactory.java:85)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:115)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:75)
2017-09-08 13:44:59,952 (main) [INFO - org.apache.flume.sink.hdfs.TestHDFSEventSink.testBadSimpleAppend(TestHDFSEventSink.java:741)] Process events to end of transaction max: READY
2017-09-08 13:45:02,952 (main) [INFO - org.apache.flume.sink.hdfs.TestHDFSEventSink.testBadSimpleAppend(TestHDFSEventSink.java:742)] Process events to injected fault: BACKOFF
2017-09-08 13:45:05,954 (main) [INFO - org.apache.flume.sink.hdfs.TestHDFSEventSink.testBadSimpleAppend(TestHDFSEventSink.java:743)] Process events remaining events: BACKOFF
2017-09-08 13:45:05,954 (main) [INFO - org.apache.flume.sink.hdfs.HDFSEventSink.stop(HDFSEventSink.java:480)] Closing file:///tmp/flume-test.1504849499853.1/singleBucket\FlumeData
2017-09-08 13:45:05,954 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.close(BucketWriter.java:357)] Closing file:///tmp/flume-test.1504849499853.1/singleBucket/FlumeData.1504849499900.tmp
2017-09-08 13:45:05,955 (hdfs-null-call-runner-1) [INFO - org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:618)] Renaming file:/tmp/flume-test.1504849499853.1/singleBucket/FlumeData.1504849499900.tmp to file:/tmp/flume-test.1504849499853.1/singleBucket/FlumeData.1504849499900
2017-09-08 13:45:05,960 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:149)] Component type: SINK, name: null stopped
2017-09-08 13:45:05,960 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:155)] Shutdown Metric for type: SINK, name: null. sink.start.time == 1504849499871
2017-09-08 13:45:05,960 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:161)] Shutdown Metric for type: SINK, name: null. sink.stop.time == 1504849505959
2017-09-08 13:45:05,960 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: null. sink.batch.complete == 3
2017-09-08 13:45:05,960 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: null. sink.batch.empty == 2
2017-09-08 13:45:05,960 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: null. sink.batch.underflow == 0
2017-09-08 13:45:05,961 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: null. sink.connection.closed.count == 3
2017-09-08 13:45:05,961 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: null. sink.connection.creation.count == 3
2017-09-08 13:45:05,961 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: null. sink.connection.failed.count == 1
2017-09-08 13:45:05,961 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: null. sink.event.drain.attempt == 8
2017-09-08 13:45:05,961 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: null. sink.event.drain.sucess == 6
2017-09-08 13:45:05,963 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.verifyOutputSequenceFiles(TestHDFSEventSink.java:777)] Found event body: Test.1.1
2017-09-08 13:45:05,965 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.verifyOutputSequenceFiles(TestHDFSEventSink.java:777)] Found event body: Test.1.2
2017-09-08 13:45:05,965 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.verifyOutputSequenceFiles(TestHDFSEventSink.java:777)] Found event body: Test.2.1
2017-09-08 13:45:05,966 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.verifyOutputSequenceFiles(TestHDFSEventSink.java:777)] Found event body: Test.2.2
2017-09-08 13:45:05,966 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.verifyOutputSequenceFiles(TestHDFSEventSink.java:777)] Found event body: Test.3.1
2017-09-08 13:45:05,968 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.verifyOutputSequenceFiles(TestHDFSEventSink.java:777)] Found event body: Test.3.2
2017-09-08 13:45:05,987 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.setUp(TestHDFSEventSink.java:104)] Starting...
2017-09-08 13:45:06,002 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.testCloseRemovesFromSFWriters(TestHDFSEventSink.java:1016)] Starting...
2017-09-08 13:45:06,017 (main) [DEBUG - org.apache.flume.instrumentation.MonitoredCounterGroup.register(MonitoredCounterGroup.java:111)] Monitored counter group for type: SINK, name: null: Another MBean is already registered with this name. Unregistering that pre-existing MBean now...
2017-09-08 13:45:06,018 (main) [DEBUG - org.apache.flume.instrumentation.MonitoredCounterGroup.register(MonitoredCounterGroup.java:115)] Monitored counter group for type: SINK, name: null: Successfully unregistered pre-existing MBean.
2017-09-08 13:45:06,018 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.register(MonitoredCounterGroup.java:119)] Monitored counter group for type: SINK, name: null: Successfully registered new MBean.
2017-09-08 13:45:06,018 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.start(MonitoredCounterGroup.java:95)] Component type: SINK, name: null started
2017-09-08 13:45:06,019 (main) [INFO - org.apache.flume.sink.hdfs.HDFSSequenceFile.configure(HDFSSequenceFile.java:63)] writeFormat = Writable, UseRawLocalFileSystem = false
2017-09-08 13:45:06,031 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:231)] Creating file:///tmp/flume-test.1504849505988.1/singleBucket/FlumeData.1504849506020.tmp
2017-09-08 13:45:06,048 (hdfs-null-call-runner-0) [INFO - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetNumCurrentReplicas(AbstractHDFSWriter.java:189)] FileSystem's output stream doesn't support getNumCurrentReplicas; --HDFS-826 not available; fsOut=org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer; err=java.lang.NoSuchMethodException: org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer.getNumCurrentReplicas()
2017-09-08 13:45:06,048 (hdfs-null-call-runner-0) [DEBUG - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetDefaultReplication(AbstractHDFSWriter.java:228)] Using FileSystem.getDefaultReplication(Path) from HADOOP-8014
2017-09-08 13:45:06,048 (main) [WARN - org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:182)] isFileClosed is not available in the version of HDFS being used. Flume will not attempt to close files if the close fails on the first attempt
java.lang.NoSuchMethodException: org.apache.hadoop.fs.LocalFileSystem.isFileClosed(org.apache.hadoop.fs.Path)
	at java.lang.Class.getMethod(Class.java:1786)
	at org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:179)
	at org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:263)
	at org.apache.flume.sink.hdfs.BucketWriter.append(BucketWriter.java:504)
	at org.apache.flume.sink.hdfs.HDFSEventSink.process(HDFSEventSink.java:406)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.testCloseRemovesFromSFWriters(TestHDFSEventSink.java:1074)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:252)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:141)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:189)
	at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:165)
	at org.apache.maven.surefire.booter.ProviderFactory.invokeProvider(ProviderFactory.java:85)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:115)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:75)
2017-09-08 13:45:06,050 (main) [INFO - org.apache.flume.sink.hdfs.TestHDFSEventSink.testCloseRemovesFromSFWriters(TestHDFSEventSink.java:1074)] execute sink to process the events: READY
2017-09-08 13:45:06,062 (main) [WARN - org.apache.hadoop.fs.FileUtil.deleteImpl(FileUtil.java:187)] Failed to delete file or dir [E:\tmp\flume-test.1504849505988.1\singleBucket\.FlumeData.1504849506020.tmp.crc]: it still exists.
2017-09-08 13:45:06,063 (main) [WARN - org.apache.hadoop.fs.FileUtil.deleteImpl(FileUtil.java:187)] Failed to delete file or dir [E:\tmp\flume-test.1504849505988.1\singleBucket\FlumeData.1504849506020.tmp]: it still exists.
2017-09-08 13:45:06,065 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.setUp(TestHDFSEventSink.java:104)] Starting...
2017-09-08 13:45:06,077 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.testSlowAppendFailure(TestHDFSEventSink.java:1101)] Starting...
2017-09-08 13:45:06,089 (main) [DEBUG - org.apache.flume.instrumentation.MonitoredCounterGroup.register(MonitoredCounterGroup.java:111)] Monitored counter group for type: SINK, name: null: Another MBean is already registered with this name. Unregistering that pre-existing MBean now...
2017-09-08 13:45:06,089 (main) [DEBUG - org.apache.flume.instrumentation.MonitoredCounterGroup.register(MonitoredCounterGroup.java:115)] Monitored counter group for type: SINK, name: null: Successfully unregistered pre-existing MBean.
2017-09-08 13:45:06,089 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.register(MonitoredCounterGroup.java:119)] Monitored counter group for type: SINK, name: null: Successfully registered new MBean.
2017-09-08 13:45:06,090 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.start(MonitoredCounterGroup.java:95)] Component type: SINK, name: null started
2017-09-08 13:45:06,090 (main) [INFO - org.apache.flume.sink.hdfs.HDFSSequenceFile.configure(HDFSSequenceFile.java:63)] writeFormat = Writable, UseRawLocalFileSystem = false
2017-09-08 13:45:06,100 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:231)] Creating file:///tmp/flume-test.1504849506066.1/singleBucket/FlumeData.1504849506091.tmp
2017-09-08 13:45:06,114 (hdfs-null-call-runner-0) [INFO - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetNumCurrentReplicas(AbstractHDFSWriter.java:189)] FileSystem's output stream doesn't support getNumCurrentReplicas; --HDFS-826 not available; fsOut=org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer; err=java.lang.NoSuchMethodException: org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer.getNumCurrentReplicas()
2017-09-08 13:45:06,114 (hdfs-null-call-runner-0) [DEBUG - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetDefaultReplication(AbstractHDFSWriter.java:228)] Using FileSystem.getDefaultReplication(Path) from HADOOP-8014
2017-09-08 13:45:06,114 (main) [WARN - org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:182)] isFileClosed is not available in the version of HDFS being used. Flume will not attempt to close files if the close fails on the first attempt
java.lang.NoSuchMethodException: org.apache.hadoop.fs.LocalFileSystem.isFileClosed(org.apache.hadoop.fs.Path)
	at java.lang.Class.getMethod(Class.java:1786)
	at org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:179)
	at org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:263)
	at org.apache.flume.sink.hdfs.BucketWriter.append(BucketWriter.java:504)
	at org.apache.flume.sink.hdfs.HDFSEventSink.process(HDFSEventSink.java:406)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.testSlowAppendFailure(TestHDFSEventSink.java:1156)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:252)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:141)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:189)
	at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:165)
	at org.apache.maven.surefire.booter.ProviderFactory.invokeProvider(ProviderFactory.java:85)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:115)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:75)
2017-09-08 13:45:07,049 (hdfs-null-roll-timer-0) [DEBUG - org.apache.flume.sink.hdfs.BucketWriter$2.call(BucketWriter.java:271)] Rolling file (file:///tmp/flume-test.1504849505988.1/singleBucket/FlumeData.1504849506020.tmp): Roll scheduled after 1 sec elapsed.
2017-09-08 13:45:07,050 (hdfs-null-roll-timer-0) [INFO - org.apache.flume.sink.hdfs.BucketWriter.close(BucketWriter.java:357)] Closing file:///tmp/flume-test.1504849505988.1/singleBucket/FlumeData.1504849506020.tmp
2017-09-08 13:45:07,052 (hdfs-null-call-runner-5) [INFO - org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:618)] Renaming file:/tmp/flume-test.1504849505988.1/singleBucket/FlumeData.1504849506020.tmp to file:/tmp/flume-test.1504849505988.1/singleBucket/FlumeData.1504849506020
2017-09-08 13:45:07,053 (hdfs-null-roll-timer-0) [INFO - org.apache.flume.sink.hdfs.HDFSEventSink$1.run(HDFSEventSink.java:382)] Writer callback called.
2017-09-08 13:45:07,115 (main) [WARN - org.apache.flume.sink.hdfs.BucketWriter.append(BucketWriter.java:545)] Caught IOException writing to HDFSWriter (Callable timed out after 1000 ms on file: file:///tmp/flume-test.1504849506066.1/singleBucket/FlumeData.1504849506091.tmp). Closing file (file:///tmp/flume-test.1504849506066.1/singleBucket/FlumeData.1504849506091.tmp) and rethrowing exception.
2017-09-08 13:45:07,115 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.close(BucketWriter.java:357)] Closing file:///tmp/flume-test.1504849506066.1/singleBucket/FlumeData.1504849506091.tmp
2017-09-08 13:45:07,118 (hdfs-null-call-runner-3) [INFO - org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:618)] Renaming file:/tmp/flume-test.1504849506066.1/singleBucket/FlumeData.1504849506091.tmp to file:/tmp/flume-test.1504849506066.1/singleBucket/FlumeData.1504849506091
2017-09-08 13:45:07,119 (main) [INFO - org.apache.flume.sink.hdfs.HDFSEventSink$1.run(HDFSEventSink.java:382)] Writer callback called.
2017-09-08 13:45:07,120 (main) [WARN - org.apache.flume.sink.hdfs.HDFSEventSink.process(HDFSEventSink.java:443)] HDFS IO error
java.io.IOException: Callable timed out after 1000 ms on file: file:///tmp/flume-test.1504849506066.1/singleBucket/FlumeData.1504849506091.tmp
	at org.apache.flume.sink.hdfs.BucketWriter.callWithTimeout(BucketWriter.java:682)
	at org.apache.flume.sink.hdfs.BucketWriter.append(BucketWriter.java:537)
	at org.apache.flume.sink.hdfs.HDFSEventSink.process(HDFSEventSink.java:406)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.testSlowAppendFailure(TestHDFSEventSink.java:1156)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:252)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:141)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:189)
	at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:165)
	at org.apache.maven.surefire.booter.ProviderFactory.invokeProvider(ProviderFactory.java:85)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:115)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:75)
Caused by: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.get(FutureTask.java:205)
	at org.apache.flume.sink.hdfs.BucketWriter.callWithTimeout(BucketWriter.java:675)
	... 34 more
2017-09-08 13:45:07,120 (main) [INFO - org.apache.flume.sink.hdfs.HDFSSequenceFile.configure(HDFSSequenceFile.java:63)] writeFormat = Writable, UseRawLocalFileSystem = false
2017-09-08 13:45:07,129 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:231)] Creating file:///tmp/flume-test.1504849506066.1/singleBucket/FlumeData.1504849507121.tmp
2017-09-08 13:45:07,140 (hdfs-null-call-runner-4) [INFO - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetNumCurrentReplicas(AbstractHDFSWriter.java:189)] FileSystem's output stream doesn't support getNumCurrentReplicas; --HDFS-826 not available; fsOut=org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer; err=java.lang.NoSuchMethodException: org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer.getNumCurrentReplicas()
2017-09-08 13:45:07,140 (hdfs-null-call-runner-4) [DEBUG - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetDefaultReplication(AbstractHDFSWriter.java:228)] Using FileSystem.getDefaultReplication(Path) from HADOOP-8014
2017-09-08 13:45:07,140 (main) [WARN - org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:182)] isFileClosed is not available in the version of HDFS being used. Flume will not attempt to close files if the close fails on the first attempt
java.lang.NoSuchMethodException: org.apache.hadoop.fs.LocalFileSystem.isFileClosed(org.apache.hadoop.fs.Path)
	at java.lang.Class.getMethod(Class.java:1786)
	at org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:179)
	at org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:263)
	at org.apache.flume.sink.hdfs.BucketWriter.append(BucketWriter.java:504)
	at org.apache.flume.sink.hdfs.HDFSEventSink.process(HDFSEventSink.java:406)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.testSlowAppendFailure(TestHDFSEventSink.java:1156)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:252)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:141)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:189)
	at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:165)
	at org.apache.maven.surefire.booter.ProviderFactory.invokeProvider(ProviderFactory.java:85)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:115)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:75)
2017-09-08 13:45:08,141 (main) [WARN - org.apache.flume.sink.hdfs.BucketWriter.append(BucketWriter.java:545)] Caught IOException writing to HDFSWriter (Callable timed out after 1000 ms on file: file:///tmp/flume-test.1504849506066.1/singleBucket/FlumeData.1504849507121.tmp). Closing file (file:///tmp/flume-test.1504849506066.1/singleBucket/FlumeData.1504849507121.tmp) and rethrowing exception.
2017-09-08 13:45:08,141 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.close(BucketWriter.java:357)] Closing file:///tmp/flume-test.1504849506066.1/singleBucket/FlumeData.1504849507121.tmp
2017-09-08 13:45:08,144 (hdfs-null-call-runner-7) [INFO - org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:618)] Renaming file:/tmp/flume-test.1504849506066.1/singleBucket/FlumeData.1504849507121.tmp to file:/tmp/flume-test.1504849506066.1/singleBucket/FlumeData.1504849507121
2017-09-08 13:45:08,146 (main) [INFO - org.apache.flume.sink.hdfs.HDFSEventSink$1.run(HDFSEventSink.java:382)] Writer callback called.
2017-09-08 13:45:08,146 (main) [WARN - org.apache.flume.sink.hdfs.HDFSEventSink.process(HDFSEventSink.java:443)] HDFS IO error
java.io.IOException: Callable timed out after 1000 ms on file: file:///tmp/flume-test.1504849506066.1/singleBucket/FlumeData.1504849507121.tmp
	at org.apache.flume.sink.hdfs.BucketWriter.callWithTimeout(BucketWriter.java:682)
	at org.apache.flume.sink.hdfs.BucketWriter.append(BucketWriter.java:537)
	at org.apache.flume.sink.hdfs.HDFSEventSink.process(HDFSEventSink.java:406)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.testSlowAppendFailure(TestHDFSEventSink.java:1156)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:252)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:141)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:189)
	at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:165)
	at org.apache.maven.surefire.booter.ProviderFactory.invokeProvider(ProviderFactory.java:85)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:115)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:75)
Caused by: java.util.concurrent.TimeoutException
	at java.util.concurrent.FutureTask.get(FutureTask.java:205)
	at org.apache.flume.sink.hdfs.BucketWriter.callWithTimeout(BucketWriter.java:675)
	... 34 more
2017-09-08 13:45:08,149 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:149)] Component type: SINK, name: null stopped
2017-09-08 13:45:08,149 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:155)] Shutdown Metric for type: SINK, name: null. sink.start.time == 1504849506090
2017-09-08 13:45:08,150 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:161)] Shutdown Metric for type: SINK, name: null. sink.stop.time == 1504849508149
2017-09-08 13:45:08,150 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: null. sink.batch.complete == 0
2017-09-08 13:45:08,150 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: null. sink.batch.empty == 0
2017-09-08 13:45:08,150 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: null. sink.batch.underflow == 0
2017-09-08 13:45:08,150 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: null. sink.connection.closed.count == 2
2017-09-08 13:45:08,150 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: null. sink.connection.creation.count == 2
2017-09-08 13:45:08,151 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: null. sink.connection.failed.count == 2
2017-09-08 13:45:08,151 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: null. sink.event.drain.attempt == 2
2017-09-08 13:45:08,151 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: null. sink.event.drain.sucess == 0
2017-09-08 13:45:08,172 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.setUp(TestHDFSEventSink.java:104)] Starting...
2017-09-08 13:45:08,185 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.testCloseReopenOnRollTime(TestHDFSEventSink.java:933)] Starting...
2017-09-08 13:45:08,194 (main) [DEBUG - org.apache.flume.instrumentation.MonitoredCounterGroup.register(MonitoredCounterGroup.java:111)] Monitored counter group for type: SINK, name: null: Another MBean is already registered with this name. Unregistering that pre-existing MBean now...
2017-09-08 13:45:08,194 (main) [DEBUG - org.apache.flume.instrumentation.MonitoredCounterGroup.register(MonitoredCounterGroup.java:115)] Monitored counter group for type: SINK, name: null: Successfully unregistered pre-existing MBean.
2017-09-08 13:45:08,194 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.register(MonitoredCounterGroup.java:119)] Monitored counter group for type: SINK, name: null: Successfully registered new MBean.
2017-09-08 13:45:08,194 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.start(MonitoredCounterGroup.java:95)] Component type: SINK, name: null started
2017-09-08 13:45:08,195 (main) [INFO - org.apache.flume.sink.hdfs.HDFSSequenceFile.configure(HDFSSequenceFile.java:63)] writeFormat = Writable, UseRawLocalFileSystem = false
2017-09-08 13:45:08,203 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:231)] Creating file:///tmp/flume-test.1504849508172.1/singleBucket/FlumeData.1504849508196.tmp
2017-09-08 13:45:08,215 (hdfs-null-call-runner-0) [INFO - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetNumCurrentReplicas(AbstractHDFSWriter.java:189)] FileSystem's output stream doesn't support getNumCurrentReplicas; --HDFS-826 not available; fsOut=org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer; err=java.lang.NoSuchMethodException: org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer.getNumCurrentReplicas()
2017-09-08 13:45:08,215 (hdfs-null-call-runner-0) [DEBUG - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetDefaultReplication(AbstractHDFSWriter.java:228)] Using FileSystem.getDefaultReplication(Path) from HADOOP-8014
2017-09-08 13:45:08,215 (main) [WARN - org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:182)] isFileClosed is not available in the version of HDFS being used. Flume will not attempt to close files if the close fails on the first attempt
java.lang.NoSuchMethodException: org.apache.hadoop.fs.LocalFileSystem.isFileClosed(org.apache.hadoop.fs.Path)
	at java.lang.Class.getMethod(Class.java:1786)
	at org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:179)
	at org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:263)
	at org.apache.flume.sink.hdfs.BucketWriter.append(BucketWriter.java:504)
	at org.apache.flume.sink.hdfs.HDFSEventSink.process(HDFSEventSink.java:406)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.testCloseReopenOnRollTime(TestHDFSEventSink.java:992)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:252)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:141)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:189)
	at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:165)
	at org.apache.maven.surefire.booter.ProviderFactory.invokeProvider(ProviderFactory.java:85)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:115)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:75)
2017-09-08 13:45:08,218 (main) [INFO - org.apache.flume.sink.hdfs.TestHDFSEventSink.testCloseReopenOnRollTime(TestHDFSEventSink.java:992)] execute sink to process the events: READY
2017-09-08 13:45:10,217 (hdfs-null-roll-timer-0) [DEBUG - org.apache.flume.sink.hdfs.BucketWriter$2.call(BucketWriter.java:271)] Rolling file (file:///tmp/flume-test.1504849508172.1/singleBucket/FlumeData.1504849508196.tmp): Roll scheduled after 2 sec elapsed.
2017-09-08 13:45:10,217 (hdfs-null-roll-timer-0) [INFO - org.apache.flume.sink.hdfs.BucketWriter.close(BucketWriter.java:357)] Closing file:///tmp/flume-test.1504849508172.1/singleBucket/FlumeData.1504849508196.tmp
2017-09-08 13:45:10,221 (hdfs-null-call-runner-5) [INFO - org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:618)] Renaming file:/tmp/flume-test.1504849508172.1/singleBucket/FlumeData.1504849508196.tmp to file:/tmp/flume-test.1504849508172.1/singleBucket/FlumeData.1504849508196
2017-09-08 13:45:10,225 (hdfs-null-roll-timer-0) [INFO - org.apache.flume.sink.hdfs.HDFSEventSink$1.run(HDFSEventSink.java:382)] Writer callback called.
2017-09-08 13:45:10,226 (main) [INFO - org.apache.flume.sink.hdfs.HDFSEventSink.process(HDFSEventSink.java:408)] Bucket was closed while trying to append, reinitializing bucket and writing event.
2017-09-08 13:45:10,226 (main) [INFO - org.apache.flume.sink.hdfs.HDFSSequenceFile.configure(HDFSSequenceFile.java:63)] writeFormat = Writable, UseRawLocalFileSystem = false
2017-09-08 13:45:10,253 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:231)] Creating file:///tmp/flume-test.1504849508172.1/singleBucket/FlumeData.1504849510227.tmp
2017-09-08 13:45:10,281 (hdfs-null-call-runner-6) [INFO - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetNumCurrentReplicas(AbstractHDFSWriter.java:189)] FileSystem's output stream doesn't support getNumCurrentReplicas; --HDFS-826 not available; fsOut=org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer; err=java.lang.NoSuchMethodException: org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer.getNumCurrentReplicas()
2017-09-08 13:45:10,281 (hdfs-null-call-runner-6) [DEBUG - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetDefaultReplication(AbstractHDFSWriter.java:228)] Using FileSystem.getDefaultReplication(Path) from HADOOP-8014
2017-09-08 13:45:10,281 (main) [WARN - org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:182)] isFileClosed is not available in the version of HDFS being used. Flume will not attempt to close files if the close fails on the first attempt
java.lang.NoSuchMethodException: org.apache.hadoop.fs.LocalFileSystem.isFileClosed(org.apache.hadoop.fs.Path)
	at java.lang.Class.getMethod(Class.java:1786)
	at org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:179)
	at org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:263)
	at org.apache.flume.sink.hdfs.BucketWriter.append(BucketWriter.java:504)
	at org.apache.flume.sink.hdfs.HDFSEventSink.process(HDFSEventSink.java:416)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.testCloseReopenOnRollTime(TestHDFSEventSink.java:992)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:252)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:141)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:189)
	at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:165)
	at org.apache.maven.surefire.booter.ProviderFactory.invokeProvider(ProviderFactory.java:85)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:115)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:75)
2017-09-08 13:45:10,285 (main) [INFO - org.apache.flume.sink.hdfs.TestHDFSEventSink.testCloseReopenOnRollTime(TestHDFSEventSink.java:992)] execute sink to process the events: READY
2017-09-08 13:45:10,286 (main) [INFO - org.apache.flume.sink.hdfs.TestHDFSEventSink.testCloseReopenOnRollTime(TestHDFSEventSink.java:992)] execute sink to process the events: READY
2017-09-08 13:45:12,283 (hdfs-null-roll-timer-0) [DEBUG - org.apache.flume.sink.hdfs.BucketWriter$2.call(BucketWriter.java:271)] Rolling file (file:///tmp/flume-test.1504849508172.1/singleBucket/FlumeData.1504849510227.tmp): Roll scheduled after 2 sec elapsed.
2017-09-08 13:45:12,283 (hdfs-null-roll-timer-0) [INFO - org.apache.flume.sink.hdfs.BucketWriter.close(BucketWriter.java:357)] Closing file:///tmp/flume-test.1504849508172.1/singleBucket/FlumeData.1504849510227.tmp
2017-09-08 13:45:12,286 (hdfs-null-call-runner-4) [INFO - org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:618)] Renaming file:/tmp/flume-test.1504849508172.1/singleBucket/FlumeData.1504849510227.tmp to file:/tmp/flume-test.1504849508172.1/singleBucket/FlumeData.1504849510227
2017-09-08 13:45:12,290 (hdfs-null-roll-timer-0) [INFO - org.apache.flume.sink.hdfs.HDFSEventSink$1.run(HDFSEventSink.java:382)] Writer callback called.
2017-09-08 13:45:13,286 (main) [INFO - org.apache.flume.sink.hdfs.TestHDFSEventSink.testCloseReopenOnRollTime(TestHDFSEventSink.java:998)] clear any events pending due to errors: BACKOFF
2017-09-08 13:45:13,289 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:149)] Component type: SINK, name: null stopped
2017-09-08 13:45:13,290 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:155)] Shutdown Metric for type: SINK, name: null. sink.start.time == 1504849508194
2017-09-08 13:45:13,291 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:161)] Shutdown Metric for type: SINK, name: null. sink.stop.time == 1504849513289
2017-09-08 13:45:13,291 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: null. sink.batch.complete == 3
2017-09-08 13:45:13,291 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: null. sink.batch.empty == 1
2017-09-08 13:45:13,291 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: null. sink.batch.underflow == 0
2017-09-08 13:45:13,292 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: null. sink.connection.closed.count == 2
2017-09-08 13:45:13,292 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: null. sink.connection.creation.count == 2
2017-09-08 13:45:13,292 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: null. sink.connection.failed.count == 0
2017-09-08 13:45:13,292 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: null. sink.event.drain.attempt == 6
2017-09-08 13:45:13,293 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: null. sink.event.drain.sucess == 6
2017-09-08 13:45:13,293 (main) [INFO - org.apache.flume.sink.hdfs.TestHDFSEventSink.testCloseReopenOnRollTime(TestHDFSEventSink.java:1002)] Total number of bucket writers opened: 2
2017-09-08 13:45:13,298 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.verifyOutputSequenceFiles(TestHDFSEventSink.java:777)] Found event body: Test.1.1
2017-09-08 13:45:13,298 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.verifyOutputSequenceFiles(TestHDFSEventSink.java:777)] Found event body: Test.1.2
2017-09-08 13:45:13,301 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.verifyOutputSequenceFiles(TestHDFSEventSink.java:777)] Found event body: Test.2.1
2017-09-08 13:45:13,302 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.verifyOutputSequenceFiles(TestHDFSEventSink.java:777)] Found event body: Test.2.2
2017-09-08 13:45:13,302 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.verifyOutputSequenceFiles(TestHDFSEventSink.java:777)] Found event body: Test.3.1
2017-09-08 13:45:13,303 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.verifyOutputSequenceFiles(TestHDFSEventSink.java:777)] Found event body: Test.3.2
2017-09-08 13:45:13,345 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.setUp(TestHDFSEventSink.java:104)] Starting...
2017-09-08 13:45:13,358 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.testSlowAppendWithLongTimeout(TestHDFSEventSink.java:1255)] Starting...
2017-09-08 13:45:13,367 (main) [DEBUG - org.apache.flume.instrumentation.MonitoredCounterGroup.register(MonitoredCounterGroup.java:111)] Monitored counter group for type: SINK, name: null: Another MBean is already registered with this name. Unregistering that pre-existing MBean now...
2017-09-08 13:45:13,368 (main) [DEBUG - org.apache.flume.instrumentation.MonitoredCounterGroup.register(MonitoredCounterGroup.java:115)] Monitored counter group for type: SINK, name: null: Successfully unregistered pre-existing MBean.
2017-09-08 13:45:13,368 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.register(MonitoredCounterGroup.java:119)] Monitored counter group for type: SINK, name: null: Successfully registered new MBean.
2017-09-08 13:45:13,368 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.start(MonitoredCounterGroup.java:95)] Component type: SINK, name: null started
2017-09-08 13:45:13,368 (main) [INFO - org.apache.flume.sink.hdfs.HDFSSequenceFile.configure(HDFSSequenceFile.java:63)] writeFormat = Writable, UseRawLocalFileSystem = false
2017-09-08 13:45:13,374 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:231)] Creating file:///tmp/flume-test.1504849513345.1/singleBucket/FlumeData.1504849513369.tmp
2017-09-08 13:45:13,385 (hdfs-null-call-runner-0) [INFO - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetNumCurrentReplicas(AbstractHDFSWriter.java:189)] FileSystem's output stream doesn't support getNumCurrentReplicas; --HDFS-826 not available; fsOut=org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer; err=java.lang.NoSuchMethodException: org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer.getNumCurrentReplicas()
2017-09-08 13:45:13,385 (hdfs-null-call-runner-0) [DEBUG - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetDefaultReplication(AbstractHDFSWriter.java:228)] Using FileSystem.getDefaultReplication(Path) from HADOOP-8014
2017-09-08 13:45:13,385 (main) [WARN - org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:182)] isFileClosed is not available in the version of HDFS being used. Flume will not attempt to close files if the close fails on the first attempt
java.lang.NoSuchMethodException: org.apache.hadoop.fs.LocalFileSystem.isFileClosed(org.apache.hadoop.fs.Path)
	at java.lang.Class.getMethod(Class.java:1786)
	at org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:179)
	at org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:263)
	at org.apache.flume.sink.hdfs.BucketWriter.append(BucketWriter.java:504)
	at org.apache.flume.sink.hdfs.HDFSEventSink.process(HDFSEventSink.java:406)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.slowAppendTestHelper(TestHDFSEventSink.java:1230)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.testSlowAppendWithLongTimeout(TestHDFSEventSink.java:1256)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:252)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:141)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:189)
	at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:165)
	at org.apache.maven.surefire.booter.ProviderFactory.invokeProvider(ProviderFactory.java:85)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:115)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:75)
2017-09-08 13:45:19,393 (main) [INFO - org.apache.flume.sink.hdfs.HDFSEventSink.stop(HDFSEventSink.java:480)] Closing file:///tmp/flume-test.1504849513345.1/singleBucket\FlumeData
2017-09-08 13:45:19,393 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.close(BucketWriter.java:357)] Closing file:///tmp/flume-test.1504849513345.1/singleBucket/FlumeData.1504849513369.tmp
2017-09-08 13:45:19,397 (hdfs-null-call-runner-8) [INFO - org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:618)] Renaming file:/tmp/flume-test.1504849513345.1/singleBucket/FlumeData.1504849513369.tmp to file:/tmp/flume-test.1504849513345.1/singleBucket/FlumeData.1504849513369
2017-09-08 13:45:19,404 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:149)] Component type: SINK, name: null stopped
2017-09-08 13:45:19,405 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:155)] Shutdown Metric for type: SINK, name: null. sink.start.time == 1504849513368
2017-09-08 13:45:19,406 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:161)] Shutdown Metric for type: SINK, name: null. sink.stop.time == 1504849519404
2017-09-08 13:45:19,406 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: null. sink.batch.complete == 2
2017-09-08 13:45:19,406 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: null. sink.batch.empty == 0
2017-09-08 13:45:19,407 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: null. sink.batch.underflow == 0
2017-09-08 13:45:19,407 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: null. sink.connection.closed.count == 1
2017-09-08 13:45:19,407 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: null. sink.connection.creation.count == 1
2017-09-08 13:45:19,407 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: null. sink.connection.failed.count == 0
2017-09-08 13:45:19,408 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: null. sink.event.drain.attempt == 4
2017-09-08 13:45:19,408 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: null. sink.event.drain.sucess == 4
2017-09-08 13:45:19,414 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.verifyOutputSequenceFiles(TestHDFSEventSink.java:777)] Found event body: Test.0.1
2017-09-08 13:45:19,414 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.verifyOutputSequenceFiles(TestHDFSEventSink.java:777)] Found event body: Test.0.2
2017-09-08 13:45:19,415 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.verifyOutputSequenceFiles(TestHDFSEventSink.java:777)] Found event body: Test.1.1
2017-09-08 13:45:19,415 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.verifyOutputSequenceFiles(TestHDFSEventSink.java:777)] Found event body: Test.1.2
2017-09-08 13:45:19,438 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.setUp(TestHDFSEventSink.java:104)] Starting...
2017-09-08 13:45:19,452 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.testSlowAppendWithoutTimeout(TestHDFSEventSink.java:1266)] Starting...
2017-09-08 13:45:19,462 (main) [DEBUG - org.apache.flume.instrumentation.MonitoredCounterGroup.register(MonitoredCounterGroup.java:111)] Monitored counter group for type: SINK, name: null: Another MBean is already registered with this name. Unregistering that pre-existing MBean now...
2017-09-08 13:45:19,462 (main) [DEBUG - org.apache.flume.instrumentation.MonitoredCounterGroup.register(MonitoredCounterGroup.java:115)] Monitored counter group for type: SINK, name: null: Successfully unregistered pre-existing MBean.
2017-09-08 13:45:19,462 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.register(MonitoredCounterGroup.java:119)] Monitored counter group for type: SINK, name: null: Successfully registered new MBean.
2017-09-08 13:45:19,462 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.start(MonitoredCounterGroup.java:95)] Component type: SINK, name: null started
2017-09-08 13:45:19,462 (main) [INFO - org.apache.flume.sink.hdfs.HDFSSequenceFile.configure(HDFSSequenceFile.java:63)] writeFormat = Writable, UseRawLocalFileSystem = false
2017-09-08 13:45:19,470 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:231)] Creating file:///tmp/flume-test.1504849519438.1/singleBucket/FlumeData.1504849519463.tmp
2017-09-08 13:45:19,480 (hdfs-null-call-runner-0) [INFO - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetNumCurrentReplicas(AbstractHDFSWriter.java:189)] FileSystem's output stream doesn't support getNumCurrentReplicas; --HDFS-826 not available; fsOut=org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer; err=java.lang.NoSuchMethodException: org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer.getNumCurrentReplicas()
2017-09-08 13:45:19,480 (hdfs-null-call-runner-0) [DEBUG - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetDefaultReplication(AbstractHDFSWriter.java:228)] Using FileSystem.getDefaultReplication(Path) from HADOOP-8014
2017-09-08 13:45:19,480 (main) [WARN - org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:182)] isFileClosed is not available in the version of HDFS being used. Flume will not attempt to close files if the close fails on the first attempt
java.lang.NoSuchMethodException: org.apache.hadoop.fs.LocalFileSystem.isFileClosed(org.apache.hadoop.fs.Path)
	at java.lang.Class.getMethod(Class.java:1786)
	at org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:179)
	at org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:263)
	at org.apache.flume.sink.hdfs.BucketWriter.append(BucketWriter.java:504)
	at org.apache.flume.sink.hdfs.HDFSEventSink.process(HDFSEventSink.java:406)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.slowAppendTestHelper(TestHDFSEventSink.java:1230)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.testSlowAppendWithoutTimeout(TestHDFSEventSink.java:1267)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:252)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:141)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:189)
	at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:165)
	at org.apache.maven.surefire.booter.ProviderFactory.invokeProvider(ProviderFactory.java:85)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:115)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:75)
2017-09-08 13:45:25,487 (main) [INFO - org.apache.flume.sink.hdfs.HDFSEventSink.stop(HDFSEventSink.java:480)] Closing file:///tmp/flume-test.1504849519438.1/singleBucket\FlumeData
2017-09-08 13:45:25,488 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.close(BucketWriter.java:357)] Closing file:///tmp/flume-test.1504849519438.1/singleBucket/FlumeData.1504849519463.tmp
2017-09-08 13:45:25,490 (hdfs-null-call-runner-8) [INFO - org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:618)] Renaming file:/tmp/flume-test.1504849519438.1/singleBucket/FlumeData.1504849519463.tmp to file:/tmp/flume-test.1504849519438.1/singleBucket/FlumeData.1504849519463
2017-09-08 13:45:25,496 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:149)] Component type: SINK, name: null stopped
2017-09-08 13:45:25,497 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:155)] Shutdown Metric for type: SINK, name: null. sink.start.time == 1504849519462
2017-09-08 13:45:25,497 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:161)] Shutdown Metric for type: SINK, name: null. sink.stop.time == 1504849525496
2017-09-08 13:45:25,497 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: null. sink.batch.complete == 2
2017-09-08 13:45:25,497 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: null. sink.batch.empty == 0
2017-09-08 13:45:25,498 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: null. sink.batch.underflow == 0
2017-09-08 13:45:25,498 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: null. sink.connection.closed.count == 1
2017-09-08 13:45:25,498 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: null. sink.connection.creation.count == 1
2017-09-08 13:45:25,498 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: null. sink.connection.failed.count == 0
2017-09-08 13:45:25,498 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: null. sink.event.drain.attempt == 4
2017-09-08 13:45:25,499 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: null. sink.event.drain.sucess == 4
2017-09-08 13:45:25,502 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.verifyOutputSequenceFiles(TestHDFSEventSink.java:777)] Found event body: Test.0.1
2017-09-08 13:45:25,502 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.verifyOutputSequenceFiles(TestHDFSEventSink.java:777)] Found event body: Test.0.2
2017-09-08 13:45:25,503 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.verifyOutputSequenceFiles(TestHDFSEventSink.java:777)] Found event body: Test.1.1
2017-09-08 13:45:25,503 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.verifyOutputSequenceFiles(TestHDFSEventSink.java:777)] Found event body: Test.1.2
2017-09-08 13:45:25,525 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.setUp(TestHDFSEventSink.java:104)] Starting...
2017-09-08 13:45:25,537 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.testRetryRename(TestHDFSEventSink.java:1482)] Starting...
2017-09-08 13:45:25,547 (main) [INFO - org.apache.flume.sink.hdfs.HDFSDataStream.configure(HDFSDataStream.java:57)] Serializer = TEXT, UseRawLocalFileSystem = false
2017-09-08 13:45:25,548 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.register(MonitoredCounterGroup.java:119)] Monitored counter group for type: SINK, name: HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3: Successfully registered new MBean.
2017-09-08 13:45:25,548 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.start(MonitoredCounterGroup.java:95)] Component type: SINK, name: HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3 started
2017-09-08 13:45:25,548 (main) [INFO - org.apache.flume.sink.hdfs.HDFSDataStream.configure(HDFSDataStream.java:57)] Serializer = TEXT, UseRawLocalFileSystem = false
2017-09-08 13:45:25,555 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:231)] Creating file:///tmp/flume-test.1504849525525.1/v1/test.1504849525549.tmp
2017-09-08 13:45:25,564 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-call-runner-0) [INFO - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetNumCurrentReplicas(AbstractHDFSWriter.java:189)] FileSystem's output stream doesn't support getNumCurrentReplicas; --HDFS-826 not available; fsOut=org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer; err=java.lang.NoSuchMethodException: org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer.getNumCurrentReplicas()
2017-09-08 13:45:25,564 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-call-runner-0) [DEBUG - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetDefaultReplication(AbstractHDFSWriter.java:228)] Using FileSystem.getDefaultReplication(Path) from HADOOP-8014
2017-09-08 13:45:25,564 (main) [WARN - org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:182)] isFileClosed is not available in the version of HDFS being used. Flume will not attempt to close files if the close fails on the first attempt
java.lang.NoSuchMethodException: org.apache.flume.sink.hdfs.MockFileSystem.isFileClosed(org.apache.hadoop.fs.Path)
	at java.lang.Class.getMethod(Class.java:1786)
	at org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:179)
	at org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:263)
	at org.apache.flume.sink.hdfs.BucketWriter.append(BucketWriter.java:504)
	at org.apache.flume.sink.hdfs.HDFSEventSink.process(HDFSEventSink.java:406)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.testRetryRename(TestHDFSEventSink.java:1518)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.testRetryRename(TestHDFSEventSink.java:1476)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:252)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:141)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:189)
	at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:165)
	at org.apache.maven.surefire.booter.ProviderFactory.invokeProvider(ProviderFactory.java:85)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:115)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:75)
2017-09-08 13:45:28,568 (main) [DEBUG - org.apache.flume.sink.hdfs.BucketWriter.shouldRotate(BucketWriter.java:581)] rolling: rollCount: 1, events: 1
2017-09-08 13:45:28,568 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.close(BucketWriter.java:357)] Closing file:///tmp/flume-test.1504849525525.1/v1/test.1504849525549.tmp
2017-09-08 13:45:28,569 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-call-runner-3) [INFO - org.apache.flume.sink.hdfs.MockFsDataOutputStream.close(MockFsDataOutputStream.java:41)] Close Succeeded - true
2017-09-08 13:45:28,570 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-call-runner-3) [INFO - org.apache.flume.sink.hdfs.MockFsDataOutputStream.close(MockFsDataOutputStream.java:43)] closing file
2017-09-08 13:45:28,573 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-call-runner-4) [INFO - org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:618)] Renaming file:/tmp/flume-test.1504849525525.1/v1/test.1504849525549.tmp to file:/tmp/flume-test.1504849525525.1/v1/test.1504849525549
2017-09-08 13:45:28,574 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-call-runner-4) [INFO - org.apache.flume.sink.hdfs.MockFileSystem.rename(MockFileSystem.java:125)] Attempting to Rename: '1' of '6'
2017-09-08 13:45:28,574 (main) [WARN - org.apache.flume.sink.hdfs.BucketWriter.close(BucketWriter.java:390)] failed to rename() file (file:///tmp/flume-test.1504849525525.1/v1/test.1504849525549.tmp). Exception follows.
java.io.IOException: MockIOException
	at org.apache.flume.sink.hdfs.MockFileSystem.rename(MockFileSystem.java:131)
	at org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:620)
	at org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:614)
	at org.apache.flume.sink.hdfs.BucketWriter$9$1.run(BucketWriter.java:668)
	at org.apache.flume.auth.SimpleAuthenticator.execute(SimpleAuthenticator.java:50)
	at org.apache.flume.sink.hdfs.BucketWriter$9.call(BucketWriter.java:665)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
2017-09-08 13:45:28,595 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:231)] Creating file:///tmp/flume-test.1504849525525.1/v1/test.1504849525550.tmp
2017-09-08 13:45:28,613 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-call-runner-5) [INFO - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetNumCurrentReplicas(AbstractHDFSWriter.java:189)] FileSystem's output stream doesn't support getNumCurrentReplicas; --HDFS-826 not available; fsOut=org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer; err=java.lang.NoSuchMethodException: org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer.getNumCurrentReplicas()
2017-09-08 13:45:28,614 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-call-runner-5) [DEBUG - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetDefaultReplication(AbstractHDFSWriter.java:228)] Using FileSystem.getDefaultReplication(Path) from HADOOP-8014
2017-09-08 13:45:28,614 (main) [WARN - org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:182)] isFileClosed is not available in the version of HDFS being used. Flume will not attempt to close files if the close fails on the first attempt
java.lang.NoSuchMethodException: org.apache.flume.sink.hdfs.MockFileSystem.isFileClosed(org.apache.hadoop.fs.Path)
	at java.lang.Class.getMethod(Class.java:1786)
	at org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:179)
	at org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:263)
	at org.apache.flume.sink.hdfs.BucketWriter.append(BucketWriter.java:530)
	at org.apache.flume.sink.hdfs.HDFSEventSink.process(HDFSEventSink.java:406)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.testRetryRename(TestHDFSEventSink.java:1518)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.testRetryRename(TestHDFSEventSink.java:1476)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:252)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:141)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:189)
	at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:165)
	at org.apache.maven.surefire.booter.ProviderFactory.invokeProvider(ProviderFactory.java:85)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:115)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:75)
2017-09-08 13:45:29,577 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-call-runner-7) [INFO - org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:618)] Renaming file:/tmp/flume-test.1504849525525.1/v1/test.1504849525549.tmp to file:/tmp/flume-test.1504849525525.1/v1/test.1504849525549
2017-09-08 13:45:29,577 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-call-runner-7) [INFO - org.apache.flume.sink.hdfs.MockFileSystem.rename(MockFileSystem.java:125)] Attempting to Rename: '2' of '6'
2017-09-08 13:45:29,578 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-roll-timer-0) [WARN - org.apache.flume.sink.hdfs.BucketWriter$4.call(BucketWriter.java:332)] Renaming file: file:///tmp/flume-test.1504849525525.1/v1/test.1504849525549.tmp failed. Will retry again in 1 seconds.
java.io.IOException: MockIOException
	at org.apache.flume.sink.hdfs.MockFileSystem.rename(MockFileSystem.java:131)
	at org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:620)
	at org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:614)
	at org.apache.flume.sink.hdfs.BucketWriter$9$1.run(BucketWriter.java:668)
	at org.apache.flume.auth.SimpleAuthenticator.execute(SimpleAuthenticator.java:50)
	at org.apache.flume.sink.hdfs.BucketWriter$9.call(BucketWriter.java:665)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
2017-09-08 13:45:30,582 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-call-runner-8) [INFO - org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:618)] Renaming file:/tmp/flume-test.1504849525525.1/v1/test.1504849525549.tmp to file:/tmp/flume-test.1504849525525.1/v1/test.1504849525549
2017-09-08 13:45:30,582 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-call-runner-8) [INFO - org.apache.flume.sink.hdfs.MockFileSystem.rename(MockFileSystem.java:125)] Attempting to Rename: '3' of '6'
2017-09-08 13:45:30,583 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-roll-timer-0) [WARN - org.apache.flume.sink.hdfs.BucketWriter$4.call(BucketWriter.java:332)] Renaming file: file:///tmp/flume-test.1504849525525.1/v1/test.1504849525549.tmp failed. Will retry again in 1 seconds.
java.io.IOException: MockIOException
	at org.apache.flume.sink.hdfs.MockFileSystem.rename(MockFileSystem.java:131)
	at org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:620)
	at org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:614)
	at org.apache.flume.sink.hdfs.BucketWriter$9$1.run(BucketWriter.java:668)
	at org.apache.flume.auth.SimpleAuthenticator.execute(SimpleAuthenticator.java:50)
	at org.apache.flume.sink.hdfs.BucketWriter$9.call(BucketWriter.java:665)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
2017-09-08 13:45:31,585 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-roll-timer-0) [WARN - org.apache.flume.sink.hdfs.BucketWriter$4.call(BucketWriter.java:324)] Unsuccessfully attempted to rename file:///tmp/flume-test.1504849525525.1/v1/test.1504849525549.tmp 3 times. File may still be open.
2017-09-08 13:45:31,616 (main) [INFO - org.apache.flume.sink.hdfs.HDFSDataStream.configure(HDFSDataStream.java:57)] Serializer = TEXT, UseRawLocalFileSystem = false
2017-09-08 13:45:31,638 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:231)] Creating file:///tmp/flume-test.1504849525525.1/v2/test.1504849531617.tmp
2017-09-08 13:45:31,664 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-call-runner-0) [INFO - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetNumCurrentReplicas(AbstractHDFSWriter.java:189)] FileSystem's output stream doesn't support getNumCurrentReplicas; --HDFS-826 not available; fsOut=org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer; err=java.lang.NoSuchMethodException: org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer.getNumCurrentReplicas()
2017-09-08 13:45:31,664 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-call-runner-0) [DEBUG - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetDefaultReplication(AbstractHDFSWriter.java:228)] Using FileSystem.getDefaultReplication(Path) from HADOOP-8014
2017-09-08 13:45:31,665 (main) [WARN - org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:182)] isFileClosed is not available in the version of HDFS being used. Flume will not attempt to close files if the close fails on the first attempt
java.lang.NoSuchMethodException: org.apache.flume.sink.hdfs.MockFileSystem.isFileClosed(org.apache.hadoop.fs.Path)
	at java.lang.Class.getMethod(Class.java:1786)
	at org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:179)
	at org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:263)
	at org.apache.flume.sink.hdfs.BucketWriter.append(BucketWriter.java:504)
	at org.apache.flume.sink.hdfs.HDFSEventSink.process(HDFSEventSink.java:406)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.testRetryRename(TestHDFSEventSink.java:1530)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.testRetryRename(TestHDFSEventSink.java:1476)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:252)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:141)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:189)
	at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:165)
	at org.apache.maven.surefire.booter.ProviderFactory.invokeProvider(ProviderFactory.java:85)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:115)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:75)
2017-09-08 13:45:34,667 (main) [DEBUG - org.apache.flume.sink.hdfs.BucketWriter.shouldRotate(BucketWriter.java:581)] rolling: rollCount: 1, events: 1
2017-09-08 13:45:34,667 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.close(BucketWriter.java:357)] Closing file:///tmp/flume-test.1504849525525.1/v2/test.1504849531617.tmp
2017-09-08 13:45:34,667 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-call-runner-3) [INFO - org.apache.flume.sink.hdfs.MockFsDataOutputStream.close(MockFsDataOutputStream.java:41)] Close Succeeded - true
2017-09-08 13:45:34,668 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-call-runner-3) [INFO - org.apache.flume.sink.hdfs.MockFsDataOutputStream.close(MockFsDataOutputStream.java:43)] closing file
2017-09-08 13:45:34,669 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-call-runner-4) [INFO - org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:618)] Renaming file:/tmp/flume-test.1504849525525.1/v2/test.1504849531617.tmp to file:/tmp/flume-test.1504849525525.1/v2/test.1504849531617
2017-09-08 13:45:34,669 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-call-runner-4) [INFO - org.apache.flume.sink.hdfs.MockFileSystem.rename(MockFileSystem.java:125)] Attempting to Rename: '4' of '6'
2017-09-08 13:45:34,670 (main) [WARN - org.apache.flume.sink.hdfs.BucketWriter.close(BucketWriter.java:390)] failed to rename() file (file:///tmp/flume-test.1504849525525.1/v2/test.1504849531617.tmp). Exception follows.
java.io.IOException: MockIOException
	at org.apache.flume.sink.hdfs.MockFileSystem.rename(MockFileSystem.java:131)
	at org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:620)
	at org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:614)
	at org.apache.flume.sink.hdfs.BucketWriter$9$1.run(BucketWriter.java:668)
	at org.apache.flume.auth.SimpleAuthenticator.execute(SimpleAuthenticator.java:50)
	at org.apache.flume.sink.hdfs.BucketWriter$9.call(BucketWriter.java:665)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
2017-09-08 13:45:34,682 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:231)] Creating file:///tmp/flume-test.1504849525525.1/v2/test.1504849531618.tmp
2017-09-08 13:45:34,699 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-call-runner-5) [INFO - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetNumCurrentReplicas(AbstractHDFSWriter.java:189)] FileSystem's output stream doesn't support getNumCurrentReplicas; --HDFS-826 not available; fsOut=org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer; err=java.lang.NoSuchMethodException: org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer.getNumCurrentReplicas()
2017-09-08 13:45:34,699 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-call-runner-5) [DEBUG - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetDefaultReplication(AbstractHDFSWriter.java:228)] Using FileSystem.getDefaultReplication(Path) from HADOOP-8014
2017-09-08 13:45:34,699 (main) [WARN - org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:182)] isFileClosed is not available in the version of HDFS being used. Flume will not attempt to close files if the close fails on the first attempt
java.lang.NoSuchMethodException: org.apache.flume.sink.hdfs.MockFileSystem.isFileClosed(org.apache.hadoop.fs.Path)
	at java.lang.Class.getMethod(Class.java:1786)
	at org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:179)
	at org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:263)
	at org.apache.flume.sink.hdfs.BucketWriter.append(BucketWriter.java:530)
	at org.apache.flume.sink.hdfs.HDFSEventSink.process(HDFSEventSink.java:406)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.testRetryRename(TestHDFSEventSink.java:1530)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.testRetryRename(TestHDFSEventSink.java:1476)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:252)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:141)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:189)
	at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:165)
	at org.apache.maven.surefire.booter.ProviderFactory.invokeProvider(ProviderFactory.java:85)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:115)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:75)
2017-09-08 13:45:35,671 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-call-runner-7) [INFO - org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:618)] Renaming file:/tmp/flume-test.1504849525525.1/v2/test.1504849531617.tmp to file:/tmp/flume-test.1504849525525.1/v2/test.1504849531617
2017-09-08 13:45:35,672 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-call-runner-7) [INFO - org.apache.flume.sink.hdfs.MockFileSystem.rename(MockFileSystem.java:125)] Attempting to Rename: '5' of '6'
2017-09-08 13:45:35,672 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-roll-timer-0) [WARN - org.apache.flume.sink.hdfs.BucketWriter$4.call(BucketWriter.java:332)] Renaming file: file:///tmp/flume-test.1504849525525.1/v2/test.1504849531617.tmp failed. Will retry again in 1 seconds.
java.io.IOException: MockIOException
	at org.apache.flume.sink.hdfs.MockFileSystem.rename(MockFileSystem.java:131)
	at org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:620)
	at org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:614)
	at org.apache.flume.sink.hdfs.BucketWriter$9$1.run(BucketWriter.java:668)
	at org.apache.flume.auth.SimpleAuthenticator.execute(SimpleAuthenticator.java:50)
	at org.apache.flume.sink.hdfs.BucketWriter$9.call(BucketWriter.java:665)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
2017-09-08 13:45:36,673 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-call-runner-8) [INFO - org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:618)] Renaming file:/tmp/flume-test.1504849525525.1/v2/test.1504849531617.tmp to file:/tmp/flume-test.1504849525525.1/v2/test.1504849531617
2017-09-08 13:45:36,674 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-call-runner-8) [INFO - org.apache.flume.sink.hdfs.MockFileSystem.rename(MockFileSystem.java:125)] Attempting to Rename: '6' of '6'
2017-09-08 13:45:36,674 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-call-runner-8) [INFO - org.apache.flume.sink.hdfs.MockFileSystem.rename(MockFileSystem.java:128)] Renaming file
2017-09-08 13:45:42,701 (main) [INFO - org.apache.flume.sink.hdfs.TestHDFSEventSink.testRetryRename(TestHDFSEventSink.java:1539)] Rename tries = 3
2017-09-08 13:45:42,701 (main) [INFO - org.apache.flume.sink.hdfs.TestHDFSEventSink.testRetryRename(TestHDFSEventSink.java:1539)] Rename tries = 3
2017-09-08 13:45:42,701 (main) [INFO - org.apache.flume.sink.hdfs.HDFSEventSink.stop(HDFSEventSink.java:480)] Closing file:///tmp/flume-test.1504849525525.1/v1\test
2017-09-08 13:45:42,701 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.close(BucketWriter.java:357)] Closing file:///tmp/flume-test.1504849525525.1/v1/test.1504849525550.tmp
2017-09-08 13:45:42,701 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-call-runner-0) [INFO - org.apache.flume.sink.hdfs.MockFsDataOutputStream.close(MockFsDataOutputStream.java:41)] Close Succeeded - true
2017-09-08 13:45:42,701 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-call-runner-0) [INFO - org.apache.flume.sink.hdfs.MockFsDataOutputStream.close(MockFsDataOutputStream.java:43)] closing file
2017-09-08 13:45:42,703 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-call-runner-1) [INFO - org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:618)] Renaming file:/tmp/flume-test.1504849525525.1/v1/test.1504849525550.tmp to file:/tmp/flume-test.1504849525525.1/v1/test.1504849525550
2017-09-08 13:45:42,703 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-call-runner-1) [INFO - org.apache.flume.sink.hdfs.MockFileSystem.rename(MockFileSystem.java:125)] Attempting to Rename: '7' of '6'
2017-09-08 13:45:42,703 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-call-runner-1) [INFO - org.apache.flume.sink.hdfs.MockFileSystem.rename(MockFileSystem.java:128)] Renaming file
2017-09-08 13:45:43,012 (main) [INFO - org.apache.flume.sink.hdfs.HDFSEventSink.stop(HDFSEventSink.java:480)] Closing file:///tmp/flume-test.1504849525525.1/v2\test
2017-09-08 13:45:43,012 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.close(BucketWriter.java:357)] Closing file:///tmp/flume-test.1504849525525.1/v2/test.1504849531618.tmp
2017-09-08 13:45:43,013 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-call-runner-2) [INFO - org.apache.flume.sink.hdfs.MockFsDataOutputStream.close(MockFsDataOutputStream.java:41)] Close Succeeded - true
2017-09-08 13:45:43,013 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-call-runner-2) [INFO - org.apache.flume.sink.hdfs.MockFsDataOutputStream.close(MockFsDataOutputStream.java:43)] closing file
2017-09-08 13:45:43,014 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-call-runner-3) [INFO - org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:618)] Renaming file:/tmp/flume-test.1504849525525.1/v2/test.1504849531618.tmp to file:/tmp/flume-test.1504849525525.1/v2/test.1504849531618
2017-09-08 13:45:43,015 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-call-runner-3) [INFO - org.apache.flume.sink.hdfs.MockFileSystem.rename(MockFileSystem.java:125)] Attempting to Rename: '8' of '6'
2017-09-08 13:45:43,015 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-call-runner-3) [INFO - org.apache.flume.sink.hdfs.MockFileSystem.rename(MockFileSystem.java:128)] Renaming file
2017-09-08 13:45:43,021 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:149)] Component type: SINK, name: HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3 stopped
2017-09-08 13:45:43,021 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:155)] Shutdown Metric for type: SINK, name: HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3. sink.start.time == 1504849525548
2017-09-08 13:45:43,022 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:161)] Shutdown Metric for type: SINK, name: HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3. sink.stop.time == 1504849543021
2017-09-08 13:45:43,022 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3. sink.batch.complete == 0
2017-09-08 13:45:43,022 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3. sink.batch.empty == 0
2017-09-08 13:45:43,022 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3. sink.batch.underflow == 4
2017-09-08 13:45:43,023 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3. sink.connection.closed.count == 4
2017-09-08 13:45:43,023 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3. sink.connection.creation.count == 4
2017-09-08 13:45:43,023 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3. sink.connection.failed.count == 7
2017-09-08 13:45:43,023 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3. sink.event.drain.attempt == 4
2017-09-08 13:45:43,024 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3. sink.event.drain.sucess == 4
2017-09-08 13:45:43,024 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.testRetryRename(TestHDFSEventSink.java:1482)] Starting...
2017-09-08 13:45:43,051 (main) [INFO - org.apache.flume.sink.hdfs.HDFSDataStream.configure(HDFSDataStream.java:57)] Serializer = TEXT, UseRawLocalFileSystem = false
2017-09-08 13:45:43,052 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.start(MonitoredCounterGroup.java:95)] Component type: SINK, name: HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3 started
2017-09-08 13:45:43,053 (main) [INFO - org.apache.flume.sink.hdfs.HDFSDataStream.configure(HDFSDataStream.java:57)] Serializer = TEXT, UseRawLocalFileSystem = false
2017-09-08 13:45:43,073 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:231)] Creating file:///tmp/flume-test.1504849525525.1/v1/test.1504849543054.tmp
2017-09-08 13:45:43,085 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-call-runner-0) [INFO - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetNumCurrentReplicas(AbstractHDFSWriter.java:189)] FileSystem's output stream doesn't support getNumCurrentReplicas; --HDFS-826 not available; fsOut=org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer; err=java.lang.NoSuchMethodException: org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer.getNumCurrentReplicas()
2017-09-08 13:45:43,085 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-call-runner-0) [DEBUG - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetDefaultReplication(AbstractHDFSWriter.java:228)] Using FileSystem.getDefaultReplication(Path) from HADOOP-8014
2017-09-08 13:45:43,085 (main) [WARN - org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:182)] isFileClosed is not available in the version of HDFS being used. Flume will not attempt to close files if the close fails on the first attempt
java.lang.NoSuchMethodException: org.apache.flume.sink.hdfs.MockFileSystem.isFileClosed(org.apache.hadoop.fs.Path)
	at java.lang.Class.getMethod(Class.java:1786)
	at org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:179)
	at org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:263)
	at org.apache.flume.sink.hdfs.BucketWriter.append(BucketWriter.java:504)
	at org.apache.flume.sink.hdfs.HDFSEventSink.process(HDFSEventSink.java:406)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.testRetryRename(TestHDFSEventSink.java:1518)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.testRetryRename(TestHDFSEventSink.java:1477)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:252)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:141)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:189)
	at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:165)
	at org.apache.maven.surefire.booter.ProviderFactory.invokeProvider(ProviderFactory.java:85)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:115)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:75)
2017-09-08 13:45:46,087 (main) [DEBUG - org.apache.flume.sink.hdfs.BucketWriter.shouldRotate(BucketWriter.java:581)] rolling: rollCount: 1, events: 1
2017-09-08 13:45:46,087 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.close(BucketWriter.java:357)] Closing file:///tmp/flume-test.1504849525525.1/v1/test.1504849543054.tmp
2017-09-08 13:45:46,088 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-call-runner-3) [INFO - org.apache.flume.sink.hdfs.MockFsDataOutputStream.close(MockFsDataOutputStream.java:41)] Close Succeeded - false
2017-09-08 13:45:46,088 (main) [WARN - org.apache.flume.sink.hdfs.BucketWriter.close(BucketWriter.java:364)] failed to close() HDFSWriter for file (file:///tmp/flume-test.1504849525525.1/v1/test.1504849543054.tmp). Exception follows.
java.io.IOException: MockIOException
	at org.apache.flume.sink.hdfs.MockFsDataOutputStream.close(MockFsDataOutputStream.java:46)
	at org.apache.flume.sink.hdfs.HDFSDataStream.close(HDFSDataStream.java:135)
	at org.apache.flume.sink.hdfs.BucketWriter$3.call(BucketWriter.java:307)
	at org.apache.flume.sink.hdfs.BucketWriter$3.call(BucketWriter.java:303)
	at org.apache.flume.sink.hdfs.BucketWriter$9$1.run(BucketWriter.java:668)
	at org.apache.flume.auth.SimpleAuthenticator.execute(SimpleAuthenticator.java:50)
	at org.apache.flume.sink.hdfs.BucketWriter$9.call(BucketWriter.java:665)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
2017-09-08 13:45:46,089 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-call-runner-4) [INFO - org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:618)] Renaming file:/tmp/flume-test.1504849525525.1/v1/test.1504849543054.tmp to file:/tmp/flume-test.1504849525525.1/v1/test.1504849543054
2017-09-08 13:45:46,089 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-call-runner-4) [INFO - org.apache.flume.sink.hdfs.MockFileSystem.rename(MockFileSystem.java:125)] Attempting to Rename: '1' of '6'
2017-09-08 13:45:46,089 (main) [WARN - org.apache.flume.sink.hdfs.BucketWriter.close(BucketWriter.java:390)] failed to rename() file (file:///tmp/flume-test.1504849525525.1/v1/test.1504849543054.tmp). Exception follows.
java.io.IOException: MockIOException
	at org.apache.flume.sink.hdfs.MockFileSystem.rename(MockFileSystem.java:131)
	at org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:620)
	at org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:614)
	at org.apache.flume.sink.hdfs.BucketWriter$9$1.run(BucketWriter.java:668)
	at org.apache.flume.auth.SimpleAuthenticator.execute(SimpleAuthenticator.java:50)
	at org.apache.flume.sink.hdfs.BucketWriter$9.call(BucketWriter.java:665)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
2017-09-08 13:45:46,102 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:231)] Creating file:///tmp/flume-test.1504849525525.1/v1/test.1504849543055.tmp
2017-09-08 13:45:46,127 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-call-runner-5) [INFO - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetNumCurrentReplicas(AbstractHDFSWriter.java:189)] FileSystem's output stream doesn't support getNumCurrentReplicas; --HDFS-826 not available; fsOut=org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer; err=java.lang.NoSuchMethodException: org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer.getNumCurrentReplicas()
2017-09-08 13:45:46,127 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-call-runner-5) [DEBUG - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetDefaultReplication(AbstractHDFSWriter.java:228)] Using FileSystem.getDefaultReplication(Path) from HADOOP-8014
2017-09-08 13:45:46,127 (main) [WARN - org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:182)] isFileClosed is not available in the version of HDFS being used. Flume will not attempt to close files if the close fails on the first attempt
java.lang.NoSuchMethodException: org.apache.flume.sink.hdfs.MockFileSystem.isFileClosed(org.apache.hadoop.fs.Path)
	at java.lang.Class.getMethod(Class.java:1786)
	at org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:179)
	at org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:263)
	at org.apache.flume.sink.hdfs.BucketWriter.append(BucketWriter.java:530)
	at org.apache.flume.sink.hdfs.HDFSEventSink.process(HDFSEventSink.java:406)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.testRetryRename(TestHDFSEventSink.java:1518)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.testRetryRename(TestHDFSEventSink.java:1477)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:252)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:141)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:189)
	at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:165)
	at org.apache.maven.surefire.booter.ProviderFactory.invokeProvider(ProviderFactory.java:85)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:115)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:75)
2017-09-08 13:45:47,091 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-call-runner-7) [INFO - org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:618)] Renaming file:/tmp/flume-test.1504849525525.1/v1/test.1504849543054.tmp to file:/tmp/flume-test.1504849525525.1/v1/test.1504849543054
2017-09-08 13:45:47,091 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-call-runner-7) [INFO - org.apache.flume.sink.hdfs.MockFileSystem.rename(MockFileSystem.java:125)] Attempting to Rename: '2' of '6'
2017-09-08 13:45:47,092 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-roll-timer-0) [WARN - org.apache.flume.sink.hdfs.BucketWriter$4.call(BucketWriter.java:332)] Renaming file: file:///tmp/flume-test.1504849525525.1/v1/test.1504849543054.tmp failed. Will retry again in 1 seconds.
java.io.IOException: MockIOException
	at org.apache.flume.sink.hdfs.MockFileSystem.rename(MockFileSystem.java:131)
	at org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:620)
	at org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:614)
	at org.apache.flume.sink.hdfs.BucketWriter$9$1.run(BucketWriter.java:668)
	at org.apache.flume.auth.SimpleAuthenticator.execute(SimpleAuthenticator.java:50)
	at org.apache.flume.sink.hdfs.BucketWriter$9.call(BucketWriter.java:665)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
2017-09-08 13:45:48,093 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-call-runner-8) [INFO - org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:618)] Renaming file:/tmp/flume-test.1504849525525.1/v1/test.1504849543054.tmp to file:/tmp/flume-test.1504849525525.1/v1/test.1504849543054
2017-09-08 13:45:48,094 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-call-runner-8) [INFO - org.apache.flume.sink.hdfs.MockFileSystem.rename(MockFileSystem.java:125)] Attempting to Rename: '3' of '6'
2017-09-08 13:45:48,094 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-roll-timer-0) [WARN - org.apache.flume.sink.hdfs.BucketWriter$4.call(BucketWriter.java:332)] Renaming file: file:///tmp/flume-test.1504849525525.1/v1/test.1504849543054.tmp failed. Will retry again in 1 seconds.
java.io.IOException: MockIOException
	at org.apache.flume.sink.hdfs.MockFileSystem.rename(MockFileSystem.java:131)
	at org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:620)
	at org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:614)
	at org.apache.flume.sink.hdfs.BucketWriter$9$1.run(BucketWriter.java:668)
	at org.apache.flume.auth.SimpleAuthenticator.execute(SimpleAuthenticator.java:50)
	at org.apache.flume.sink.hdfs.BucketWriter$9.call(BucketWriter.java:665)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
2017-09-08 13:45:49,095 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-roll-timer-0) [WARN - org.apache.flume.sink.hdfs.BucketWriter$4.call(BucketWriter.java:324)] Unsuccessfully attempted to rename file:///tmp/flume-test.1504849525525.1/v1/test.1504849543054.tmp 3 times. File may still be open.
2017-09-08 13:45:49,130 (main) [INFO - org.apache.flume.sink.hdfs.HDFSDataStream.configure(HDFSDataStream.java:57)] Serializer = TEXT, UseRawLocalFileSystem = false
2017-09-08 13:45:49,137 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:231)] Creating file:///tmp/flume-test.1504849525525.1/v2/test.1504849549131.tmp
2017-09-08 13:45:49,146 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-call-runner-0) [INFO - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetNumCurrentReplicas(AbstractHDFSWriter.java:189)] FileSystem's output stream doesn't support getNumCurrentReplicas; --HDFS-826 not available; fsOut=org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer; err=java.lang.NoSuchMethodException: org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer.getNumCurrentReplicas()
2017-09-08 13:45:49,146 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-call-runner-0) [DEBUG - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetDefaultReplication(AbstractHDFSWriter.java:228)] Using FileSystem.getDefaultReplication(Path) from HADOOP-8014
2017-09-08 13:45:49,146 (main) [WARN - org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:182)] isFileClosed is not available in the version of HDFS being used. Flume will not attempt to close files if the close fails on the first attempt
java.lang.NoSuchMethodException: org.apache.flume.sink.hdfs.MockFileSystem.isFileClosed(org.apache.hadoop.fs.Path)
	at java.lang.Class.getMethod(Class.java:1786)
	at org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:179)
	at org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:263)
	at org.apache.flume.sink.hdfs.BucketWriter.append(BucketWriter.java:504)
	at org.apache.flume.sink.hdfs.HDFSEventSink.process(HDFSEventSink.java:406)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.testRetryRename(TestHDFSEventSink.java:1530)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.testRetryRename(TestHDFSEventSink.java:1477)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:252)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:141)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:189)
	at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:165)
	at org.apache.maven.surefire.booter.ProviderFactory.invokeProvider(ProviderFactory.java:85)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:115)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:75)
2017-09-08 13:45:52,148 (main) [DEBUG - org.apache.flume.sink.hdfs.BucketWriter.shouldRotate(BucketWriter.java:581)] rolling: rollCount: 1, events: 1
2017-09-08 13:45:52,149 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.close(BucketWriter.java:357)] Closing file:///tmp/flume-test.1504849525525.1/v2/test.1504849549131.tmp
2017-09-08 13:45:52,149 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-call-runner-3) [INFO - org.apache.flume.sink.hdfs.MockFsDataOutputStream.close(MockFsDataOutputStream.java:41)] Close Succeeded - false
2017-09-08 13:45:52,149 (main) [WARN - org.apache.flume.sink.hdfs.BucketWriter.close(BucketWriter.java:364)] failed to close() HDFSWriter for file (file:///tmp/flume-test.1504849525525.1/v2/test.1504849549131.tmp). Exception follows.
java.io.IOException: MockIOException
	at org.apache.flume.sink.hdfs.MockFsDataOutputStream.close(MockFsDataOutputStream.java:46)
	at org.apache.flume.sink.hdfs.HDFSDataStream.close(HDFSDataStream.java:135)
	at org.apache.flume.sink.hdfs.BucketWriter$3.call(BucketWriter.java:307)
	at org.apache.flume.sink.hdfs.BucketWriter$3.call(BucketWriter.java:303)
	at org.apache.flume.sink.hdfs.BucketWriter$9$1.run(BucketWriter.java:668)
	at org.apache.flume.auth.SimpleAuthenticator.execute(SimpleAuthenticator.java:50)
	at org.apache.flume.sink.hdfs.BucketWriter$9.call(BucketWriter.java:665)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
2017-09-08 13:45:52,150 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-call-runner-4) [INFO - org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:618)] Renaming file:/tmp/flume-test.1504849525525.1/v2/test.1504849549131.tmp to file:/tmp/flume-test.1504849525525.1/v2/test.1504849549131
2017-09-08 13:45:52,150 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-call-runner-4) [INFO - org.apache.flume.sink.hdfs.MockFileSystem.rename(MockFileSystem.java:125)] Attempting to Rename: '4' of '6'
2017-09-08 13:45:52,150 (main) [WARN - org.apache.flume.sink.hdfs.BucketWriter.close(BucketWriter.java:390)] failed to rename() file (file:///tmp/flume-test.1504849525525.1/v2/test.1504849549131.tmp). Exception follows.
java.io.IOException: MockIOException
	at org.apache.flume.sink.hdfs.MockFileSystem.rename(MockFileSystem.java:131)
	at org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:620)
	at org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:614)
	at org.apache.flume.sink.hdfs.BucketWriter$9$1.run(BucketWriter.java:668)
	at org.apache.flume.auth.SimpleAuthenticator.execute(SimpleAuthenticator.java:50)
	at org.apache.flume.sink.hdfs.BucketWriter$9.call(BucketWriter.java:665)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
2017-09-08 13:45:52,163 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:231)] Creating file:///tmp/flume-test.1504849525525.1/v2/test.1504849549132.tmp
2017-09-08 13:45:52,181 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-call-runner-5) [INFO - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetNumCurrentReplicas(AbstractHDFSWriter.java:189)] FileSystem's output stream doesn't support getNumCurrentReplicas; --HDFS-826 not available; fsOut=org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer; err=java.lang.NoSuchMethodException: org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer.getNumCurrentReplicas()
2017-09-08 13:45:52,181 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-call-runner-5) [DEBUG - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetDefaultReplication(AbstractHDFSWriter.java:228)] Using FileSystem.getDefaultReplication(Path) from HADOOP-8014
2017-09-08 13:45:52,181 (main) [WARN - org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:182)] isFileClosed is not available in the version of HDFS being used. Flume will not attempt to close files if the close fails on the first attempt
java.lang.NoSuchMethodException: org.apache.flume.sink.hdfs.MockFileSystem.isFileClosed(org.apache.hadoop.fs.Path)
	at java.lang.Class.getMethod(Class.java:1786)
	at org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:179)
	at org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:263)
	at org.apache.flume.sink.hdfs.BucketWriter.append(BucketWriter.java:530)
	at org.apache.flume.sink.hdfs.HDFSEventSink.process(HDFSEventSink.java:406)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.testRetryRename(TestHDFSEventSink.java:1530)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.testRetryRename(TestHDFSEventSink.java:1477)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:252)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:141)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:189)
	at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:165)
	at org.apache.maven.surefire.booter.ProviderFactory.invokeProvider(ProviderFactory.java:85)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:115)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:75)
2017-09-08 13:45:53,152 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-call-runner-7) [INFO - org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:618)] Renaming file:/tmp/flume-test.1504849525525.1/v2/test.1504849549131.tmp to file:/tmp/flume-test.1504849525525.1/v2/test.1504849549131
2017-09-08 13:45:53,153 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-call-runner-7) [INFO - org.apache.flume.sink.hdfs.MockFileSystem.rename(MockFileSystem.java:125)] Attempting to Rename: '5' of '6'
2017-09-08 13:45:53,153 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-roll-timer-0) [WARN - org.apache.flume.sink.hdfs.BucketWriter$4.call(BucketWriter.java:332)] Renaming file: file:///tmp/flume-test.1504849525525.1/v2/test.1504849549131.tmp failed. Will retry again in 1 seconds.
java.io.IOException: MockIOException
	at org.apache.flume.sink.hdfs.MockFileSystem.rename(MockFileSystem.java:131)
	at org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:620)
	at org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:614)
	at org.apache.flume.sink.hdfs.BucketWriter$9$1.run(BucketWriter.java:668)
	at org.apache.flume.auth.SimpleAuthenticator.execute(SimpleAuthenticator.java:50)
	at org.apache.flume.sink.hdfs.BucketWriter$9.call(BucketWriter.java:665)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
2017-09-08 13:45:54,155 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-call-runner-8) [INFO - org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:618)] Renaming file:/tmp/flume-test.1504849525525.1/v2/test.1504849549131.tmp to file:/tmp/flume-test.1504849525525.1/v2/test.1504849549131
2017-09-08 13:45:54,155 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-call-runner-8) [INFO - org.apache.flume.sink.hdfs.MockFileSystem.rename(MockFileSystem.java:125)] Attempting to Rename: '6' of '6'
2017-09-08 13:45:54,155 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-call-runner-8) [INFO - org.apache.flume.sink.hdfs.MockFileSystem.rename(MockFileSystem.java:128)] Renaming file
2017-09-08 13:46:00,182 (main) [INFO - org.apache.flume.sink.hdfs.TestHDFSEventSink.testRetryRename(TestHDFSEventSink.java:1539)] Rename tries = 3
2017-09-08 13:46:00,182 (main) [INFO - org.apache.flume.sink.hdfs.TestHDFSEventSink.testRetryRename(TestHDFSEventSink.java:1539)] Rename tries = 3
2017-09-08 13:46:00,183 (main) [INFO - org.apache.flume.sink.hdfs.HDFSEventSink.stop(HDFSEventSink.java:480)] Closing file:///tmp/flume-test.1504849525525.1/v1\test
2017-09-08 13:46:00,183 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.close(BucketWriter.java:357)] Closing file:///tmp/flume-test.1504849525525.1/v1/test.1504849543055.tmp
2017-09-08 13:46:00,183 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-call-runner-0) [INFO - org.apache.flume.sink.hdfs.MockFsDataOutputStream.close(MockFsDataOutputStream.java:41)] Close Succeeded - false
2017-09-08 13:46:00,184 (main) [WARN - org.apache.flume.sink.hdfs.BucketWriter.close(BucketWriter.java:364)] failed to close() HDFSWriter for file (file:///tmp/flume-test.1504849525525.1/v1/test.1504849543055.tmp). Exception follows.
java.io.IOException: MockIOException
	at org.apache.flume.sink.hdfs.MockFsDataOutputStream.close(MockFsDataOutputStream.java:46)
	at org.apache.flume.sink.hdfs.HDFSDataStream.close(HDFSDataStream.java:135)
	at org.apache.flume.sink.hdfs.BucketWriter$3.call(BucketWriter.java:307)
	at org.apache.flume.sink.hdfs.BucketWriter$3.call(BucketWriter.java:303)
	at org.apache.flume.sink.hdfs.BucketWriter$9$1.run(BucketWriter.java:668)
	at org.apache.flume.auth.SimpleAuthenticator.execute(SimpleAuthenticator.java:50)
	at org.apache.flume.sink.hdfs.BucketWriter$9.call(BucketWriter.java:665)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
2017-09-08 13:46:00,185 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-call-runner-1) [INFO - org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:618)] Renaming file:/tmp/flume-test.1504849525525.1/v1/test.1504849543055.tmp to file:/tmp/flume-test.1504849525525.1/v1/test.1504849543055
2017-09-08 13:46:00,185 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-call-runner-1) [INFO - org.apache.flume.sink.hdfs.MockFileSystem.rename(MockFileSystem.java:125)] Attempting to Rename: '7' of '6'
2017-09-08 13:46:00,185 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-call-runner-1) [INFO - org.apache.flume.sink.hdfs.MockFileSystem.rename(MockFileSystem.java:128)] Renaming file
2017-09-08 13:46:00,189 (main) [INFO - org.apache.flume.sink.hdfs.HDFSEventSink.stop(HDFSEventSink.java:480)] Closing file:///tmp/flume-test.1504849525525.1/v2\test
2017-09-08 13:46:00,190 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.close(BucketWriter.java:357)] Closing file:///tmp/flume-test.1504849525525.1/v2/test.1504849549132.tmp
2017-09-08 13:46:00,190 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-call-runner-2) [INFO - org.apache.flume.sink.hdfs.MockFsDataOutputStream.close(MockFsDataOutputStream.java:41)] Close Succeeded - false
2017-09-08 13:46:00,191 (main) [WARN - org.apache.flume.sink.hdfs.BucketWriter.close(BucketWriter.java:364)] failed to close() HDFSWriter for file (file:///tmp/flume-test.1504849525525.1/v2/test.1504849549132.tmp). Exception follows.
java.io.IOException: MockIOException
	at org.apache.flume.sink.hdfs.MockFsDataOutputStream.close(MockFsDataOutputStream.java:46)
	at org.apache.flume.sink.hdfs.HDFSDataStream.close(HDFSDataStream.java:135)
	at org.apache.flume.sink.hdfs.BucketWriter$3.call(BucketWriter.java:307)
	at org.apache.flume.sink.hdfs.BucketWriter$3.call(BucketWriter.java:303)
	at org.apache.flume.sink.hdfs.BucketWriter$9$1.run(BucketWriter.java:668)
	at org.apache.flume.auth.SimpleAuthenticator.execute(SimpleAuthenticator.java:50)
	at org.apache.flume.sink.hdfs.BucketWriter$9.call(BucketWriter.java:665)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
2017-09-08 13:46:00,192 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-call-runner-3) [INFO - org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:618)] Renaming file:/tmp/flume-test.1504849525525.1/v2/test.1504849549132.tmp to file:/tmp/flume-test.1504849525525.1/v2/test.1504849549132
2017-09-08 13:46:00,192 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-call-runner-3) [INFO - org.apache.flume.sink.hdfs.MockFileSystem.rename(MockFileSystem.java:125)] Attempting to Rename: '8' of '6'
2017-09-08 13:46:00,192 (hdfs-HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3-call-runner-3) [INFO - org.apache.flume.sink.hdfs.MockFileSystem.rename(MockFileSystem.java:128)] Renaming file
2017-09-08 13:46:00,198 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:149)] Component type: SINK, name: HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3 stopped
2017-09-08 13:46:00,198 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:155)] Shutdown Metric for type: SINK, name: HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3. sink.start.time == 1504849543052
2017-09-08 13:46:00,198 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:161)] Shutdown Metric for type: SINK, name: HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3. sink.stop.time == 1504849560198
2017-09-08 13:46:00,198 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3. sink.batch.complete == 0
2017-09-08 13:46:00,199 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3. sink.batch.empty == 0
2017-09-08 13:46:00,199 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3. sink.batch.underflow == 4
2017-09-08 13:46:00,199 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3. sink.connection.closed.count == 0
2017-09-08 13:46:00,199 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3. sink.connection.creation.count == 4
2017-09-08 13:46:00,200 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3. sink.connection.failed.count == 15
2017-09-08 13:46:00,200 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3. sink.event.drain.attempt == 4
2017-09-08 13:46:00,200 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-1ac53dad-d79c-4a61-ac42-fa6d07e5cbf3. sink.event.drain.sucess == 4
2017-09-08 13:46:00,228 (main) [WARN - org.apache.hadoop.fs.FileUtil.deleteImpl(FileUtil.java:187)] Failed to delete file or dir [E:\tmp\flume-test.1504849525525.1\v1\.test.1504849525550.tmp.crc]: it still exists.
2017-09-08 13:46:00,228 (main) [WARN - org.apache.hadoop.fs.FileUtil.deleteImpl(FileUtil.java:187)] Failed to delete file or dir [E:\tmp\flume-test.1504849525525.1\v1\.test.1504849543054.tmp.crc]: it still exists.
2017-09-08 13:46:00,228 (main) [WARN - org.apache.hadoop.fs.FileUtil.deleteImpl(FileUtil.java:187)] Failed to delete file or dir [E:\tmp\flume-test.1504849525525.1\v1\.test.1504849543055.tmp.crc]: it still exists.
2017-09-08 13:46:00,229 (main) [WARN - org.apache.hadoop.fs.FileUtil.deleteImpl(FileUtil.java:187)] Failed to delete file or dir [E:\tmp\flume-test.1504849525525.1\v1\test.1504849525550.tmp]: it still exists.
2017-09-08 13:46:00,230 (main) [WARN - org.apache.hadoop.fs.FileUtil.deleteImpl(FileUtil.java:187)] Failed to delete file or dir [E:\tmp\flume-test.1504849525525.1\v1\test.1504849543054.tmp]: it still exists.
2017-09-08 13:46:00,230 (main) [WARN - org.apache.hadoop.fs.FileUtil.deleteImpl(FileUtil.java:187)] Failed to delete file or dir [E:\tmp\flume-test.1504849525525.1\v1\test.1504849543055.tmp]: it still exists.
2017-09-08 13:46:00,232 (main) [WARN - org.apache.hadoop.fs.FileUtil.deleteImpl(FileUtil.java:187)] Failed to delete file or dir [E:\tmp\flume-test.1504849525525.1\v2\.test.1504849549131.tmp.crc]: it still exists.
2017-09-08 13:46:00,232 (main) [WARN - org.apache.hadoop.fs.FileUtil.deleteImpl(FileUtil.java:187)] Failed to delete file or dir [E:\tmp\flume-test.1504849525525.1\v2\.test.1504849549132.tmp.crc]: it still exists.
2017-09-08 13:46:00,234 (main) [WARN - org.apache.hadoop.fs.FileUtil.deleteImpl(FileUtil.java:187)] Failed to delete file or dir [E:\tmp\flume-test.1504849525525.1\v2\test.1504849549131.tmp]: it still exists.
2017-09-08 13:46:00,235 (main) [WARN - org.apache.hadoop.fs.FileUtil.deleteImpl(FileUtil.java:187)] Failed to delete file or dir [E:\tmp\flume-test.1504849525525.1\v2\test.1504849549132.tmp]: it still exists.
2017-09-08 13:46:00,235 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.setUp(TestHDFSEventSink.java:104)] Starting...
2017-09-08 13:46:00,262 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.register(MonitoredCounterGroup.java:119)] Monitored counter group for type: SINK, name: HDFSEventSink-db5e9d56-ccb5-44ff-84d3-37434ebe7676: Successfully registered new MBean.
2017-09-08 13:46:00,262 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.start(MonitoredCounterGroup.java:95)] Component type: SINK, name: HDFSEventSink-db5e9d56-ccb5-44ff-84d3-37434ebe7676 started
2017-09-08 13:46:00,262 (main) [INFO - org.apache.flume.sink.hdfs.HDFSSequenceFile.configure(HDFSSequenceFile.java:63)] writeFormat = Writable, UseRawLocalFileSystem = false
2017-09-08 13:46:00,269 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:231)] Creating file:///tmp/flume-test.1504849560235.1/idleClose/FlumeData.1504849560263.tmp
2017-09-08 13:46:00,280 (hdfs-HDFSEventSink-db5e9d56-ccb5-44ff-84d3-37434ebe7676-call-runner-0) [INFO - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetNumCurrentReplicas(AbstractHDFSWriter.java:189)] FileSystem's output stream doesn't support getNumCurrentReplicas; --HDFS-826 not available; fsOut=org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer; err=java.lang.NoSuchMethodException: org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer.getNumCurrentReplicas()
2017-09-08 13:46:00,280 (hdfs-HDFSEventSink-db5e9d56-ccb5-44ff-84d3-37434ebe7676-call-runner-0) [DEBUG - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetDefaultReplication(AbstractHDFSWriter.java:228)] Using FileSystem.getDefaultReplication(Path) from HADOOP-8014
2017-09-08 13:46:00,280 (main) [WARN - org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:182)] isFileClosed is not available in the version of HDFS being used. Flume will not attempt to close files if the close fails on the first attempt
java.lang.NoSuchMethodException: org.apache.hadoop.fs.LocalFileSystem.isFileClosed(org.apache.hadoop.fs.Path)
	at java.lang.Class.getMethod(Class.java:1786)
	at org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:179)
	at org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:263)
	at org.apache.flume.sink.hdfs.BucketWriter.append(BucketWriter.java:504)
	at org.apache.flume.sink.hdfs.HDFSEventSink.process(HDFSEventSink.java:406)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.testCloseOnIdle(TestHDFSEventSink.java:1307)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:252)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:141)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:189)
	at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:165)
	at org.apache.maven.surefire.booter.ProviderFactory.invokeProvider(ProviderFactory.java:85)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:115)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:75)
2017-09-08 13:46:01,286 (hdfs-HDFSEventSink-db5e9d56-ccb5-44ff-84d3-37434ebe7676-roll-timer-0) [INFO - org.apache.flume.sink.hdfs.BucketWriter$5.call(BucketWriter.java:419)] Closing idle bucketWriter file:///tmp/flume-test.1504849560235.1/idleClose/FlumeData.1504849560263.tmp at 1504849561286
2017-09-08 13:46:01,288 (hdfs-HDFSEventSink-db5e9d56-ccb5-44ff-84d3-37434ebe7676-roll-timer-0) [INFO - org.apache.flume.sink.hdfs.BucketWriter.close(BucketWriter.java:357)] Closing file:///tmp/flume-test.1504849560235.1/idleClose/FlumeData.1504849560263.tmp
2017-09-08 13:46:01,291 (hdfs-HDFSEventSink-db5e9d56-ccb5-44ff-84d3-37434ebe7676-call-runner-0) [INFO - org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:618)] Renaming file:/tmp/flume-test.1504849560235.1/idleClose/FlumeData.1504849560263.tmp to file:/tmp/flume-test.1504849560235.1/idleClose/FlumeData.1504849560263
2017-09-08 13:46:01,294 (hdfs-HDFSEventSink-db5e9d56-ccb5-44ff-84d3-37434ebe7676-roll-timer-0) [INFO - org.apache.flume.sink.hdfs.HDFSEventSink$1.run(HDFSEventSink.java:382)] Writer callback called.
2017-09-08 13:46:01,295 (main) [INFO - org.apache.flume.sink.hdfs.HDFSEventSink.process(HDFSEventSink.java:408)] Bucket was closed while trying to append, reinitializing bucket and writing event.
2017-09-08 13:46:01,295 (main) [INFO - org.apache.flume.sink.hdfs.HDFSSequenceFile.configure(HDFSSequenceFile.java:63)] writeFormat = Writable, UseRawLocalFileSystem = false
2017-09-08 13:46:01,320 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:231)] Creating file:///tmp/flume-test.1504849560235.1/idleClose/FlumeData.1504849561296.tmp
2017-09-08 13:46:01,345 (hdfs-HDFSEventSink-db5e9d56-ccb5-44ff-84d3-37434ebe7676-call-runner-1) [INFO - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetNumCurrentReplicas(AbstractHDFSWriter.java:189)] FileSystem's output stream doesn't support getNumCurrentReplicas; --HDFS-826 not available; fsOut=org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer; err=java.lang.NoSuchMethodException: org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer.getNumCurrentReplicas()
2017-09-08 13:46:01,345 (hdfs-HDFSEventSink-db5e9d56-ccb5-44ff-84d3-37434ebe7676-call-runner-1) [DEBUG - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetDefaultReplication(AbstractHDFSWriter.java:228)] Using FileSystem.getDefaultReplication(Path) from HADOOP-8014
2017-09-08 13:46:01,345 (main) [WARN - org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:182)] isFileClosed is not available in the version of HDFS being used. Flume will not attempt to close files if the close fails on the first attempt
java.lang.NoSuchMethodException: org.apache.hadoop.fs.LocalFileSystem.isFileClosed(org.apache.hadoop.fs.Path)
	at java.lang.Class.getMethod(Class.java:1786)
	at org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:179)
	at org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:263)
	at org.apache.flume.sink.hdfs.BucketWriter.append(BucketWriter.java:504)
	at org.apache.flume.sink.hdfs.HDFSEventSink.process(HDFSEventSink.java:416)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.testCloseOnIdle(TestHDFSEventSink.java:1315)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:252)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:141)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:189)
	at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:165)
	at org.apache.maven.surefire.booter.ProviderFactory.invokeProvider(ProviderFactory.java:85)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:115)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:75)
2017-09-08 13:46:02,850 (hdfs-HDFSEventSink-db5e9d56-ccb5-44ff-84d3-37434ebe7676-roll-timer-0) [INFO - org.apache.flume.sink.hdfs.BucketWriter$5.call(BucketWriter.java:419)] Closing idle bucketWriter file:///tmp/flume-test.1504849560235.1/idleClose/FlumeData.1504849561296.tmp at 1504849562850
2017-09-08 13:46:02,850 (hdfs-HDFSEventSink-db5e9d56-ccb5-44ff-84d3-37434ebe7676-roll-timer-0) [INFO - org.apache.flume.sink.hdfs.BucketWriter.close(BucketWriter.java:357)] Closing file:///tmp/flume-test.1504849560235.1/idleClose/FlumeData.1504849561296.tmp
2017-09-08 13:46:02,853 (hdfs-HDFSEventSink-db5e9d56-ccb5-44ff-84d3-37434ebe7676-call-runner-1) [INFO - org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:618)] Renaming file:/tmp/flume-test.1504849560235.1/idleClose/FlumeData.1504849561296.tmp to file:/tmp/flume-test.1504849560235.1/idleClose/FlumeData.1504849561296
2017-09-08 13:46:02,857 (hdfs-HDFSEventSink-db5e9d56-ccb5-44ff-84d3-37434ebe7676-roll-timer-0) [INFO - org.apache.flume.sink.hdfs.HDFSEventSink$1.run(HDFSEventSink.java:382)] Writer callback called.
2017-09-08 13:46:04,852 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:149)] Component type: SINK, name: HDFSEventSink-db5e9d56-ccb5-44ff-84d3-37434ebe7676 stopped
2017-09-08 13:46:04,852 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:155)] Shutdown Metric for type: SINK, name: HDFSEventSink-db5e9d56-ccb5-44ff-84d3-37434ebe7676. sink.start.time == 1504849560262
2017-09-08 13:46:04,852 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:161)] Shutdown Metric for type: SINK, name: HDFSEventSink-db5e9d56-ccb5-44ff-84d3-37434ebe7676. sink.stop.time == 1504849564852
2017-09-08 13:46:04,853 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-db5e9d56-ccb5-44ff-84d3-37434ebe7676. sink.batch.complete == 5
2017-09-08 13:46:04,853 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-db5e9d56-ccb5-44ff-84d3-37434ebe7676. sink.batch.empty == 1
2017-09-08 13:46:04,853 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-db5e9d56-ccb5-44ff-84d3-37434ebe7676. sink.batch.underflow == 0
2017-09-08 13:46:04,854 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-db5e9d56-ccb5-44ff-84d3-37434ebe7676. sink.connection.closed.count == 2
2017-09-08 13:46:04,854 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-db5e9d56-ccb5-44ff-84d3-37434ebe7676. sink.connection.creation.count == 2
2017-09-08 13:46:04,854 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-db5e9d56-ccb5-44ff-84d3-37434ebe7676. sink.connection.failed.count == 0
2017-09-08 13:46:04,854 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-db5e9d56-ccb5-44ff-84d3-37434ebe7676. sink.event.drain.attempt == 10
2017-09-08 13:46:04,854 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-db5e9d56-ccb5-44ff-84d3-37434ebe7676. sink.event.drain.sucess == 10
2017-09-08 13:46:04,891 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.setUp(TestHDFSEventSink.java:104)] Starting...
2017-09-08 13:46:04,910 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.testSimpleAppend(TestHDFSEventSink.java:449)] Starting...
2017-09-08 13:46:04,920 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.register(MonitoredCounterGroup.java:119)] Monitored counter group for type: SINK, name: HDFSEventSink-b7f2adb5-284c-4396-b29e-cf3b53242bcf: Successfully registered new MBean.
2017-09-08 13:46:04,921 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.start(MonitoredCounterGroup.java:95)] Component type: SINK, name: HDFSEventSink-b7f2adb5-284c-4396-b29e-cf3b53242bcf started
2017-09-08 13:46:04,922 (main) [INFO - org.apache.flume.sink.hdfs.HDFSSequenceFile.configure(HDFSSequenceFile.java:63)] writeFormat = Writable, UseRawLocalFileSystem = false
2017-09-08 13:46:04,930 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:231)] Creating file:///tmp/flume-test.1504849564891.1/singleBucket/FlumeData.1504849564923.tmp
2017-09-08 13:46:04,943 (hdfs-HDFSEventSink-b7f2adb5-284c-4396-b29e-cf3b53242bcf-call-runner-0) [INFO - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetNumCurrentReplicas(AbstractHDFSWriter.java:189)] FileSystem's output stream doesn't support getNumCurrentReplicas; --HDFS-826 not available; fsOut=org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer; err=java.lang.NoSuchMethodException: org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer.getNumCurrentReplicas()
2017-09-08 13:46:04,943 (hdfs-HDFSEventSink-b7f2adb5-284c-4396-b29e-cf3b53242bcf-call-runner-0) [DEBUG - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetDefaultReplication(AbstractHDFSWriter.java:228)] Using FileSystem.getDefaultReplication(Path) from HADOOP-8014
2017-09-08 13:46:04,943 (main) [WARN - org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:182)] isFileClosed is not available in the version of HDFS being used. Flume will not attempt to close files if the close fails on the first attempt
java.lang.NoSuchMethodException: org.apache.hadoop.fs.LocalFileSystem.isFileClosed(org.apache.hadoop.fs.Path)
	at java.lang.Class.getMethod(Class.java:1786)
	at org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:179)
	at org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:263)
	at org.apache.flume.sink.hdfs.BucketWriter.append(BucketWriter.java:504)
	at org.apache.flume.sink.hdfs.HDFSEventSink.process(HDFSEventSink.java:406)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.testSimpleAppend(TestHDFSEventSink.java:504)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:252)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:141)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:189)
	at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:165)
	at org.apache.maven.surefire.booter.ProviderFactory.invokeProvider(ProviderFactory.java:85)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:115)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:75)
2017-09-08 13:46:04,947 (main) [DEBUG - org.apache.flume.sink.hdfs.BucketWriter.shouldRotate(BucketWriter.java:581)] rolling: rollCount: 5, events: 5
2017-09-08 13:46:04,947 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.close(BucketWriter.java:357)] Closing file:///tmp/flume-test.1504849564891.1/singleBucket/FlumeData.1504849564923.tmp
2017-09-08 13:46:04,948 (hdfs-HDFSEventSink-b7f2adb5-284c-4396-b29e-cf3b53242bcf-call-runner-0) [INFO - org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:618)] Renaming file:/tmp/flume-test.1504849564891.1/singleBucket/FlumeData.1504849564923.tmp to file:/tmp/flume-test.1504849564891.1/singleBucket/FlumeData.1504849564923
2017-09-08 13:46:04,962 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:231)] Creating file:///tmp/flume-test.1504849564891.1/singleBucket/FlumeData.1504849564924.tmp
2017-09-08 13:46:04,975 (hdfs-HDFSEventSink-b7f2adb5-284c-4396-b29e-cf3b53242bcf-call-runner-1) [INFO - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetNumCurrentReplicas(AbstractHDFSWriter.java:189)] FileSystem's output stream doesn't support getNumCurrentReplicas; --HDFS-826 not available; fsOut=org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer; err=java.lang.NoSuchMethodException: org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer.getNumCurrentReplicas()
2017-09-08 13:46:04,975 (hdfs-HDFSEventSink-b7f2adb5-284c-4396-b29e-cf3b53242bcf-call-runner-1) [DEBUG - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetDefaultReplication(AbstractHDFSWriter.java:228)] Using FileSystem.getDefaultReplication(Path) from HADOOP-8014
2017-09-08 13:46:04,975 (main) [WARN - org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:182)] isFileClosed is not available in the version of HDFS being used. Flume will not attempt to close files if the close fails on the first attempt
java.lang.NoSuchMethodException: org.apache.hadoop.fs.LocalFileSystem.isFileClosed(org.apache.hadoop.fs.Path)
	at java.lang.Class.getMethod(Class.java:1786)
	at org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:179)
	at org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:263)
	at org.apache.flume.sink.hdfs.BucketWriter.append(BucketWriter.java:530)
	at org.apache.flume.sink.hdfs.HDFSEventSink.process(HDFSEventSink.java:406)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.testSimpleAppend(TestHDFSEventSink.java:504)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:252)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:141)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:189)
	at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:165)
	at org.apache.maven.surefire.booter.ProviderFactory.invokeProvider(ProviderFactory.java:85)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:115)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:75)
2017-09-08 13:46:04,976 (main) [INFO - org.apache.flume.sink.hdfs.HDFSEventSink.stop(HDFSEventSink.java:480)] Closing file:///tmp/flume-test.1504849564891.1/singleBucket\FlumeData
2017-09-08 13:46:04,976 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.close(BucketWriter.java:357)] Closing file:///tmp/flume-test.1504849564891.1/singleBucket/FlumeData.1504849564924.tmp
2017-09-08 13:46:04,977 (hdfs-HDFSEventSink-b7f2adb5-284c-4396-b29e-cf3b53242bcf-call-runner-5) [INFO - org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:618)] Renaming file:/tmp/flume-test.1504849564891.1/singleBucket/FlumeData.1504849564924.tmp to file:/tmp/flume-test.1504849564891.1/singleBucket/FlumeData.1504849564924
2017-09-08 13:46:04,979 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:149)] Component type: SINK, name: HDFSEventSink-b7f2adb5-284c-4396-b29e-cf3b53242bcf stopped
2017-09-08 13:46:04,979 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:155)] Shutdown Metric for type: SINK, name: HDFSEventSink-b7f2adb5-284c-4396-b29e-cf3b53242bcf. sink.start.time == 1504849564921
2017-09-08 13:46:04,980 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:161)] Shutdown Metric for type: SINK, name: HDFSEventSink-b7f2adb5-284c-4396-b29e-cf3b53242bcf. sink.stop.time == 1504849564979
2017-09-08 13:46:04,980 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-b7f2adb5-284c-4396-b29e-cf3b53242bcf. sink.batch.complete == 3
2017-09-08 13:46:04,980 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-b7f2adb5-284c-4396-b29e-cf3b53242bcf. sink.batch.empty == 0
2017-09-08 13:46:04,980 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-b7f2adb5-284c-4396-b29e-cf3b53242bcf. sink.batch.underflow == 0
2017-09-08 13:46:04,980 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-b7f2adb5-284c-4396-b29e-cf3b53242bcf. sink.connection.closed.count == 2
2017-09-08 13:46:04,980 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-b7f2adb5-284c-4396-b29e-cf3b53242bcf. sink.connection.creation.count == 2
2017-09-08 13:46:04,980 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-b7f2adb5-284c-4396-b29e-cf3b53242bcf. sink.connection.failed.count == 0
2017-09-08 13:46:04,980 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-b7f2adb5-284c-4396-b29e-cf3b53242bcf. sink.event.drain.attempt == 6
2017-09-08 13:46:04,980 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-b7f2adb5-284c-4396-b29e-cf3b53242bcf. sink.event.drain.sucess == 6
2017-09-08 13:46:04,983 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.verifyOutputSequenceFiles(TestHDFSEventSink.java:777)] Found event body: Test.1.1
2017-09-08 13:46:04,983 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.verifyOutputSequenceFiles(TestHDFSEventSink.java:777)] Found event body: Test.1.2
2017-09-08 13:46:04,983 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.verifyOutputSequenceFiles(TestHDFSEventSink.java:777)] Found event body: Test.2.1
2017-09-08 13:46:04,983 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.verifyOutputSequenceFiles(TestHDFSEventSink.java:777)] Found event body: Test.2.2
2017-09-08 13:46:04,983 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.verifyOutputSequenceFiles(TestHDFSEventSink.java:777)] Found event body: Test.3.1
2017-09-08 13:46:04,984 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.verifyOutputSequenceFiles(TestHDFSEventSink.java:777)] Found event body: Test.3.2
2017-09-08 13:46:04,998 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.setUp(TestHDFSEventSink.java:104)] Starting...
2017-09-08 13:46:05,013 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.testAppend(TestHDFSEventSink.java:614)] Starting...
2017-09-08 13:46:05,023 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.register(MonitoredCounterGroup.java:119)] Monitored counter group for type: SINK, name: HDFSEventSink-58ea15a3-f763-4284-85f1-4f13431fd90f: Successfully registered new MBean.
2017-09-08 13:46:05,023 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.start(MonitoredCounterGroup.java:95)] Component type: SINK, name: HDFSEventSink-58ea15a3-f763-4284-85f1-4f13431fd90f started
2017-09-08 13:46:05,026 (main) [INFO - org.apache.flume.sink.hdfs.HDFSSequenceFile.configure(HDFSSequenceFile.java:63)] writeFormat = Writable, UseRawLocalFileSystem = false
2017-09-08 13:46:05,032 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:231)] Creating file:///tmp/flume-test.1504849564998.1/2011-01-31/17/FlumeData.1504849565026.tmp
2017-09-08 13:46:05,042 (hdfs-HDFSEventSink-58ea15a3-f763-4284-85f1-4f13431fd90f-call-runner-0) [INFO - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetNumCurrentReplicas(AbstractHDFSWriter.java:189)] FileSystem's output stream doesn't support getNumCurrentReplicas; --HDFS-826 not available; fsOut=org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer; err=java.lang.NoSuchMethodException: org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer.getNumCurrentReplicas()
2017-09-08 13:46:05,042 (hdfs-HDFSEventSink-58ea15a3-f763-4284-85f1-4f13431fd90f-call-runner-0) [DEBUG - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetDefaultReplication(AbstractHDFSWriter.java:228)] Using FileSystem.getDefaultReplication(Path) from HADOOP-8014
2017-09-08 13:46:05,042 (main) [WARN - org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:182)] isFileClosed is not available in the version of HDFS being used. Flume will not attempt to close files if the close fails on the first attempt
java.lang.NoSuchMethodException: org.apache.hadoop.fs.LocalFileSystem.isFileClosed(org.apache.hadoop.fs.Path)
	at java.lang.Class.getMethod(Class.java:1786)
	at org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:179)
	at org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:263)
	at org.apache.flume.sink.hdfs.BucketWriter.append(BucketWriter.java:504)
	at org.apache.flume.sink.hdfs.HDFSEventSink.process(HDFSEventSink.java:406)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.testAppend(TestHDFSEventSink.java:664)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:252)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:141)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:189)
	at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:165)
	at org.apache.maven.surefire.booter.ProviderFactory.invokeProvider(ProviderFactory.java:85)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:115)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:75)
2017-09-08 13:46:05,045 (main) [INFO - org.apache.flume.sink.hdfs.HDFSSequenceFile.configure(HDFSSequenceFile.java:63)] writeFormat = Writable, UseRawLocalFileSystem = false
2017-09-08 13:46:05,052 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:231)] Creating file:///tmp/flume-test.1504849564998.1/2011-03-01/18/FlumeData.1504849565046.tmp
2017-09-08 13:46:05,063 (hdfs-HDFSEventSink-58ea15a3-f763-4284-85f1-4f13431fd90f-call-runner-4) [INFO - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetNumCurrentReplicas(AbstractHDFSWriter.java:189)] FileSystem's output stream doesn't support getNumCurrentReplicas; --HDFS-826 not available; fsOut=org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer; err=java.lang.NoSuchMethodException: org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer.getNumCurrentReplicas()
2017-09-08 13:46:05,063 (hdfs-HDFSEventSink-58ea15a3-f763-4284-85f1-4f13431fd90f-call-runner-4) [DEBUG - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetDefaultReplication(AbstractHDFSWriter.java:228)] Using FileSystem.getDefaultReplication(Path) from HADOOP-8014
2017-09-08 13:46:05,063 (main) [WARN - org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:182)] isFileClosed is not available in the version of HDFS being used. Flume will not attempt to close files if the close fails on the first attempt
java.lang.NoSuchMethodException: org.apache.hadoop.fs.LocalFileSystem.isFileClosed(org.apache.hadoop.fs.Path)
	at java.lang.Class.getMethod(Class.java:1786)
	at org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:179)
	at org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:263)
	at org.apache.flume.sink.hdfs.BucketWriter.append(BucketWriter.java:504)
	at org.apache.flume.sink.hdfs.HDFSEventSink.process(HDFSEventSink.java:406)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.testAppend(TestHDFSEventSink.java:664)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:252)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:141)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:189)
	at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:165)
	at org.apache.maven.surefire.booter.ProviderFactory.invokeProvider(ProviderFactory.java:85)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:115)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:75)
2017-09-08 13:46:05,067 (main) [INFO - org.apache.flume.sink.hdfs.HDFSSequenceFile.configure(HDFSSequenceFile.java:63)] writeFormat = Writable, UseRawLocalFileSystem = false
2017-09-08 13:46:05,074 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:231)] Creating file:///tmp/flume-test.1504849564998.1/2011-04-02/19/FlumeData.1504849565067.tmp
2017-09-08 13:46:05,085 (hdfs-HDFSEventSink-58ea15a3-f763-4284-85f1-4f13431fd90f-call-runner-8) [INFO - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetNumCurrentReplicas(AbstractHDFSWriter.java:189)] FileSystem's output stream doesn't support getNumCurrentReplicas; --HDFS-826 not available; fsOut=org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer; err=java.lang.NoSuchMethodException: org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer.getNumCurrentReplicas()
2017-09-08 13:46:05,086 (hdfs-HDFSEventSink-58ea15a3-f763-4284-85f1-4f13431fd90f-call-runner-8) [DEBUG - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetDefaultReplication(AbstractHDFSWriter.java:228)] Using FileSystem.getDefaultReplication(Path) from HADOOP-8014
2017-09-08 13:46:05,086 (main) [WARN - org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:182)] isFileClosed is not available in the version of HDFS being used. Flume will not attempt to close files if the close fails on the first attempt
java.lang.NoSuchMethodException: org.apache.hadoop.fs.LocalFileSystem.isFileClosed(org.apache.hadoop.fs.Path)
	at java.lang.Class.getMethod(Class.java:1786)
	at org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:179)
	at org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:263)
	at org.apache.flume.sink.hdfs.BucketWriter.append(BucketWriter.java:504)
	at org.apache.flume.sink.hdfs.HDFSEventSink.process(HDFSEventSink.java:406)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.testAppend(TestHDFSEventSink.java:664)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:252)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:141)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:189)
	at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:165)
	at org.apache.maven.surefire.booter.ProviderFactory.invokeProvider(ProviderFactory.java:85)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:115)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:75)
2017-09-08 13:46:05,088 (main) [INFO - org.apache.flume.sink.hdfs.HDFSEventSink.stop(HDFSEventSink.java:480)] Closing file:///tmp/flume-test.1504849564998.1/2011-01-31/17\FlumeData
2017-09-08 13:46:05,088 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.close(BucketWriter.java:357)] Closing file:///tmp/flume-test.1504849564998.1/2011-01-31/17/FlumeData.1504849565026.tmp
2017-09-08 13:46:05,089 (hdfs-HDFSEventSink-58ea15a3-f763-4284-85f1-4f13431fd90f-call-runner-3) [INFO - org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:618)] Renaming file:/tmp/flume-test.1504849564998.1/2011-01-31/17/FlumeData.1504849565026.tmp to file:/tmp/flume-test.1504849564998.1/2011-01-31/17/FlumeData.1504849565026
2017-09-08 13:46:05,091 (main) [INFO - org.apache.flume.sink.hdfs.HDFSEventSink.stop(HDFSEventSink.java:480)] Closing file:///tmp/flume-test.1504849564998.1/2011-03-01/18\FlumeData
2017-09-08 13:46:05,091 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.close(BucketWriter.java:357)] Closing file:///tmp/flume-test.1504849564998.1/2011-03-01/18/FlumeData.1504849565046.tmp
2017-09-08 13:46:05,092 (hdfs-HDFSEventSink-58ea15a3-f763-4284-85f1-4f13431fd90f-call-runner-5) [INFO - org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:618)] Renaming file:/tmp/flume-test.1504849564998.1/2011-03-01/18/FlumeData.1504849565046.tmp to file:/tmp/flume-test.1504849564998.1/2011-03-01/18/FlumeData.1504849565046
2017-09-08 13:46:05,094 (main) [INFO - org.apache.flume.sink.hdfs.HDFSEventSink.stop(HDFSEventSink.java:480)] Closing file:///tmp/flume-test.1504849564998.1/2011-04-02/19\FlumeData
2017-09-08 13:46:05,094 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.close(BucketWriter.java:357)] Closing file:///tmp/flume-test.1504849564998.1/2011-04-02/19/FlumeData.1504849565067.tmp
2017-09-08 13:46:05,095 (hdfs-HDFSEventSink-58ea15a3-f763-4284-85f1-4f13431fd90f-call-runner-7) [INFO - org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:618)] Renaming file:/tmp/flume-test.1504849564998.1/2011-04-02/19/FlumeData.1504849565067.tmp to file:/tmp/flume-test.1504849564998.1/2011-04-02/19/FlumeData.1504849565067
2017-09-08 13:46:05,099 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:149)] Component type: SINK, name: HDFSEventSink-58ea15a3-f763-4284-85f1-4f13431fd90f stopped
2017-09-08 13:46:05,099 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:155)] Shutdown Metric for type: SINK, name: HDFSEventSink-58ea15a3-f763-4284-85f1-4f13431fd90f. sink.start.time == 1504849565023
2017-09-08 13:46:05,099 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:161)] Shutdown Metric for type: SINK, name: HDFSEventSink-58ea15a3-f763-4284-85f1-4f13431fd90f. sink.stop.time == 1504849565099
2017-09-08 13:46:05,099 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-58ea15a3-f763-4284-85f1-4f13431fd90f. sink.batch.complete == 3
2017-09-08 13:46:05,099 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-58ea15a3-f763-4284-85f1-4f13431fd90f. sink.batch.empty == 0
2017-09-08 13:46:05,099 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-58ea15a3-f763-4284-85f1-4f13431fd90f. sink.batch.underflow == 0
2017-09-08 13:46:05,100 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-58ea15a3-f763-4284-85f1-4f13431fd90f. sink.connection.closed.count == 3
2017-09-08 13:46:05,100 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-58ea15a3-f763-4284-85f1-4f13431fd90f. sink.connection.creation.count == 3
2017-09-08 13:46:05,100 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-58ea15a3-f763-4284-85f1-4f13431fd90f. sink.connection.failed.count == 0
2017-09-08 13:46:05,100 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-58ea15a3-f763-4284-85f1-4f13431fd90f. sink.event.drain.attempt == 6
2017-09-08 13:46:05,100 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-58ea15a3-f763-4284-85f1-4f13431fd90f. sink.event.drain.sucess == 6
2017-09-08 13:46:05,101 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.verifyOutputSequenceFiles(TestHDFSEventSink.java:777)] Found event body: Test.1.1
2017-09-08 13:46:05,102 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.verifyOutputSequenceFiles(TestHDFSEventSink.java:777)] Found event body: Test.1.2
2017-09-08 13:46:05,103 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.verifyOutputSequenceFiles(TestHDFSEventSink.java:777)] Found event body: Test.2.1
2017-09-08 13:46:05,103 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.verifyOutputSequenceFiles(TestHDFSEventSink.java:777)] Found event body: Test.2.2
2017-09-08 13:46:05,103 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.verifyOutputSequenceFiles(TestHDFSEventSink.java:777)] Found event body: Test.3.1
2017-09-08 13:46:05,104 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.verifyOutputSequenceFiles(TestHDFSEventSink.java:777)] Found event body: Test.3.2
2017-09-08 13:46:05,118 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.setUp(TestHDFSEventSink.java:104)] Starting...
2017-09-08 13:46:05,126 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.testAvroAppend(TestHDFSEventSink.java:370)] Starting...
2017-09-08 13:46:05,132 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.register(MonitoredCounterGroup.java:119)] Monitored counter group for type: SINK, name: HDFSEventSink-2560af31-01f2-4f75-ab79-047a981eb3b2: Successfully registered new MBean.
2017-09-08 13:46:05,132 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.start(MonitoredCounterGroup.java:95)] Component type: SINK, name: HDFSEventSink-2560af31-01f2-4f75-ab79-047a981eb3b2 started
2017-09-08 13:46:05,133 (main) [INFO - org.apache.flume.sink.hdfs.HDFSDataStream.configure(HDFSDataStream.java:57)] Serializer = AVRO_EVENT, UseRawLocalFileSystem = false
2017-09-08 13:46:05,139 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:231)] Creating file:///tmp/flume-test.1504849565119.1/singleTextBucket/FlumeData.1504849565134.tmp
2017-09-08 13:46:05,288 (hdfs-HDFSEventSink-2560af31-01f2-4f75-ab79-047a981eb3b2-call-runner-0) [INFO - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetNumCurrentReplicas(AbstractHDFSWriter.java:189)] FileSystem's output stream doesn't support getNumCurrentReplicas; --HDFS-826 not available; fsOut=org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer; err=java.lang.NoSuchMethodException: org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer.getNumCurrentReplicas()
2017-09-08 13:46:05,288 (hdfs-HDFSEventSink-2560af31-01f2-4f75-ab79-047a981eb3b2-call-runner-0) [DEBUG - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetDefaultReplication(AbstractHDFSWriter.java:228)] Using FileSystem.getDefaultReplication(Path) from HADOOP-8014
2017-09-08 13:46:05,299 (main) [WARN - org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:182)] isFileClosed is not available in the version of HDFS being used. Flume will not attempt to close files if the close fails on the first attempt
java.lang.NoSuchMethodException: org.apache.hadoop.fs.LocalFileSystem.isFileClosed(org.apache.hadoop.fs.Path)
	at java.lang.Class.getMethod(Class.java:1786)
	at org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:179)
	at org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:263)
	at org.apache.flume.sink.hdfs.BucketWriter.append(BucketWriter.java:504)
	at org.apache.flume.sink.hdfs.HDFSEventSink.process(HDFSEventSink.java:406)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.testAvroAppend(TestHDFSEventSink.java:428)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:252)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:141)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:189)
	at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:165)
	at org.apache.maven.surefire.booter.ProviderFactory.invokeProvider(ProviderFactory.java:85)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:115)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:75)
2017-09-08 13:46:05,303 (main) [DEBUG - org.apache.flume.sink.hdfs.BucketWriter.shouldRotate(BucketWriter.java:581)] rolling: rollCount: 3, events: 3
2017-09-08 13:46:05,304 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.close(BucketWriter.java:357)] Closing file:///tmp/flume-test.1504849565119.1/singleTextBucket/FlumeData.1504849565134.tmp
2017-09-08 13:46:05,306 (hdfs-HDFSEventSink-2560af31-01f2-4f75-ab79-047a981eb3b2-call-runner-7) [INFO - org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:618)] Renaming file:/tmp/flume-test.1504849565119.1/singleTextBucket/FlumeData.1504849565134.tmp to file:/tmp/flume-test.1504849565119.1/singleTextBucket/FlumeData.1504849565134
2017-09-08 13:46:05,320 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:231)] Creating file:///tmp/flume-test.1504849565119.1/singleTextBucket/FlumeData.1504849565135.tmp
2017-09-08 13:46:05,333 (hdfs-HDFSEventSink-2560af31-01f2-4f75-ab79-047a981eb3b2-call-runner-8) [INFO - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetNumCurrentReplicas(AbstractHDFSWriter.java:189)] FileSystem's output stream doesn't support getNumCurrentReplicas; --HDFS-826 not available; fsOut=org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer; err=java.lang.NoSuchMethodException: org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer.getNumCurrentReplicas()
2017-09-08 13:46:05,333 (hdfs-HDFSEventSink-2560af31-01f2-4f75-ab79-047a981eb3b2-call-runner-8) [DEBUG - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetDefaultReplication(AbstractHDFSWriter.java:228)] Using FileSystem.getDefaultReplication(Path) from HADOOP-8014
2017-09-08 13:46:05,334 (main) [WARN - org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:182)] isFileClosed is not available in the version of HDFS being used. Flume will not attempt to close files if the close fails on the first attempt
java.lang.NoSuchMethodException: org.apache.hadoop.fs.LocalFileSystem.isFileClosed(org.apache.hadoop.fs.Path)
	at java.lang.Class.getMethod(Class.java:1786)
	at org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:179)
	at org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:263)
	at org.apache.flume.sink.hdfs.BucketWriter.append(BucketWriter.java:530)
	at org.apache.flume.sink.hdfs.HDFSEventSink.process(HDFSEventSink.java:406)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.testAvroAppend(TestHDFSEventSink.java:428)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:252)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:141)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:189)
	at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:165)
	at org.apache.maven.surefire.booter.ProviderFactory.invokeProvider(ProviderFactory.java:85)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:115)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:75)
2017-09-08 13:46:05,335 (main) [INFO - org.apache.flume.sink.hdfs.HDFSEventSink.stop(HDFSEventSink.java:480)] Closing file:///tmp/flume-test.1504849565119.1/singleTextBucket\FlumeData
2017-09-08 13:46:05,336 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.close(BucketWriter.java:357)] Closing file:///tmp/flume-test.1504849565119.1/singleTextBucket/FlumeData.1504849565135.tmp
2017-09-08 13:46:05,336 (hdfs-HDFSEventSink-2560af31-01f2-4f75-ab79-047a981eb3b2-call-runner-5) [INFO - org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:618)] Renaming file:/tmp/flume-test.1504849565119.1/singleTextBucket/FlumeData.1504849565135.tmp to file:/tmp/flume-test.1504849565119.1/singleTextBucket/FlumeData.1504849565135
2017-09-08 13:46:05,338 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:149)] Component type: SINK, name: HDFSEventSink-2560af31-01f2-4f75-ab79-047a981eb3b2 stopped
2017-09-08 13:46:05,338 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:155)] Shutdown Metric for type: SINK, name: HDFSEventSink-2560af31-01f2-4f75-ab79-047a981eb3b2. sink.start.time == 1504849565132
2017-09-08 13:46:05,339 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:161)] Shutdown Metric for type: SINK, name: HDFSEventSink-2560af31-01f2-4f75-ab79-047a981eb3b2. sink.stop.time == 1504849565338
2017-09-08 13:46:05,339 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-2560af31-01f2-4f75-ab79-047a981eb3b2. sink.batch.complete == 3
2017-09-08 13:46:05,339 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-2560af31-01f2-4f75-ab79-047a981eb3b2. sink.batch.empty == 0
2017-09-08 13:46:05,339 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-2560af31-01f2-4f75-ab79-047a981eb3b2. sink.batch.underflow == 0
2017-09-08 13:46:05,339 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-2560af31-01f2-4f75-ab79-047a981eb3b2. sink.connection.closed.count == 2
2017-09-08 13:46:05,339 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-2560af31-01f2-4f75-ab79-047a981eb3b2. sink.connection.creation.count == 2
2017-09-08 13:46:05,339 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-2560af31-01f2-4f75-ab79-047a981eb3b2. sink.connection.failed.count == 0
2017-09-08 13:46:05,339 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-2560af31-01f2-4f75-ab79-047a981eb3b2. sink.event.drain.attempt == 6
2017-09-08 13:46:05,339 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-2560af31-01f2-4f75-ab79-047a981eb3b2. sink.event.drain.sucess == 6
2017-09-08 13:46:05,355 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.verifyOutputAvroFiles(TestHDFSEventSink.java:836)] Removing event: Test.1.1
2017-09-08 13:46:05,355 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.verifyOutputAvroFiles(TestHDFSEventSink.java:836)] Removing event: Test.1.2
2017-09-08 13:46:05,355 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.verifyOutputAvroFiles(TestHDFSEventSink.java:836)] Removing event: Test.2.1
2017-09-08 13:46:05,356 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.verifyOutputAvroFiles(TestHDFSEventSink.java:836)] Removing event: Test.2.2
2017-09-08 13:46:05,356 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.verifyOutputAvroFiles(TestHDFSEventSink.java:836)] Removing event: Test.3.1
2017-09-08 13:46:05,356 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.verifyOutputAvroFiles(TestHDFSEventSink.java:836)] Removing event: Test.3.2
2017-09-08 13:46:05,368 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.setUp(TestHDFSEventSink.java:104)] Starting...
2017-09-08 13:46:05,376 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.testCloseReopen(TestHDFSEventSink.java:859)] Starting...
2017-09-08 13:46:05,384 (main) [DEBUG - org.apache.flume.instrumentation.MonitoredCounterGroup.register(MonitoredCounterGroup.java:111)] Monitored counter group for type: SINK, name: null: Another MBean is already registered with this name. Unregistering that pre-existing MBean now...
2017-09-08 13:46:05,384 (main) [DEBUG - org.apache.flume.instrumentation.MonitoredCounterGroup.register(MonitoredCounterGroup.java:115)] Monitored counter group for type: SINK, name: null: Successfully unregistered pre-existing MBean.
2017-09-08 13:46:05,384 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.register(MonitoredCounterGroup.java:119)] Monitored counter group for type: SINK, name: null: Successfully registered new MBean.
2017-09-08 13:46:05,384 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.start(MonitoredCounterGroup.java:95)] Component type: SINK, name: null started
2017-09-08 13:46:05,384 (main) [INFO - org.apache.flume.sink.hdfs.HDFSSequenceFile.configure(HDFSSequenceFile.java:63)] writeFormat = Writable, UseRawLocalFileSystem = false
2017-09-08 13:46:05,392 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:231)] Creating file:///tmp/flume-test.1504849565368.1/singleBucket/FlumeData.1504849565385.tmp
2017-09-08 13:46:05,402 (hdfs-null-call-runner-0) [INFO - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetNumCurrentReplicas(AbstractHDFSWriter.java:189)] FileSystem's output stream doesn't support getNumCurrentReplicas; --HDFS-826 not available; fsOut=org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer; err=java.lang.NoSuchMethodException: org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer.getNumCurrentReplicas()
2017-09-08 13:46:05,402 (hdfs-null-call-runner-0) [DEBUG - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetDefaultReplication(AbstractHDFSWriter.java:228)] Using FileSystem.getDefaultReplication(Path) from HADOOP-8014
2017-09-08 13:46:05,402 (main) [WARN - org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:182)] isFileClosed is not available in the version of HDFS being used. Flume will not attempt to close files if the close fails on the first attempt
java.lang.NoSuchMethodException: org.apache.hadoop.fs.LocalFileSystem.isFileClosed(org.apache.hadoop.fs.Path)
	at java.lang.Class.getMethod(Class.java:1786)
	at org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:179)
	at org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:263)
	at org.apache.flume.sink.hdfs.BucketWriter.append(BucketWriter.java:504)
	at org.apache.flume.sink.hdfs.HDFSEventSink.process(HDFSEventSink.java:406)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.testCloseReopen(TestHDFSEventSink.java:917)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:252)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:141)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:189)
	at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:165)
	at org.apache.maven.surefire.booter.ProviderFactory.invokeProvider(ProviderFactory.java:85)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:115)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:75)
2017-09-08 13:46:05,403 (main) [WARN - org.apache.flume.sink.hdfs.BucketWriter.append(BucketWriter.java:545)] Caught IOException writing to HDFSWriter (Injected fault-until-reopen). Closing file (file:///tmp/flume-test.1504849565368.1/singleBucket/FlumeData.1504849565385.tmp) and rethrowing exception.
2017-09-08 13:46:05,403 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.close(BucketWriter.java:357)] Closing file:///tmp/flume-test.1504849565368.1/singleBucket/FlumeData.1504849565385.tmp
2017-09-08 13:46:05,404 (hdfs-null-call-runner-3) [INFO - org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:618)] Renaming file:/tmp/flume-test.1504849565368.1/singleBucket/FlumeData.1504849565385.tmp to file:/tmp/flume-test.1504849565368.1/singleBucket/FlumeData.1504849565385
2017-09-08 13:46:05,406 (main) [INFO - org.apache.flume.sink.hdfs.HDFSEventSink$1.run(HDFSEventSink.java:382)] Writer callback called.
2017-09-08 13:46:05,406 (main) [WARN - org.apache.flume.sink.hdfs.HDFSEventSink.process(HDFSEventSink.java:443)] HDFS IO error
java.io.IOException: Injected fault-until-reopen
	at org.apache.flume.sink.hdfs.HDFSTestSeqWriter.append(HDFSTestSeqWriter.java:58)
	at org.apache.flume.sink.hdfs.BucketWriter$7.call(BucketWriter.java:540)
	at org.apache.flume.sink.hdfs.BucketWriter$7.call(BucketWriter.java:537)
	at org.apache.flume.sink.hdfs.BucketWriter$9$1.run(BucketWriter.java:668)
	at org.apache.flume.auth.SimpleAuthenticator.execute(SimpleAuthenticator.java:50)
	at org.apache.flume.sink.hdfs.BucketWriter$9.call(BucketWriter.java:665)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
2017-09-08 13:46:05,406 (main) [INFO - org.apache.flume.sink.hdfs.TestHDFSEventSink.testCloseReopen(TestHDFSEventSink.java:917)] execute sink to process the events: BACKOFF
2017-09-08 13:46:05,406 (main) [INFO - org.apache.flume.sink.hdfs.HDFSSequenceFile.configure(HDFSSequenceFile.java:63)] writeFormat = Writable, UseRawLocalFileSystem = false
2017-09-08 13:46:05,414 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:231)] Creating file:///tmp/flume-test.1504849565368.1/singleBucket/FlumeData.1504849565407.tmp
2017-09-08 13:46:05,424 (hdfs-null-call-runner-4) [INFO - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetNumCurrentReplicas(AbstractHDFSWriter.java:189)] FileSystem's output stream doesn't support getNumCurrentReplicas; --HDFS-826 not available; fsOut=org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer; err=java.lang.NoSuchMethodException: org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer.getNumCurrentReplicas()
2017-09-08 13:46:05,424 (hdfs-null-call-runner-4) [DEBUG - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetDefaultReplication(AbstractHDFSWriter.java:228)] Using FileSystem.getDefaultReplication(Path) from HADOOP-8014
2017-09-08 13:46:05,424 (main) [WARN - org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:182)] isFileClosed is not available in the version of HDFS being used. Flume will not attempt to close files if the close fails on the first attempt
java.lang.NoSuchMethodException: org.apache.hadoop.fs.LocalFileSystem.isFileClosed(org.apache.hadoop.fs.Path)
	at java.lang.Class.getMethod(Class.java:1786)
	at org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:179)
	at org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:263)
	at org.apache.flume.sink.hdfs.BucketWriter.append(BucketWriter.java:504)
	at org.apache.flume.sink.hdfs.HDFSEventSink.process(HDFSEventSink.java:406)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.testCloseReopen(TestHDFSEventSink.java:917)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:252)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:141)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:189)
	at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:165)
	at org.apache.maven.surefire.booter.ProviderFactory.invokeProvider(ProviderFactory.java:85)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:115)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:75)
2017-09-08 13:46:05,426 (main) [INFO - org.apache.flume.sink.hdfs.TestHDFSEventSink.testCloseReopen(TestHDFSEventSink.java:917)] execute sink to process the events: READY
2017-09-08 13:46:05,427 (main) [INFO - org.apache.flume.sink.hdfs.TestHDFSEventSink.testCloseReopen(TestHDFSEventSink.java:917)] execute sink to process the events: READY
2017-09-08 13:46:05,427 (main) [DEBUG - org.apache.flume.sink.hdfs.BucketWriter.shouldRotate(BucketWriter.java:581)] rolling: rollCount: 5, events: 5
2017-09-08 13:46:05,427 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.close(BucketWriter.java:357)] Closing file:///tmp/flume-test.1504849565368.1/singleBucket/FlumeData.1504849565407.tmp
2017-09-08 13:46:05,428 (hdfs-null-call-runner-4) [INFO - org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:618)] Renaming file:/tmp/flume-test.1504849565368.1/singleBucket/FlumeData.1504849565407.tmp to file:/tmp/flume-test.1504849565368.1/singleBucket/FlumeData.1504849565407
2017-09-08 13:46:05,441 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:231)] Creating file:///tmp/flume-test.1504849565368.1/singleBucket/FlumeData.1504849565408.tmp
2017-09-08 13:46:05,450 (hdfs-null-call-runner-5) [INFO - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetNumCurrentReplicas(AbstractHDFSWriter.java:189)] FileSystem's output stream doesn't support getNumCurrentReplicas; --HDFS-826 not available; fsOut=org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer; err=java.lang.NoSuchMethodException: org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer.getNumCurrentReplicas()
2017-09-08 13:46:05,450 (hdfs-null-call-runner-5) [DEBUG - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetDefaultReplication(AbstractHDFSWriter.java:228)] Using FileSystem.getDefaultReplication(Path) from HADOOP-8014
2017-09-08 13:46:05,450 (main) [WARN - org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:182)] isFileClosed is not available in the version of HDFS being used. Flume will not attempt to close files if the close fails on the first attempt
java.lang.NoSuchMethodException: org.apache.hadoop.fs.LocalFileSystem.isFileClosed(org.apache.hadoop.fs.Path)
	at java.lang.Class.getMethod(Class.java:1786)
	at org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:179)
	at org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:263)
	at org.apache.flume.sink.hdfs.BucketWriter.append(BucketWriter.java:530)
	at org.apache.flume.sink.hdfs.HDFSEventSink.process(HDFSEventSink.java:406)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.testCloseReopen(TestHDFSEventSink.java:919)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:252)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:141)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:189)
	at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:165)
	at org.apache.maven.surefire.booter.ProviderFactory.invokeProvider(ProviderFactory.java:85)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:115)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:75)
2017-09-08 13:46:05,451 (main) [INFO - org.apache.flume.sink.hdfs.TestHDFSEventSink.testCloseReopen(TestHDFSEventSink.java:919)] clear any events pending due to errors: READY
2017-09-08 13:46:05,451 (main) [INFO - org.apache.flume.sink.hdfs.HDFSEventSink.stop(HDFSEventSink.java:480)] Closing file:///tmp/flume-test.1504849565368.1/singleBucket\FlumeData
2017-09-08 13:46:05,451 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.close(BucketWriter.java:357)] Closing file:///tmp/flume-test.1504849565368.1/singleBucket/FlumeData.1504849565408.tmp
2017-09-08 13:46:05,452 (hdfs-null-call-runner-9) [INFO - org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:618)] Renaming file:/tmp/flume-test.1504849565368.1/singleBucket/FlumeData.1504849565408.tmp to file:/tmp/flume-test.1504849565368.1/singleBucket/FlumeData.1504849565408
2017-09-08 13:46:05,454 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:149)] Component type: SINK, name: null stopped
2017-09-08 13:46:05,454 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:155)] Shutdown Metric for type: SINK, name: null. sink.start.time == 1504849565384
2017-09-08 13:46:05,454 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:161)] Shutdown Metric for type: SINK, name: null. sink.stop.time == 1504849565454
2017-09-08 13:46:05,454 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: null. sink.batch.complete == 3
2017-09-08 13:46:05,454 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: null. sink.batch.empty == 0
2017-09-08 13:46:05,454 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: null. sink.batch.underflow == 0
2017-09-08 13:46:05,454 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: null. sink.connection.closed.count == 3
2017-09-08 13:46:05,454 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: null. sink.connection.creation.count == 3
2017-09-08 13:46:05,455 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: null. sink.connection.failed.count == 1
2017-09-08 13:46:05,455 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: null. sink.event.drain.attempt == 7
2017-09-08 13:46:05,455 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: null. sink.event.drain.sucess == 6
2017-09-08 13:46:05,457 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.verifyOutputSequenceFiles(TestHDFSEventSink.java:777)] Found event body: Test.1.1
2017-09-08 13:46:05,457 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.verifyOutputSequenceFiles(TestHDFSEventSink.java:777)] Found event body: Test.1.2
2017-09-08 13:46:05,457 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.verifyOutputSequenceFiles(TestHDFSEventSink.java:777)] Found event body: Test.2.1
2017-09-08 13:46:05,457 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.verifyOutputSequenceFiles(TestHDFSEventSink.java:777)] Found event body: Test.2.2
2017-09-08 13:46:05,458 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.verifyOutputSequenceFiles(TestHDFSEventSink.java:777)] Found event body: Test.3.1
2017-09-08 13:46:05,458 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.verifyOutputSequenceFiles(TestHDFSEventSink.java:777)] Found event body: Test.3.2
2017-09-08 13:46:05,470 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.setUp(TestHDFSEventSink.java:104)] Starting...
2017-09-08 13:46:05,478 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.testLifecycle(TestHDFSEventSink.java:216)] Starting...
2017-09-08 13:46:05,478 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.register(MonitoredCounterGroup.java:119)] Monitored counter group for type: SINK, name: HDFSEventSink-004864b1-95dc-403d-ae0c-30d907e0f963: Successfully registered new MBean.
2017-09-08 13:46:05,478 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.start(MonitoredCounterGroup.java:95)] Component type: SINK, name: HDFSEventSink-004864b1-95dc-403d-ae0c-30d907e0f963 started
2017-09-08 13:46:05,478 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:149)] Component type: SINK, name: HDFSEventSink-004864b1-95dc-403d-ae0c-30d907e0f963 stopped
2017-09-08 13:46:05,479 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:155)] Shutdown Metric for type: SINK, name: HDFSEventSink-004864b1-95dc-403d-ae0c-30d907e0f963. sink.start.time == 1504849565478
2017-09-08 13:46:05,479 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:161)] Shutdown Metric for type: SINK, name: HDFSEventSink-004864b1-95dc-403d-ae0c-30d907e0f963. sink.stop.time == 1504849565478
2017-09-08 13:46:05,479 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-004864b1-95dc-403d-ae0c-30d907e0f963. sink.batch.complete == 0
2017-09-08 13:46:05,479 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-004864b1-95dc-403d-ae0c-30d907e0f963. sink.batch.empty == 0
2017-09-08 13:46:05,479 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-004864b1-95dc-403d-ae0c-30d907e0f963. sink.batch.underflow == 0
2017-09-08 13:46:05,479 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-004864b1-95dc-403d-ae0c-30d907e0f963. sink.connection.closed.count == 0
2017-09-08 13:46:05,479 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-004864b1-95dc-403d-ae0c-30d907e0f963. sink.connection.creation.count == 0
2017-09-08 13:46:05,479 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-004864b1-95dc-403d-ae0c-30d907e0f963. sink.connection.failed.count == 0
2017-09-08 13:46:05,479 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-004864b1-95dc-403d-ae0c-30d907e0f963. sink.event.drain.attempt == 0
2017-09-08 13:46:05,480 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-004864b1-95dc-403d-ae0c-30d907e0f963. sink.event.drain.sucess == 0
2017-09-08 13:46:05,486 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.setUp(TestHDFSEventSink.java:104)] Starting...
2017-09-08 13:46:05,494 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.testTextAppend(TestHDFSEventSink.java:292)] Starting...
2017-09-08 13:46:05,501 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.register(MonitoredCounterGroup.java:119)] Monitored counter group for type: SINK, name: HDFSEventSink-ea6bdc4c-12e1-4fcb-8dbd-07fe9ba887b8: Successfully registered new MBean.
2017-09-08 13:46:05,501 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.start(MonitoredCounterGroup.java:95)] Component type: SINK, name: HDFSEventSink-ea6bdc4c-12e1-4fcb-8dbd-07fe9ba887b8 started
2017-09-08 13:46:05,501 (main) [INFO - org.apache.flume.sink.hdfs.HDFSDataStream.configure(HDFSDataStream.java:57)] Serializer = TEXT, UseRawLocalFileSystem = false
2017-09-08 13:46:05,509 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:231)] Creating file:///tmp/flume-test.1504849565486.1/singleTextBucket/FlumeData.1504849565502.tmp
2017-09-08 13:46:05,519 (hdfs-HDFSEventSink-ea6bdc4c-12e1-4fcb-8dbd-07fe9ba887b8-call-runner-0) [INFO - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetNumCurrentReplicas(AbstractHDFSWriter.java:189)] FileSystem's output stream doesn't support getNumCurrentReplicas; --HDFS-826 not available; fsOut=org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer; err=java.lang.NoSuchMethodException: org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer.getNumCurrentReplicas()
2017-09-08 13:46:05,519 (hdfs-HDFSEventSink-ea6bdc4c-12e1-4fcb-8dbd-07fe9ba887b8-call-runner-0) [DEBUG - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetDefaultReplication(AbstractHDFSWriter.java:228)] Using FileSystem.getDefaultReplication(Path) from HADOOP-8014
2017-09-08 13:46:05,519 (main) [WARN - org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:182)] isFileClosed is not available in the version of HDFS being used. Flume will not attempt to close files if the close fails on the first attempt
java.lang.NoSuchMethodException: org.apache.hadoop.fs.LocalFileSystem.isFileClosed(org.apache.hadoop.fs.Path)
	at java.lang.Class.getMethod(Class.java:1786)
	at org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:179)
	at org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:263)
	at org.apache.flume.sink.hdfs.BucketWriter.append(BucketWriter.java:504)
	at org.apache.flume.sink.hdfs.HDFSEventSink.process(HDFSEventSink.java:406)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.testTextAppend(TestHDFSEventSink.java:349)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:252)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:141)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:189)
	at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:165)
	at org.apache.maven.surefire.booter.ProviderFactory.invokeProvider(ProviderFactory.java:85)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:115)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:75)
2017-09-08 13:46:05,521 (main) [DEBUG - org.apache.flume.sink.hdfs.BucketWriter.shouldRotate(BucketWriter.java:581)] rolling: rollCount: 3, events: 3
2017-09-08 13:46:05,521 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.close(BucketWriter.java:357)] Closing file:///tmp/flume-test.1504849565486.1/singleTextBucket/FlumeData.1504849565502.tmp
2017-09-08 13:46:05,523 (hdfs-HDFSEventSink-ea6bdc4c-12e1-4fcb-8dbd-07fe9ba887b8-call-runner-7) [INFO - org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:618)] Renaming file:/tmp/flume-test.1504849565486.1/singleTextBucket/FlumeData.1504849565502.tmp to file:/tmp/flume-test.1504849565486.1/singleTextBucket/FlumeData.1504849565502
2017-09-08 13:46:05,532 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:231)] Creating file:///tmp/flume-test.1504849565486.1/singleTextBucket/FlumeData.1504849565503.tmp
2017-09-08 13:46:05,543 (hdfs-HDFSEventSink-ea6bdc4c-12e1-4fcb-8dbd-07fe9ba887b8-call-runner-8) [INFO - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetNumCurrentReplicas(AbstractHDFSWriter.java:189)] FileSystem's output stream doesn't support getNumCurrentReplicas; --HDFS-826 not available; fsOut=org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer; err=java.lang.NoSuchMethodException: org.apache.hadoop.fs.ChecksumFileSystem$ChecksumFSOutputSummer.getNumCurrentReplicas()
2017-09-08 13:46:05,543 (hdfs-HDFSEventSink-ea6bdc4c-12e1-4fcb-8dbd-07fe9ba887b8-call-runner-8) [DEBUG - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetDefaultReplication(AbstractHDFSWriter.java:228)] Using FileSystem.getDefaultReplication(Path) from HADOOP-8014
2017-09-08 13:46:05,544 (main) [WARN - org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:182)] isFileClosed is not available in the version of HDFS being used. Flume will not attempt to close files if the close fails on the first attempt
java.lang.NoSuchMethodException: org.apache.hadoop.fs.LocalFileSystem.isFileClosed(org.apache.hadoop.fs.Path)
	at java.lang.Class.getMethod(Class.java:1786)
	at org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:179)
	at org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:263)
	at org.apache.flume.sink.hdfs.BucketWriter.append(BucketWriter.java:530)
	at org.apache.flume.sink.hdfs.HDFSEventSink.process(HDFSEventSink.java:406)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.testTextAppend(TestHDFSEventSink.java:349)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:252)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:141)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:189)
	at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:165)
	at org.apache.maven.surefire.booter.ProviderFactory.invokeProvider(ProviderFactory.java:85)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:115)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:75)
2017-09-08 13:46:05,545 (main) [INFO - org.apache.flume.sink.hdfs.HDFSEventSink.stop(HDFSEventSink.java:480)] Closing file:///tmp/flume-test.1504849565486.1/singleTextBucket\FlumeData
2017-09-08 13:46:05,545 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.close(BucketWriter.java:357)] Closing file:///tmp/flume-test.1504849565486.1/singleTextBucket/FlumeData.1504849565503.tmp
2017-09-08 13:46:05,546 (hdfs-HDFSEventSink-ea6bdc4c-12e1-4fcb-8dbd-07fe9ba887b8-call-runner-5) [INFO - org.apache.flume.sink.hdfs.BucketWriter$8.call(BucketWriter.java:618)] Renaming file:/tmp/flume-test.1504849565486.1/singleTextBucket/FlumeData.1504849565503.tmp to file:/tmp/flume-test.1504849565486.1/singleTextBucket/FlumeData.1504849565503
2017-09-08 13:46:05,548 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:149)] Component type: SINK, name: HDFSEventSink-ea6bdc4c-12e1-4fcb-8dbd-07fe9ba887b8 stopped
2017-09-08 13:46:05,548 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:155)] Shutdown Metric for type: SINK, name: HDFSEventSink-ea6bdc4c-12e1-4fcb-8dbd-07fe9ba887b8. sink.start.time == 1504849565501
2017-09-08 13:46:05,548 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:161)] Shutdown Metric for type: SINK, name: HDFSEventSink-ea6bdc4c-12e1-4fcb-8dbd-07fe9ba887b8. sink.stop.time == 1504849565548
2017-09-08 13:46:05,548 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-ea6bdc4c-12e1-4fcb-8dbd-07fe9ba887b8. sink.batch.complete == 3
2017-09-08 13:46:05,549 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-ea6bdc4c-12e1-4fcb-8dbd-07fe9ba887b8. sink.batch.empty == 0
2017-09-08 13:46:05,549 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-ea6bdc4c-12e1-4fcb-8dbd-07fe9ba887b8. sink.batch.underflow == 0
2017-09-08 13:46:05,549 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-ea6bdc4c-12e1-4fcb-8dbd-07fe9ba887b8. sink.connection.closed.count == 2
2017-09-08 13:46:05,549 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-ea6bdc4c-12e1-4fcb-8dbd-07fe9ba887b8. sink.connection.creation.count == 2
2017-09-08 13:46:05,549 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-ea6bdc4c-12e1-4fcb-8dbd-07fe9ba887b8. sink.connection.failed.count == 0
2017-09-08 13:46:05,549 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-ea6bdc4c-12e1-4fcb-8dbd-07fe9ba887b8. sink.event.drain.attempt == 6
2017-09-08 13:46:05,549 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-ea6bdc4c-12e1-4fcb-8dbd-07fe9ba887b8. sink.event.drain.sucess == 6
2017-09-08 13:46:05,563 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.setUp(TestHDFSEventSink.java:104)] Starting...
2017-09-08 13:46:05,572 (main) [WARN - org.apache.flume.sink.hdfs.HDFSEventSink.configure(HDFSEventSink.java:219)] Retry count value : -4 is not valid. The sink will try to close the file until the file is eventually closed.
2017-09-08 13:46:05,582 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.setUp(TestHDFSEventSink.java:104)] Starting...
2017-09-08 13:46:05,609 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.register(MonitoredCounterGroup.java:119)] Monitored counter group for type: SINK, name: HDFSEventSink-86a4d3f8-26c7-42c4-b32f-414200e70d46: Successfully registered new MBean.
2017-09-08 13:46:05,609 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.start(MonitoredCounterGroup.java:95)] Component type: SINK, name: HDFSEventSink-86a4d3f8-26c7-42c4-b32f-414200e70d46 started
2017-09-08 13:46:05,610 (main) [INFO - org.apache.flume.sink.hdfs.HDFSSequenceFile.configure(HDFSSequenceFile.java:63)] writeFormat = Writable, UseRawLocalFileSystem = false
2017-09-08 13:46:05,621 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:231)] Creating file:///tmp/flume-test.1504849565582.1/sequenceFileWriterSync/FlumeData.1504849565610.bz2.tmp
2017-09-08 13:46:05,633 (hdfs-HDFSEventSink-86a4d3f8-26c7-42c4-b32f-414200e70d46-call-runner-0) [WARN - org.apache.hadoop.io.compress.bzip2.Bzip2Factory.isNativeBzip2Loaded(Bzip2Factory.java:73)] Failed to load/initialize native-bzip2 library system-native, will use pure-Java version
2017-09-08 13:46:05,637 (hdfs-HDFSEventSink-86a4d3f8-26c7-42c4-b32f-414200e70d46-call-runner-0) [INFO - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetNumCurrentReplicas(AbstractHDFSWriter.java:189)] FileSystem's output stream doesn't support getNumCurrentReplicas; --HDFS-826 not available; fsOut=java.io.BufferedOutputStream; err=java.lang.NoSuchMethodException: java.io.BufferedOutputStream.getNumCurrentReplicas()
2017-09-08 13:46:05,637 (hdfs-HDFSEventSink-86a4d3f8-26c7-42c4-b32f-414200e70d46-call-runner-0) [DEBUG - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetDefaultReplication(AbstractHDFSWriter.java:228)] Using FileSystem.getDefaultReplication(Path) from HADOOP-8014
2017-09-08 13:46:05,637 (main) [WARN - org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:182)] isFileClosed is not available in the version of HDFS being used. Flume will not attempt to close files if the close fails on the first attempt
java.lang.NoSuchMethodException: org.apache.hadoop.fs.LocalFileSystem.isFileClosed(org.apache.hadoop.fs.Path)
	at java.lang.Class.getMethod(Class.java:1786)
	at org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:179)
	at org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:263)
	at org.apache.flume.sink.hdfs.BucketWriter.append(BucketWriter.java:504)
	at org.apache.flume.sink.hdfs.HDFSEventSink.process(HDFSEventSink.java:406)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.sequenceFileWriteAndVerifyEvents(TestHDFSEventSink.java:1400)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.testBlockCompressSequenceFileWriterSync(TestHDFSEventSink.java:1348)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:252)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:141)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:189)
	at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:165)
	at org.apache.maven.surefire.booter.ProviderFactory.invokeProvider(ProviderFactory.java:85)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:115)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:75)
2017-09-08 13:46:05,662 (main) [WARN - org.apache.hadoop.fs.FileUtil.deleteImpl(FileUtil.java:187)] Failed to delete file or dir [E:\tmp\flume-test.1504849565582.1\sequenceFileWriterSync\FlumeData.1504849565610.bz2.tmp]: it still exists.
2017-09-08 13:46:05,673 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.start(MonitoredCounterGroup.java:95)] Component type: SINK, name: HDFSEventSink-86a4d3f8-26c7-42c4-b32f-414200e70d46 started
2017-09-08 13:46:05,673 (main) [INFO - org.apache.flume.sink.hdfs.HDFSSequenceFile.configure(HDFSSequenceFile.java:63)] writeFormat = Writable, UseRawLocalFileSystem = false
2017-09-08 13:46:05,680 (main) [INFO - org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:231)] Creating file:///tmp/flume-test.1504849565582.1/sequenceFileWriterSync/FlumeData.1504849565674.bz2.tmp
2017-09-08 13:46:05,690 (hdfs-HDFSEventSink-86a4d3f8-26c7-42c4-b32f-414200e70d46-call-runner-0) [INFO - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetNumCurrentReplicas(AbstractHDFSWriter.java:189)] FileSystem's output stream doesn't support getNumCurrentReplicas; --HDFS-826 not available; fsOut=java.io.BufferedOutputStream; err=java.lang.NoSuchMethodException: java.io.BufferedOutputStream.getNumCurrentReplicas()
2017-09-08 13:46:05,690 (hdfs-HDFSEventSink-86a4d3f8-26c7-42c4-b32f-414200e70d46-call-runner-0) [DEBUG - org.apache.flume.sink.hdfs.AbstractHDFSWriter.reflectGetDefaultReplication(AbstractHDFSWriter.java:228)] Using FileSystem.getDefaultReplication(Path) from HADOOP-8014
2017-09-08 13:46:05,690 (main) [WARN - org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:182)] isFileClosed is not available in the version of HDFS being used. Flume will not attempt to close files if the close fails on the first attempt
java.lang.NoSuchMethodException: org.apache.hadoop.fs.LocalFileSystem.isFileClosed(org.apache.hadoop.fs.Path)
	at java.lang.Class.getMethod(Class.java:1786)
	at org.apache.flume.sink.hdfs.BucketWriter.getRefIsClosed(BucketWriter.java:179)
	at org.apache.flume.sink.hdfs.BucketWriter.open(BucketWriter.java:263)
	at org.apache.flume.sink.hdfs.BucketWriter.append(BucketWriter.java:504)
	at org.apache.flume.sink.hdfs.HDFSEventSink.process(HDFSEventSink.java:406)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.sequenceFileWriteAndVerifyEvents(TestHDFSEventSink.java:1400)
	at org.apache.flume.sink.hdfs.TestHDFSEventSink.testBlockCompressSequenceFileWriterSync(TestHDFSEventSink.java:1352)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:45)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:15)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:42)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:20)
	at org.junit.internal.runners.statements.RunBefores.evaluate(RunBefores.java:28)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:30)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:263)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:68)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:47)
	at org.junit.runners.ParentRunner$3.run(ParentRunner.java:231)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:60)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:229)
	at org.junit.runners.ParentRunner.access$000(ParentRunner.java:50)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:222)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:300)
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:252)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:141)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:112)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.maven.surefire.util.ReflectionUtils.invokeMethodWithArray(ReflectionUtils.java:189)
	at org.apache.maven.surefire.booter.ProviderFactory$ProviderProxy.invoke(ProviderFactory.java:165)
	at org.apache.maven.surefire.booter.ProviderFactory.invokeProvider(ProviderFactory.java:85)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:115)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:75)
2017-09-08 13:46:05,763 (main) [WARN - org.apache.hadoop.fs.FileUtil.deleteImpl(FileUtil.java:187)] Failed to delete file or dir [E:\tmp\flume-test.1504849565582.1\sequenceFileWriterSync\FlumeData.1504849565674.bz2.tmp]: it still exists.
2017-09-08 13:46:05,764 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.setUp(TestHDFSEventSink.java:104)] Starting...
2017-09-08 13:46:05,774 (main) [WARN - org.apache.flume.sink.hdfs.HDFSEventSink.configure(HDFSEventSink.java:226)] Retry Interval value: 0 is not valid. If the first close of a file fails, it may remain open and will not be renamed.
2017-09-08 13:46:05,782 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.setUp(TestHDFSEventSink.java:104)] Starting...
2017-09-08 13:46:05,790 (main) [WARN - org.apache.flume.sink.hdfs.HDFSEventSink.configure(HDFSEventSink.java:226)] Retry Interval value: -1 is not valid. If the first close of a file fails, it may remain open and will not be renamed.
2017-09-08 13:46:05,800 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.setUp(TestHDFSEventSink.java:104)] Starting...
2017-09-08 13:46:05,807 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.testEmptyChannelResultsInStatusBackoff(TestHDFSEventSink.java:236)] Starting...
2017-09-08 13:46:05,808 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.register(MonitoredCounterGroup.java:119)] Monitored counter group for type: SINK, name: HDFSEventSink-6681740f-aadb-47cd-8f97-80694a491feb: Successfully registered new MBean.
2017-09-08 13:46:05,808 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.start(MonitoredCounterGroup.java:95)] Component type: SINK, name: HDFSEventSink-6681740f-aadb-47cd-8f97-80694a491feb started
2017-09-08 13:46:05,808 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:149)] Component type: SINK, name: HDFSEventSink-6681740f-aadb-47cd-8f97-80694a491feb stopped
2017-09-08 13:46:05,808 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:155)] Shutdown Metric for type: SINK, name: HDFSEventSink-6681740f-aadb-47cd-8f97-80694a491feb. sink.start.time == 1504849565808
2017-09-08 13:46:05,808 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:161)] Shutdown Metric for type: SINK, name: HDFSEventSink-6681740f-aadb-47cd-8f97-80694a491feb. sink.stop.time == 1504849565808
2017-09-08 13:46:05,808 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-6681740f-aadb-47cd-8f97-80694a491feb. sink.batch.complete == 0
2017-09-08 13:46:05,808 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-6681740f-aadb-47cd-8f97-80694a491feb. sink.batch.empty == 1
2017-09-08 13:46:05,808 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-6681740f-aadb-47cd-8f97-80694a491feb. sink.batch.underflow == 0
2017-09-08 13:46:05,808 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-6681740f-aadb-47cd-8f97-80694a491feb. sink.connection.closed.count == 0
2017-09-08 13:46:05,809 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-6681740f-aadb-47cd-8f97-80694a491feb. sink.connection.creation.count == 0
2017-09-08 13:46:05,809 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-6681740f-aadb-47cd-8f97-80694a491feb. sink.connection.failed.count == 0
2017-09-08 13:46:05,809 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-6681740f-aadb-47cd-8f97-80694a491feb. sink.event.drain.attempt == 0
2017-09-08 13:46:05,809 (main) [INFO - org.apache.flume.instrumentation.MonitoredCounterGroup.stop(MonitoredCounterGroup.java:177)] Shutdown Metric for type: SINK, name: HDFSEventSink-6681740f-aadb-47cd-8f97-80694a491feb. sink.event.drain.sucess == 0
2017-09-08 13:46:05,816 (main) [DEBUG - org.apache.flume.sink.hdfs.TestHDFSEventSink.setUp(TestHDFSEventSink.java:104)] Starting...
2017-09-08 13:46:05,823 (main) [WARN - org.apache.flume.sink.hdfs.HDFSEventSink.configure(HDFSEventSink.java:219)] Retry count value : 0 is not valid. The sink will try to close the file until the file is eventually closed.
